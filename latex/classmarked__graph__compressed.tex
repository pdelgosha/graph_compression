\hypertarget{classmarked__graph__compressed}{}\section{marked\+\_\+graph\+\_\+compressed Class Reference}
\label{classmarked__graph__compressed}\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}


{\ttfamily \#include $<$marked\+\_\+graph\+\_\+compression.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}{clear} ()
\item 
void \hyperlink{classmarked__graph__compressed_ab9cdb7fc43badd58fb5202f74ffac723}{binary\+\_\+write} (F\+I\+LE $\ast$f)
\begin{DoxyCompactList}\small\item\em writes the compressed data to a binary file \end{DoxyCompactList}\item 
void \hyperlink{classmarked__graph__compressed_a9db2d11bd63ad3d5a75e47b4023a89dd}{binary\+\_\+read} (F\+I\+LE $\ast$f)
\begin{DoxyCompactList}\small\item\em read the compressed data from a binary file \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}
\begin{DoxyCompactList}\small\item\em the number of vertices \end{DoxyCompactList}\item 
int \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}
\begin{DoxyCompactList}\small\item\em the depth up to which the compression was performed \end{DoxyCompactList}\item 
int \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}
\begin{DoxyCompactList}\small\item\em the degree threshold used when compression was performed \end{DoxyCompactList}\item 
pair$<$ vector$<$ int $>$, mpz\+\_\+class $>$ \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\+\_\+vertices}
\begin{DoxyCompactList}\small\item\em the compressed form of the star\+\_\+vertices list \end{DoxyCompactList}\item 
map$<$ pair$<$ int, int $>$, vector$<$ vector$<$ int $>$ $>$ $>$ \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\+\_\+edges}
\begin{DoxyCompactList}\small\item\em for each pair of edge marks x,x\textquotesingle{}, and integer $k$, star\+\_\+edges\mbox{[}pair$<$int,int$>$(x,x\textquotesingle{})\mbox{]}\mbox{[}k\mbox{]} is a list of neighbors $w$ of the $k$th star vertex (say $v$) so that $v$ shares a star edge with $w$ so that the mark towards $v$ is x and the mark towards $w$ is xp. \end{DoxyCompactList}\item 
vector$<$ int $>$ \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\+\_\+mark}
\begin{DoxyCompactList}\small\item\em for an edge type t, type\+\_\+mark\mbox{[}t\mbox{]} denotes the mark component of t \end{DoxyCompactList}\item 
vector$<$ vector$<$ int $>$ $>$ \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\+\_\+type\+\_\+list}
\begin{DoxyCompactList}\small\item\em the list of all vertex types that appear in the graph, where the type of a vertex is a vector of integers, where its index 0 is the mark of the vertex, and indices $3k+1$, $3k+2$, $3k+3$ are $m$, $m'$ and $n_{m,m'}$, where $(m,m')$ is a type pair, and $n_{m,m'}$ is the number of edges connected to the vertex with that type. The list is sorted lexicographically to ensure unique representation. \end{DoxyCompactList}\item 
pair$<$ vector$<$ int $>$, mpz\+\_\+class $>$ \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\+\_\+types}
\begin{DoxyCompactList}\small\item\em the compressed form of vertex types, where the type of a vertex is the index with respect to ver\+\_\+type\+\_\+list of the list of integers specifying the type of the vertex (mark of the vertex followed by the number of edges of each type connected to that vertex) \end{DoxyCompactList}\item 
map$<$ pair$<$ int, int $>$, mpz\+\_\+class $>$ \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\+\_\+bgraph}
\begin{DoxyCompactList}\small\item\em compressed form of partition bipartite graphs corresponding to colors in $C_<$. For a pair $0 \leq t < t' < L$ of half edge types, part\+\_\+bgraph\mbox{[}pair$<$int, int$>$(t,t\textquotesingle{})\mbox{]} is the compressed form of the bipartite graph with n left and right nodes, where a left node i is connected to a right node j if there is an edge connecting i to j with type t towards i and type t\textquotesingle{} towards j \end{DoxyCompactList}\item 
map$<$ int, pair$<$ mpz\+\_\+class, vector$<$ int $>$ $>$ $>$ \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\+\_\+graph}
\begin{DoxyCompactList}\small\item\em compressed form of partition graphs corresponding to colors in $C_=$. For a half edge type t, part\+\_\+graph\mbox{[}t\mbox{]} is the compressed form of the simple unmarked graph with n vertices, where a node i is connected to a node j where there is an edge between i and j in the original graph with color (t,t) \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classmarked__graph__compressed_a9db2d11bd63ad3d5a75e47b4023a89dd}\label{classmarked__graph__compressed_a9db2d11bd63ad3d5a75e47b4023a89dd}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!binary\+\_\+read@{binary\+\_\+read}}
\index{binary\+\_\+read@{binary\+\_\+read}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{binary\+\_\+read()}{binary\_read()}}
{\footnotesize\ttfamily void marked\+\_\+graph\+\_\+compressed\+::binary\+\_\+read (\begin{DoxyParamCaption}\item[{F\+I\+LE $\ast$}]{f }\end{DoxyParamCaption})}



read the compressed data from a binary file 


\begin{DoxyParams}{Parameters}
{\em f} & a {\ttfamily F\+I\+L\+E$\ast$} object which is the address of the binary file to write \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
167                                                 \{
168   \hyperlink{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}{clear}(); \textcolor{comment}{// to make sure nothing is stored inside me before reading}
169 
170   \textcolor{comment}{// ==== read n, h, delta}
171   fread(&\hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}, 1, f);
172   fread(&\hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}, 1, f);
173   fread(&\hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}, 1, f);
174 
175   \textcolor{keywordtype}{int} int\_in; \textcolor{comment}{// auxiliary input integer}
176   \textcolor{comment}{// ===== read type\_mark}
177   \textcolor{comment}{// read number of types}
178   fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
179   \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.resize(int\_in);
180   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();i++)\{
181     fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
182     \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}[i] = int\_in;
183   \}
184 
185   \textcolor{comment}{// ==== read star\_vertices}
186   \textcolor{comment}{// first, read the frequency.}
187   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first = vector<int>(2); \textcolor{comment}{// frequency,}
188   \textcolor{comment}{// we read its first index which is number of zeros, and the second is n - the first.}
189   fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
190   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[0] = int\_in;
191   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[1] = \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n} - int\_in;
192 
193   \textcolor{comment}{// the integer representation which is star\_vertices.second}
194   mpz\_inp\_raw(\hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.second.get\_mpz\_t(), f);
195 
196   \textcolor{comment}{// ==== read star\_edges}
197 
198   \textcolor{keywordtype}{int} log2n = 0; \textcolor{comment}{// the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log\_2 n), which
       is the number of bits to encode vertices}
199   \textcolor{keywordtype}{int} n\_copy = \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n};
200   \textcolor{keywordflow}{while}(n\_copy > 0)\{
201     n\_copy >>= 1;
202     log2n ++;
203   \}
204   bitset<8*sizeof(int)> B; \textcolor{comment}{// a bit stream with maximum length of int to store a vertex index}
205 
206   \textcolor{keywordtype}{string} s;
207   stringstream ss;
208   \textcolor{keywordtype}{int} sp; \textcolor{comment}{// the index of the string s we are studying }
209 
210   \textcolor{comment}{// read the size of star\_edges}
211 
212   \textcolor{keywordtype}{int} star\_edges\_size;
213   fread(&star\_edges\_size, \textcolor{keyword}{sizeof} star\_edges\_size, 1, f);
214 
215   \textcolor{keywordtype}{int} x, xp; \textcolor{comment}{// edge marks}
216   \textcolor{keywordtype}{int} nu\_star\_vertices = \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[1];
217 
218   vector<vector<int> > V; \textcolor{comment}{// the list of star edges corresponding to each mark pair}
219   V.resize(nu\_star\_vertices);
220 
221   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<star\_edges\_size;i++)\{
222     fread(&x, \textcolor{keyword}{sizeof} x, 1, f);
223     fread(&xp, \textcolor{keyword}{sizeof} xp, 1, f);
224   
225     s = \hyperlink{compression__helper_8cpp_a40e8dcbc036f96b28e003e882c4890b7}{bit\_string\_read}(f);
226     \textcolor{comment}{//cerr << " read  x " << x << " xp " << xp << " s " << s << endl;}
227     sp = 0; \textcolor{comment}{// starting from zero }
228     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<nu\_star\_vertices; j++)\{ \textcolor{comment}{// }
229       V[j].clear(); \textcolor{comment}{// make it fresh}
230       \textcolor{keywordflow}{while}(s[sp++] == \textcolor{charliteral}{'1'})\{ \textcolor{comment}{// there is still some edge connected to this vertex }
231         \textcolor{comment}{// read log2n many bits}
232         \textcolor{comment}{//cerr << " s subtr " << s.substr(sp, log2n);}
233         \textcolor{comment}{//ss << s.substr(sp, log2n);}
234         B = bitset<8*sizeof(int)>(s.substr(sp, log2n));
235         \textcolor{comment}{//cerr << " ss " << ss.str() << endl;}
236         sp += log2n;
237         \textcolor{comment}{//ss >> B;}
238 
239         V[j].push\_back(B.to\_ulong());
240       \}
241       \textcolor{comment}{//for (int k=0;k<V[j].size();k++)}
242       \textcolor{comment}{//  cerr << " , " << V[j][k];}
243       \textcolor{comment}{//cerr << endl;}
244     \}
245 
246 
247     \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.insert(pair< pair<int, int> , vector<vector<int> > > (pair<int, int>(x, xp), V));
248   \}
249 
250   \textcolor{comment}{// ==== read vertex\_types}
251 
252   \textcolor{comment}{// read ver\_type\_list}
253   fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f); \textcolor{comment}{// size of ver\_type\_list}
254   \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.resize(int\_in);
255   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();i++)\{
256     fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f); \textcolor{comment}{// size of ver\_type\_list[i]}
257     \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].resize(int\_in);
258     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();j++)\{
259       fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
260       \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i][j] = int\_in;
261     \}
262   \}
263 
264   \textcolor{comment}{// ver\_types}
265   \textcolor{comment}{// ver\_types.first}
266   \textcolor{comment}{// ver\_types.first.size()}
267   fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
268   \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.resize(int\_in);
269   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size();i++)\{
270     fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
271     \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first[i] = int\_in;
272   \}
273   \textcolor{comment}{// ver\_types.second}
274   mpz\_inp\_raw(\hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.second.get\_mpz\_t(), f);
275 
276 
277   \textcolor{comment}{// === part bgraphs}
278   \textcolor{keywordtype}{int} part\_bgraph\_size;
279   \textcolor{keywordtype}{int} t, tp;
280   pair<int, int> type; 
281   mpz\_class part\_g; 
282   fread(&part\_bgraph\_size, \textcolor{keyword}{sizeof} part\_bgraph\_size, 1, f);
283   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<part\_bgraph\_size;i++)\{
284     \textcolor{comment}{// read t, t'}
285     fread(&t, \textcolor{keyword}{sizeof} t, 1, f);
286     fread(&tp, \textcolor{keyword}{sizeof} tp, 1, f);
287     type = pair<int, int>(t, tp);
288     mpz\_inp\_raw(part\_g.get\_mpz\_t(), f);
289     \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.insert(pair<pair<int, int>, mpz\_class> (type, part\_g));
290   \}
291 
292   \textcolor{comment}{// === part graphs}
293 
294   \textcolor{comment}{// first, the size}
295   \textcolor{keywordtype}{int} part\_graph\_size;
296   \textcolor{keywordtype}{int} v\_size;
297   vector<int> W; 
298   fread(&part\_graph\_size, \textcolor{keyword}{sizeof} part\_graph\_size, 1, f);
299   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<part\_graph\_size; i++)\{
300     \textcolor{comment}{// first, the type}
301     fread(&t, \textcolor{keyword}{sizeof} t, 1, f);
302     \textcolor{comment}{// then, the mpz part}
303     mpz\_inp\_raw(part\_g.get\_mpz\_t(), f);
304     \textcolor{comment}{// then, the vector size}
305     fread(&v\_size, \textcolor{keyword}{sizeof} v\_size, 1, f);
306     W.resize(v\_size);
307     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<v\_size; j++)\{
308       fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
309       W[j] = int\_in;
310     \}
311     \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.insert(pair<\textcolor{keywordtype}{int}, pair< mpz\_class, vector< int > > >(t, pair<mpz\_class, vector<int>
       >(part\_g, W)));
312   \}
313 \}
\end{DoxyCode}
\mbox{\Hypertarget{classmarked__graph__compressed_ab9cdb7fc43badd58fb5202f74ffac723}\label{classmarked__graph__compressed_ab9cdb7fc43badd58fb5202f74ffac723}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!binary\+\_\+write@{binary\+\_\+write}}
\index{binary\+\_\+write@{binary\+\_\+write}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{binary\+\_\+write()}{binary\_write()}}
{\footnotesize\ttfamily void marked\+\_\+graph\+\_\+compressed\+::binary\+\_\+write (\begin{DoxyParamCaption}\item[{F\+I\+LE $\ast$}]{f }\end{DoxyParamCaption})}



writes the compressed data to a binary file 


\begin{DoxyParams}{Parameters}
{\em f} & a {\ttfamily F\+I\+L\+E$\ast$} object which is the address of the binary file to write \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
15                                                  \{
16   \hyperlink{classlogger_a9d29b49bd318a719a8e85b59eac54fe0}{logger::current\_depth}++;
17   \textcolor{comment}{// ==== write n, h, delta}
18   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"n"}, \textcolor{stringliteral}{""});
19   fwrite(&\hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}, 1, f);
20   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"h"}, \textcolor{stringliteral}{""});
21   fwrite(&\hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}, 1, f);
22   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"delta"}, \textcolor{stringliteral}{""});
23   fwrite(&\hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}, 1, f);
24 
25   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"type\_mark"}, \textcolor{stringliteral}{""});
26   \textcolor{keywordtype}{int} int\_out; \textcolor{comment}{// auxiliary variable, an integer value to be written to output}
27   \textcolor{comment}{// ==== write type\_mark}
28   \textcolor{comment}{// first, the number of types}
29   int\_out = \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();
30   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
31   \textcolor{comment}{// then, marks one by one}
32   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();i++)\{
33     int\_out = \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}[i];
34     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
35   \}
36 
37   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"star\_vertices"}, \textcolor{stringliteral}{""});
38   \textcolor{comment}{// ==== write star vertices}
39   \textcolor{comment}{// first, write the frequency, note that star\_vertices.first is a vector of size 2 with the first entry
       being the number of zeros, and the second one the number of ones, so it enough to write only one of them}
40   int\_out = \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[0];
41   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
42 
43   \textcolor{comment}{// then, we write the integer representation star\_vertices.second}
44   mpz\_out\_raw(f, \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.second.get\_mpz\_t());
45 
46   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"star\_edges"}, \textcolor{stringliteral}{""});
47   \textcolor{comment}{// ==== write star edges}
48 
49   \textcolor{keywordtype}{int} log2n = 0; \textcolor{comment}{// the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log\_2 n), which
       is the number of bits to encode vertices}
50   \textcolor{keywordtype}{int} n\_copy = \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n};
51   \textcolor{keywordflow}{while}(n\_copy > 0)\{
52     n\_copy >>= 1;
53     log2n ++;
54   \}
55   cerr << \textcolor{stringliteral}{" log2n "} << log2n << endl;
56   bitset<8*sizeof(int)> B; \textcolor{comment}{// a bit stream with maximum length of int to store a vertex index}
57 
58   map<pair<int, int>, vector<vector<int> > >::iterator it;
59   \textcolor{keywordtype}{int} x, xp;
60   \textcolor{keywordtype}{string} s; \textcolor{comment}{// the bit stream}
61 
62   \textcolor{comment}{// first, write the size of star\_edges so that the decoder knows how many blocks are coming}
63   int\_out = \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.size();
64   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
65 
66   \textcolor{keywordflow}{for} (it = \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.begin(); it!= \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.end(); it++)\{
67     x = it->first.first;
68     xp = it->first.second;
69     \textcolor{comment}{//write x and xp}
70     fwrite(&x, \textcolor{keyword}{sizeof} x, 1, f);
71     fwrite(&xp, \textcolor{keyword}{sizeof} xp, 1, f);
72     s = \textcolor{stringliteral}{""};
73     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<it->second.size();i++)\{
74       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<it->second[i].size();j++)\{
75         s += \textcolor{stringliteral}{"1"};
76         B = it->second[i][j]; \textcolor{comment}{// convert the index of the other endpoint to binary}
77         s += B.to\_string().substr(8*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) - log2n, log2n); \textcolor{comment}{// take only log2n many bits of the
       representation (and this should be taken from the least significant bits)}
78       \}
79       s += \textcolor{stringliteral}{"0"}; \textcolor{comment}{// to indicate that the neighbor list of this vertex is over now}
80     \}
81     \textcolor{comment}{//cerr << " write  x " << x << " xp " << xp << " s " << s << endl;}
82     \textcolor{comment}{//for (int i=0;i<it->second.size();i++)\{}
83     \textcolor{comment}{//  for (int j=0;j<it->second[i].size();j++)\{}
84     \textcolor{comment}{//    cerr << " , " << it->second[i][j];}
85     \textcolor{comment}{//  \}}
86     \textcolor{comment}{//  cerr << endl;}
87     \textcolor{comment}{//\}}
88     \hyperlink{compression__helper_8cpp_accfebfd921b967c2f09e8c11569eb832}{bit\_string\_write}(f, s); \textcolor{comment}{// write this bitstream to the output}
89   \}
90 
91   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"vertex types"}, \textcolor{stringliteral}{""});
92 
93   \textcolor{comment}{// ==== write vertex types}
94 
95   \textcolor{comment}{// first, we need vertex types list (ver\_type\_list)}
96   \textcolor{comment}{// size of ver\_type\_list}
97   int\_out = \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();
98   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
99   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();i++)\{
100     int\_out = \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();
101     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
102     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();j++)\{
103       int\_out = \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i][j];
104       fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
105     \}
106   \}
107 
108   \textcolor{comment}{// then, write ver\_types}
109 
110   \textcolor{comment}{// ver\_types.first}
111   \textcolor{comment}{// ver\_types.first.size():}
112   int\_out = \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size();
113   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
114   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i =0;i<\hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size(); i++)\{
115     int\_out = \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first[i];
116     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
117   \}
118   \textcolor{comment}{// ver\_types.second}
119   mpz\_out\_raw(f, \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.second.get\_mpz\_t());
120 
121 
122   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"partition bipartite graphs"}, \textcolor{stringliteral}{""});
123   \textcolor{comment}{// ==== part bgraphs}
124 
125   \textcolor{comment}{// part\_bgraphs.size}
126   int\_out = \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.size();
127   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
128   map<pair<int, int>, mpz\_class>::iterator it2;
129   \textcolor{keywordflow}{for} (it2 = \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.begin(); it2 != \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.end(); it2++)\{
130     \textcolor{comment}{// first, write t, t'}
131     int\_out = it2->first.first;
132     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
133     int\_out = it2->first.second;
134     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
135     \textcolor{comment}{// then, the compressed integer}
136     mpz\_out\_raw(f, it2->second.get\_mpz\_t());
137   \}
138 
139   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"partition graphs"}, \textcolor{stringliteral}{""});
140   \textcolor{comment}{// === part graphs}
141 
142   \textcolor{comment}{// part\_graph.size}
143   int\_out = \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.size();
144   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
145   map< int, pair< mpz\_class, vector< int > > >::iterator it3;
146   \textcolor{keywordflow}{for} (it3 = \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.begin(); it3 != \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.end(); it3++)\{
147     int\_out = it3->first; \textcolor{comment}{// the type}
148     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
149     \textcolor{comment}{// the mpz part}
150     mpz\_out\_raw(f, it3->second.first.get\_mpz\_t());
151     \textcolor{comment}{// the vector part}
152     \textcolor{comment}{// first its size}
153     int\_out = it3->second.second.size();
154     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
155     \textcolor{comment}{// then element by element}
156     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<it3->second.second.size();j++)\{
157       int\_out = it3->second.second[j];
158       fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
159     \}
160   \}
161   \hyperlink{classlogger_a9d29b49bd318a719a8e85b59eac54fe0}{logger::current\_depth}--;
162 \}
\end{DoxyCode}
\mbox{\Hypertarget{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}\label{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!clear@{clear}}
\index{clear@{clear}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{clear()}{clear()}}
{\footnotesize\ttfamily void marked\+\_\+graph\+\_\+compressed\+::clear (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}
4 \{
5   \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.clear();
6   \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.clear();
7   \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.clear();
8   \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.clear();
9   \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.clear();
10 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}\label{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!delta@{delta}}
\index{delta@{delta}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{delta}{delta}}
{\footnotesize\ttfamily int marked\+\_\+graph\+\_\+compressed\+::delta}



the degree threshold used when compression was performed 

\mbox{\Hypertarget{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}\label{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!h@{h}}
\index{h@{h}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{h}{h}}
{\footnotesize\ttfamily int marked\+\_\+graph\+\_\+compressed\+::h}



the depth up to which the compression was performed 

\mbox{\Hypertarget{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}\label{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!n@{n}}
\index{n@{n}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{n}{n}}
{\footnotesize\ttfamily int marked\+\_\+graph\+\_\+compressed\+::n}



the number of vertices 

\mbox{\Hypertarget{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}\label{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!part\+\_\+bgraph@{part\+\_\+bgraph}}
\index{part\+\_\+bgraph@{part\+\_\+bgraph}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{part\+\_\+bgraph}{part\_bgraph}}
{\footnotesize\ttfamily map$<$pair$<$int, int$>$, mpz\+\_\+class$>$ marked\+\_\+graph\+\_\+compressed\+::part\+\_\+bgraph}



compressed form of partition bipartite graphs corresponding to colors in $C_<$. For a pair $0 \leq t < t' < L$ of half edge types, part\+\_\+bgraph\mbox{[}pair$<$int, int$>$(t,t\textquotesingle{})\mbox{]} is the compressed form of the bipartite graph with n left and right nodes, where a left node i is connected to a right node j if there is an edge connecting i to j with type t towards i and type t\textquotesingle{} towards j 

\mbox{\Hypertarget{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}\label{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!part\+\_\+graph@{part\+\_\+graph}}
\index{part\+\_\+graph@{part\+\_\+graph}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{part\+\_\+graph}{part\_graph}}
{\footnotesize\ttfamily map$<$int, pair$<$mpz\+\_\+class, vector$<$int$>$ $>$ $>$ marked\+\_\+graph\+\_\+compressed\+::part\+\_\+graph}



compressed form of partition graphs corresponding to colors in $C_=$. For a half edge type t, part\+\_\+graph\mbox{[}t\mbox{]} is the compressed form of the simple unmarked graph with n vertices, where a node i is connected to a node j where there is an edge between i and j in the original graph with color (t,t) 

\mbox{\Hypertarget{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}\label{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!star\+\_\+edges@{star\+\_\+edges}}
\index{star\+\_\+edges@{star\+\_\+edges}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{star\+\_\+edges}{star\_edges}}
{\footnotesize\ttfamily map$<$pair$<$int, int$>$ , vector$<$vector$<$int$>$ $>$ $>$ marked\+\_\+graph\+\_\+compressed\+::star\+\_\+edges}



for each pair of edge marks x,x\textquotesingle{}, and integer $k$, star\+\_\+edges\mbox{[}pair$<$int,int$>$(x,x\textquotesingle{})\mbox{]}\mbox{[}k\mbox{]} is a list of neighbors $w$ of the $k$th star vertex (say $v$) so that $v$ shares a star edge with $w$ so that the mark towards $v$ is x and the mark towards $w$ is xp. 

\mbox{\Hypertarget{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}\label{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!star\+\_\+vertices@{star\+\_\+vertices}}
\index{star\+\_\+vertices@{star\+\_\+vertices}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{star\+\_\+vertices}{star\_vertices}}
{\footnotesize\ttfamily pair$<$vector$<$int$>$, mpz\+\_\+class$>$ marked\+\_\+graph\+\_\+compressed\+::star\+\_\+vertices}



the compressed form of the star\+\_\+vertices list 

\mbox{\Hypertarget{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}\label{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!type\+\_\+mark@{type\+\_\+mark}}
\index{type\+\_\+mark@{type\+\_\+mark}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{type\+\_\+mark}{type\_mark}}
{\footnotesize\ttfamily vector$<$int$>$ marked\+\_\+graph\+\_\+compressed\+::type\+\_\+mark}



for an edge type t, type\+\_\+mark\mbox{[}t\mbox{]} denotes the mark component of t 

\mbox{\Hypertarget{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}\label{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!ver\+\_\+type\+\_\+list@{ver\+\_\+type\+\_\+list}}
\index{ver\+\_\+type\+\_\+list@{ver\+\_\+type\+\_\+list}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{ver\+\_\+type\+\_\+list}{ver\_type\_list}}
{\footnotesize\ttfamily vector$<$vector$<$int$>$ $>$ marked\+\_\+graph\+\_\+compressed\+::ver\+\_\+type\+\_\+list}



the list of all vertex types that appear in the graph, where the type of a vertex is a vector of integers, where its index 0 is the mark of the vertex, and indices $3k+1$, $3k+2$, $3k+3$ are $m$, $m'$ and $n_{m,m'}$, where $(m,m')$ is a type pair, and $n_{m,m'}$ is the number of edges connected to the vertex with that type. The list is sorted lexicographically to ensure unique representation. 

\mbox{\Hypertarget{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}\label{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!ver\+\_\+types@{ver\+\_\+types}}
\index{ver\+\_\+types@{ver\+\_\+types}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{ver\+\_\+types}{ver\_types}}
{\footnotesize\ttfamily pair$<$vector$<$int$>$, mpz\+\_\+class$>$ marked\+\_\+graph\+\_\+compressed\+::ver\+\_\+types}



the compressed form of vertex types, where the type of a vertex is the index with respect to ver\+\_\+type\+\_\+list of the list of integers specifying the type of the vertex (mark of the vertex followed by the number of edges of each type connected to that vertex) 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{marked__graph__compression_8h}{marked\+\_\+graph\+\_\+compression.\+h}\item 
\hyperlink{marked__graph__compression_8cpp}{marked\+\_\+graph\+\_\+compression.\+cpp}\end{DoxyCompactItemize}
