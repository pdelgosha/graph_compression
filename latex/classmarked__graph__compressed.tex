\hypertarget{classmarked__graph__compressed}{}\section{marked\+\_\+graph\+\_\+compressed Class Reference}
\label{classmarked__graph__compressed}\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}


{\ttfamily \#include $<$marked\+\_\+graph\+\_\+compression.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}{clear} ()
\item 
void \hyperlink{classmarked__graph__compressed_ab9cdb7fc43badd58fb5202f74ffac723}{binary\+\_\+write} (F\+I\+LE $\ast$f)
\begin{DoxyCompactList}\small\item\em writes the compressed data to a binary file \end{DoxyCompactList}\item 
void \hyperlink{classmarked__graph__compressed_a13ab09e4b399f179ec91746ae2b8b38c}{binary\+\_\+write} (string s)
\item 
void \hyperlink{classmarked__graph__compressed_a9db2d11bd63ad3d5a75e47b4023a89dd}{binary\+\_\+read} (F\+I\+LE $\ast$f)
\begin{DoxyCompactList}\small\item\em read the compressed data from a binary file \end{DoxyCompactList}\item 
void \hyperlink{classmarked__graph__compressed_a01c67fe4234738db6bb60459515c3ad8}{binary\+\_\+read} (string s)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}
\begin{DoxyCompactList}\small\item\em the number of vertices \end{DoxyCompactList}\item 
int \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}
\begin{DoxyCompactList}\small\item\em the depth up to which the compression was performed \end{DoxyCompactList}\item 
int \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}
\begin{DoxyCompactList}\small\item\em the degree threshold used when compression was performed \end{DoxyCompactList}\item 
pair$<$ vector$<$ int $>$, mpz\+\_\+class $>$ \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\+\_\+vertices}
\begin{DoxyCompactList}\small\item\em the compressed form of the star\+\_\+vertices list \end{DoxyCompactList}\item 
map$<$ pair$<$ int, int $>$, vector$<$ vector$<$ int $>$ $>$ $>$ \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\+\_\+edges}
\begin{DoxyCompactList}\small\item\em for each pair of edge marks x,x\textquotesingle{}, and integer $k$, star\+\_\+edges\mbox{[}pair$<$int,int$>$(x,x\textquotesingle{})\mbox{]}\mbox{[}k\mbox{]} is a list of neighbors $w$ of the $k$th star vertex (say $v$) so that $v$ shares a star edge with $w$ so that the mark towards $v$ is x and the mark towards $w$ is xp. \end{DoxyCompactList}\item 
vector$<$ int $>$ \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\+\_\+mark}
\begin{DoxyCompactList}\small\item\em for an edge type t, type\+\_\+mark\mbox{[}t\mbox{]} denotes the mark component of t \end{DoxyCompactList}\item 
vector$<$ vector$<$ int $>$ $>$ \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\+\_\+type\+\_\+list}
\begin{DoxyCompactList}\small\item\em the list of all vertex types that appear in the graph, where the type of a vertex is a vector of integers, where its index 0 is the mark of the vertex, and indices $3k+1$, $3k+2$, $3k+3$ are $m$, $m'$ and $n_{m,m'}$, where $(m,m')$ is a type pair, and $n_{m,m'}$ is the number of edges connected to the vertex with that type. The list is sorted lexicographically to ensure unique representation. \end{DoxyCompactList}\item 
pair$<$ vector$<$ int $>$, mpz\+\_\+class $>$ \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\+\_\+types}
\begin{DoxyCompactList}\small\item\em the compressed form of vertex types, where the type of a vertex is the index with respect to ver\+\_\+type\+\_\+list of the list of integers specifying the type of the vertex (mark of the vertex followed by the number of edges of each type connected to that vertex) \end{DoxyCompactList}\item 
map$<$ pair$<$ int, int $>$, mpz\+\_\+class $>$ \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\+\_\+bgraph}
\begin{DoxyCompactList}\small\item\em compressed form of partition bipartite graphs corresponding to colors in $C_<$. For a pair $0 \leq t < t' < L$ of half edge types, part\+\_\+bgraph\mbox{[}pair$<$int, int$>$(t,t\textquotesingle{})\mbox{]} is the compressed form of the bipartite graph with n left and right nodes, where a left node i is connected to a right node j if there is an edge connecting i to j with type t towards i and type t\textquotesingle{} towards j \end{DoxyCompactList}\item 
map$<$ int, pair$<$ mpz\+\_\+class, vector$<$ int $>$ $>$ $>$ \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\+\_\+graph}
\begin{DoxyCompactList}\small\item\em compressed form of partition graphs corresponding to colors in $C_=$. For a half edge type t, part\+\_\+graph\mbox{[}t\mbox{]} is the compressed form of the simple unmarked graph with n vertices, where a node i is connected to a node j where there is an edge between i and j in the original graph with color (t,t) \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classmarked__graph__compressed_a9db2d11bd63ad3d5a75e47b4023a89dd}\label{classmarked__graph__compressed_a9db2d11bd63ad3d5a75e47b4023a89dd}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!binary\+\_\+read@{binary\+\_\+read}}
\index{binary\+\_\+read@{binary\+\_\+read}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{binary\+\_\+read()}{binary\_read()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void marked\+\_\+graph\+\_\+compressed\+::binary\+\_\+read (\begin{DoxyParamCaption}\item[{F\+I\+LE $\ast$}]{f }\end{DoxyParamCaption})}



read the compressed data from a binary file 


\begin{DoxyParams}{Parameters}
{\em f} & a {\ttfamily F\+I\+L\+E$\ast$} object which is the address of the binary file to write \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
507                                                 \{
508   \hyperlink{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}{clear}(); \textcolor{comment}{// to make sure nothing is stored inside me before reading}
509 
510   \textcolor{comment}{// ==== read n, h, delta}
511   fread(&\hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}, 1, f);
512   fread(&\hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}, 1, f);
513   fread(&\hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}, 1, f);
514 
515   \textcolor{keywordtype}{int} int\_in; \textcolor{comment}{// auxiliary input integer}
516   \textcolor{comment}{// ===== read type\_mark}
517   \textcolor{comment}{// read number of types}
518   fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
519   \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.resize(int\_in);
520   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();i++)\{
521     fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
522     \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}[i] = int\_in;
523   \}
524 
525   \textcolor{comment}{// ==== read star\_vertices}
526   \textcolor{comment}{// first, read the frequency.}
527   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first = vector<int>(2); \textcolor{comment}{// frequency,}
528   \textcolor{comment}{// we read its first index which is number of zeros, and the second is n - the first.}
529   fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
530   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[0] = int\_in;
531   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[1] = \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n} - int\_in;
532 
533   \textcolor{comment}{// the integer representation which is star\_vertices.second}
534   mpz\_inp\_raw(\hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.second.get\_mpz\_t(), f);
535 
536   \textcolor{comment}{// ==== read star\_edges}
537 
538   \textcolor{keywordtype}{int} log2n = 0; \textcolor{comment}{// the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log\_2 n), which
       is the number of bits to encode vertices}
539   \textcolor{keywordtype}{int} n\_copy = \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n};
540   \textcolor{keywordflow}{while}(n\_copy > 0)\{
541     n\_copy >>= 1;
542     log2n ++;
543   \}
544   bitset<8*sizeof(int)> B; \textcolor{comment}{// a bit stream with maximum length of int to store a vertex index}
545 
546   \textcolor{keywordtype}{string} s;
547   stringstream ss;
548   \textcolor{keywordtype}{int} sp; \textcolor{comment}{// the index of the string s we are studying }
549 
550   \textcolor{comment}{// read the size of star\_edges}
551 
552   \textcolor{keywordtype}{int} star\_edges\_size;
553   fread(&star\_edges\_size, \textcolor{keyword}{sizeof} star\_edges\_size, 1, f);
554 
555   \textcolor{keywordtype}{int} x, xp; \textcolor{comment}{// edge marks}
556   \textcolor{keywordtype}{int} nu\_star\_vertices = \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[1];
557 
558   vector<vector<int> > V; \textcolor{comment}{// the list of star edges corresponding to each mark pair}
559   V.resize(nu\_star\_vertices);
560 
561   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<star\_edges\_size;i++)\{
562     fread(&x, \textcolor{keyword}{sizeof} x, 1, f);
563     fread(&xp, \textcolor{keyword}{sizeof} xp, 1, f);
564   
565     s = \hyperlink{compression__helper_8cpp_a40e8dcbc036f96b28e003e882c4890b7}{bit\_string\_read}(f);
566     \textcolor{comment}{//cerr << " read  x " << x << " xp " << xp << " s " << s << endl;}
567     sp = 0; \textcolor{comment}{// starting from zero }
568     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<nu\_star\_vertices; j++)\{ \textcolor{comment}{// }
569       V[j].clear(); \textcolor{comment}{// make it fresh}
570       \textcolor{keywordflow}{while}(s[sp++] == \textcolor{charliteral}{'1'})\{ \textcolor{comment}{// there is still some edge connected to this vertex }
571         \textcolor{comment}{// read log2n many bits}
572         \textcolor{comment}{//cerr << " s subtr " << s.substr(sp, log2n);}
573         \textcolor{comment}{//ss << s.substr(sp, log2n);}
574         B = bitset<8*sizeof(int)>(s.substr(sp, log2n));
575         \textcolor{comment}{//cerr << " ss " << ss.str() << endl;}
576         sp += log2n;
577         \textcolor{comment}{//ss >> B;}
578 
579         V[j].push\_back(B.to\_ulong());
580       \}
581       \textcolor{comment}{//for (int k=0;k<V[j].size();k++)}
582       \textcolor{comment}{//  cerr << " , " << V[j][k];}
583       \textcolor{comment}{//cerr << endl;}
584     \}
585 
586 
587     \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.insert(pair< pair<int, int> , vector<vector<int> > > (pair<int, int>(x, xp), V));
588   \}
589 
590   \textcolor{comment}{// ==== read vertex\_types}
591 
592   \textcolor{comment}{// read ver\_type\_list}
593   fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f); \textcolor{comment}{// size of ver\_type\_list}
594   \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.resize(int\_in);
595   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();i++)\{
596     fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f); \textcolor{comment}{// size of ver\_type\_list[i]}
597     \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].resize(int\_in);
598     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();j++)\{
599       fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
600       \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i][j] = int\_in;
601     \}
602   \}
603 
604   \textcolor{comment}{// ver\_types}
605   \textcolor{comment}{// ver\_types.first}
606   \textcolor{comment}{// ver\_types.first.size()}
607   fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
608   \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.resize(int\_in);
609   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size();i++)\{
610     fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
611     \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first[i] = int\_in;
612   \}
613   \textcolor{comment}{// ver\_types.second}
614   mpz\_inp\_raw(\hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.second.get\_mpz\_t(), f);
615 
616 
617   \textcolor{comment}{// === part bgraphs}
618   \textcolor{keywordtype}{int} part\_bgraph\_size;
619   \textcolor{keywordtype}{int} t, tp;
620   pair<int, int> type; 
621   mpz\_class part\_g; 
622   fread(&part\_bgraph\_size, \textcolor{keyword}{sizeof} part\_bgraph\_size, 1, f);
623   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<part\_bgraph\_size;i++)\{
624     \textcolor{comment}{// read t, t'}
625     fread(&t, \textcolor{keyword}{sizeof} t, 1, f);
626     fread(&tp, \textcolor{keyword}{sizeof} tp, 1, f);
627     type = pair<int, int>(t, tp);
628     mpz\_inp\_raw(part\_g.get\_mpz\_t(), f);
629     \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.insert(pair<pair<int, int>, mpz\_class> (type, part\_g));
630   \}
631 
632   \textcolor{comment}{// === part graphs}
633 
634   \textcolor{comment}{// first, the size}
635   \textcolor{keywordtype}{int} part\_graph\_size;
636   \textcolor{keywordtype}{int} v\_size;
637   vector<int> W; 
638   fread(&part\_graph\_size, \textcolor{keyword}{sizeof} part\_graph\_size, 1, f);
639   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<part\_graph\_size; i++)\{
640     \textcolor{comment}{// first, the type}
641     fread(&t, \textcolor{keyword}{sizeof} t, 1, f);
642     \textcolor{comment}{// then, the mpz part}
643     mpz\_inp\_raw(part\_g.get\_mpz\_t(), f);
644     \textcolor{comment}{// then, the vector size}
645     fread(&v\_size, \textcolor{keyword}{sizeof} v\_size, 1, f);
646     W.resize(v\_size);
647     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<v\_size; j++)\{
648       fread(&int\_in, \textcolor{keyword}{sizeof} int\_in, 1, f);
649       W[j] = int\_in;
650     \}
651     \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.insert(pair<\textcolor{keywordtype}{int}, pair< mpz\_class, vector< int > > >(t, pair<mpz\_class, vector<int>
       >(part\_g, W)));
652   \}
653 \}
\end{DoxyCode}
\mbox{\Hypertarget{classmarked__graph__compressed_a01c67fe4234738db6bb60459515c3ad8}\label{classmarked__graph__compressed_a01c67fe4234738db6bb60459515c3ad8}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!binary\+\_\+read@{binary\+\_\+read}}
\index{binary\+\_\+read@{binary\+\_\+read}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{binary\+\_\+read()}{binary\_read()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void marked\+\_\+graph\+\_\+compressed\+::binary\+\_\+read (\begin{DoxyParamCaption}\item[{string}]{s }\end{DoxyParamCaption})}

read the compressed data from a binary file 
\begin{DoxyParams}{Parameters}
{\em s} & string containing the name of the binary file \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
656                                                  \{
657   \hyperlink{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}{clear}(); \textcolor{comment}{// to make sure nothing is stored inside me before reading}
658   \hyperlink{classibitstream}{ibitstream} inp(s);
659 
660   \textcolor{comment}{// ==== read n, h, delta}
661   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} int\_in; \textcolor{comment}{// auxiliary input integer}
662   inp >> int\_in; 
663   \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n} = int\_in; \textcolor{comment}{// I need to do this, since ibitstream::operator >> gets unsigned int& and the compile can
       not cast int& to unsigned int&}
664   inp >> int\_in;
665   \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h} = int\_in;
666   inp >> int\_in;
667   \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta} = int\_in;
668 
669   \textcolor{comment}{//fread(&n, sizeof n, 1, f);}
670   \textcolor{comment}{//fread(&h, sizeof h, 1, f);}
671   \textcolor{comment}{//fread(&delta, sizeof delta, 1, f);}
672 
673 
674   \textcolor{comment}{// ===== read type\_mark}
675   \textcolor{comment}{// read number of types}
676   inp >> int\_in;
677   \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f);}
678   \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.resize(int\_in);
679   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();i++)\{
680     inp >> int\_in;
681     \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}[i] = int\_in;
682     \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f);}
683     \textcolor{comment}{//type\_mark[i] = int\_in;}
684   \}
685 
686   \textcolor{comment}{// ==== read star\_vertices}
687   \textcolor{comment}{// first, read the frequency.}
688   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first = vector<int>(2); \textcolor{comment}{// frequency,}
689   \textcolor{comment}{// we read its first index which is number of zeros, and the second is n - the first.}
690   inp >> int\_in;
691   \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f);}
692   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[0] = int\_in;
693   \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[1] = \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n} - int\_in;
694 
695   \textcolor{comment}{// the integer representation which is star\_vertices.second}
696   inp >> \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.second;
697   \textcolor{comment}{//mpz\_inp\_raw(star\_vertices.second.get\_mpz\_t(), f);}
698 
699   \textcolor{comment}{// ==== read star\_edges}
700 
701   \textcolor{comment}{//int log2n = 0; // the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log\_2 n),
       which is the number of bits to encode vertices}
702   \textcolor{comment}{//int n\_copy = n;}
703   \textcolor{comment}{//while(n\_copy > 0)\{}
704   \textcolor{comment}{//n\_copy >>= 1;}
705   \textcolor{comment}{//log2n ++;}
706   \textcolor{comment}{//\}}
707   \textcolor{comment}{//bitset<8*sizeof(int)> B; // a bit stream with maximum length of int to store a vertex index}
708 
709   \textcolor{comment}{//string s;}
710   \textcolor{comment}{//stringstream ss;}
711   \textcolor{comment}{//int sp; // the index of the string s we are studying }
712 
713   \textcolor{comment}{// read the size of star\_edges}
714 
715   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} star\_edges\_size;
716   inp >> star\_edges\_size;
717   \textcolor{comment}{//fread(&star\_edges\_size, sizeof star\_edges\_size, 1, f);}
718 
719   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} x, xp; \textcolor{comment}{// edge marks}
720   \textcolor{keywordtype}{int} nu\_star\_vertices = \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[1];
721 
722   vector<vector<int> > V; \textcolor{comment}{// the list of star edges corresponding to each mark pair}
723   V.resize(nu\_star\_vertices);
724 
725   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<star\_edges\_size;i++)\{
726     inp >> x;
727     inp >> xp;
728     \textcolor{comment}{//fread(&x, sizeof x, 1, f);}
729     \textcolor{comment}{//fread(&xp, sizeof xp, 1, f);}
730   
731     \textcolor{comment}{//s = bit\_string\_read(f);}
732     \textcolor{comment}{//cerr << " read  x " << x << " xp " << xp << " s " << s << endl;}
733     \textcolor{comment}{//sp = 0; // starting from zero }
734     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<nu\_star\_vertices; j++)\{ \textcolor{comment}{// }
735       V[j].clear(); \textcolor{comment}{// make it fresh}
736       \textcolor{keywordflow}{while}(inp.read\_bit())\{ \textcolor{comment}{// there is still some edge connected to this vertex }
737         \textcolor{comment}{// read log2n many bits}
738         \textcolor{comment}{//cerr << " s subtr " << s.substr(sp, log2n);}
739         \textcolor{comment}{//ss << s.substr(sp, log2n);}
740         \textcolor{comment}{//B = bitset<8*sizeof(int)>(s.substr(sp, log2n));}
741         \textcolor{comment}{//cerr << " ss " << ss.str() << endl;}
742         \textcolor{comment}{//sp += log2n;}
743         \textcolor{comment}{//ss >> B;}
744         inp >> int\_in; 
745         V[j].push\_back(int\_in);
746       \}
747       \textcolor{comment}{//for (int k=0;k<V[j].size();k++)}
748       \textcolor{comment}{//  cerr << " , " << V[j][k];}
749       \textcolor{comment}{//cerr << endl;}
750     \}
751 
752 
753     \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.insert(pair< pair<int, int> , vector<vector<int> > > (pair<int, int>(x, xp), V));
754   \}
755 
756   \textcolor{comment}{// ==== read vertex\_types}
757 
758   \textcolor{comment}{// read ver\_type\_list}
759   inp >> int\_in;
760   \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f); // size of ver\_type\_list}
761   \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.resize(int\_in);
762   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();i++)\{
763     inp >> int\_in;
764     \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f); // size of ver\_type\_list[i]}
765     \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].resize(int\_in);
766     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();j++)\{
767       \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f);}
768       inp >> int\_in;
769       \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i][j] = int\_in;
770     \}
771   \}
772 
773   \textcolor{comment}{// ver\_types}
774   \textcolor{comment}{// ver\_types.first}
775   \textcolor{comment}{// ver\_types.first.size()}
776   inp >> int\_in;
777   \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f);}
778   \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.resize(int\_in);
779   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size();i++)\{
780     \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f);}
781     inp >> int\_in;
782     \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first[i] = int\_in;\textcolor{comment}{// = int\_in;}
783   \}
784   \textcolor{comment}{// ver\_types.second}
785   inp >> \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.second;
786   \textcolor{comment}{//mpz\_inp\_raw(ver\_types.second.get\_mpz\_t(), f);}
787 
788 
789   \textcolor{comment}{// === part bgraphs}
790   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} part\_bgraph\_size;
791   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} t, tp;
792   pair<int, int> type; 
793   mpz\_class part\_g;
794   inp >> part\_bgraph\_size;
795   \textcolor{comment}{//fread(&part\_bgraph\_size, sizeof part\_bgraph\_size, 1, f);}
796   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<part\_bgraph\_size;i++)\{
797     \textcolor{comment}{// read t, t'}
798     inp >> t;
799     inp >> tp;
800     \textcolor{comment}{//fread(&t, sizeof t, 1, f);}
801     \textcolor{comment}{//fread(&tp, sizeof tp, 1, f);}
802     type = pair<int, int>(t, tp);
803     inp >> part\_g;
804     \textcolor{comment}{//mpz\_inp\_raw(part\_g.get\_mpz\_t(), f);}
805     \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.insert(pair<pair<int, int>, mpz\_class> (type, part\_g));
806   \}
807 
808   \textcolor{comment}{// === part graphs}
809 
810   \textcolor{comment}{// first, the size}
811   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} part\_graph\_size;
812   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} v\_size;
813   vector<int> W; 
814   inp >> part\_graph\_size;
815   \textcolor{comment}{//fread(&part\_graph\_size, sizeof part\_graph\_size, 1, f);}
816   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<part\_graph\_size; i++)\{
817     \textcolor{comment}{// first, the type}
818     inp >> t; 
819     \textcolor{comment}{//fread(&t, sizeof t, 1, f);}
820     \textcolor{comment}{// then, the mpz part}
821     inp >> part\_g;
822     \textcolor{comment}{//mpz\_inp\_raw(part\_g.get\_mpz\_t(), f);}
823     \textcolor{comment}{// then, the vector size}
824     inp >> v\_size;
825     \textcolor{comment}{//fread(&v\_size, sizeof v\_size, 1, f);}
826     W.resize(v\_size);
827     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<v\_size; j++)\{
828       \textcolor{comment}{//fread(&int\_in, sizeof int\_in, 1, f);}
829       inp >> int\_in;
830       W[j] = int\_in; \textcolor{comment}{//= int\_in;}
831     \}
832     \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.insert(pair<\textcolor{keywordtype}{int}, pair< mpz\_class, vector< int > > >(t, pair<mpz\_class, vector<int>
       >(part\_g, W)));
833   \}
834   inp.close();
835 \}
\end{DoxyCode}
\mbox{\Hypertarget{classmarked__graph__compressed_ab9cdb7fc43badd58fb5202f74ffac723}\label{classmarked__graph__compressed_ab9cdb7fc43badd58fb5202f74ffac723}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!binary\+\_\+write@{binary\+\_\+write}}
\index{binary\+\_\+write@{binary\+\_\+write}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{binary\+\_\+write()}{binary\_write()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily void marked\+\_\+graph\+\_\+compressed\+::binary\+\_\+write (\begin{DoxyParamCaption}\item[{F\+I\+LE $\ast$}]{f }\end{DoxyParamCaption})}



writes the compressed data to a binary file 


\begin{DoxyParams}{Parameters}
{\em f} & a {\ttfamily F\+I\+L\+E$\ast$} object which is the address of the binary file to write \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
15                                                  \{
16 
17   vector<pair<string, int> > space\_log; \textcolor{comment}{// stores the number of bits used to store each category. The
       string part is description of the category, and the int part is the number of bits of output used to express that
       part.}
18 
19   \textcolor{keywordtype}{int} output\_bits; \textcolor{comment}{// the number of bits in the output corresponding to the current category under
       investigation, to be zeroed at each step.}
20 
21   \hyperlink{classlogger_a9d29b49bd318a719a8e85b59eac54fe0}{logger::current\_depth}++;
22   \textcolor{comment}{// ==== write n, h, delta}
23   output\_bits = 0;
24   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"n"}, \textcolor{stringliteral}{""});
25   fwrite(&\hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}, 1, f);
26   output\_bits += \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n};
27 
28   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"h"}, \textcolor{stringliteral}{""});
29   fwrite(&\hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}, 1, f);
30   output\_bits += \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h};
31 
32   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"delta"}, \textcolor{stringliteral}{""});
33   fwrite(&\hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}, \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}, 1, f);
34   output\_bits += \textcolor{keyword}{sizeof} \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta};
35 
36   space\_log.push\_back(pair<string, int> (\textcolor{stringliteral}{"n, h, delta"}, output\_bits));
37 
38   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"type\_mark"}, \textcolor{stringliteral}{""});
39   output\_bits = 0;
40 
41   \textcolor{keywordtype}{int} int\_out; \textcolor{comment}{// auxiliary variable, an integer value to be written to output}
42   \textcolor{comment}{// ==== write type\_mark}
43   \textcolor{comment}{// first, the number of types}
44   int\_out = \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();
45   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
46   output\_bits += \textcolor{keyword}{sizeof} int\_out;
47   \textcolor{comment}{// then, marks one by one}
48   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();i++)\{
49     int\_out = \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}[i];
50     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
51     output\_bits += \textcolor{keyword}{sizeof} int\_out;
52   \}
53 
54   space\_log.push\_back(pair<string, int>(\textcolor{stringliteral}{"type mark"}, output\_bits));
55 
56   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"star\_vertices"}, \textcolor{stringliteral}{""});
57   output\_bits = 0;
58   \textcolor{comment}{// ==== write star vertices}
59   \textcolor{comment}{// first, write the frequency, note that star\_vertices.first is a vector of size 2 with the first entry
       being the number of zeros, and the second one the number of ones, so it enough to write only one of them}
60   int\_out = \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[0];
61   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
62   output\_bits += \textcolor{keyword}{sizeof} int\_out;
63 
64   \textcolor{comment}{// then, we write the integer representation star\_vertices.second}
65   output\_bits +=  mpz\_out\_raw(f, \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.second.get\_mpz\_t()); \textcolor{comment}{// mpz\_out\_raw returns the
       number of bytes written to the output}
66 
67   space\_log.push\_back(pair<string, int> (\textcolor{stringliteral}{"star vertices"}, output\_bits));
68 
69   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"star\_edges"}, \textcolor{stringliteral}{""});
70   \textcolor{comment}{// ==== write star edges}
71   output\_bits = 0;
72   \textcolor{keywordtype}{int} log2n = 0; \textcolor{comment}{// the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log\_2 n), which
       is the number of bits to encode vertices}
73   \textcolor{keywordtype}{int} n\_copy = \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n};
74   \textcolor{keywordflow}{while}(n\_copy > 0)\{
75     n\_copy >>= 1;
76     log2n ++;
77   \}
78   \textcolor{comment}{//cerr << " log2n " << log2n << endl;}
79   bitset<8*sizeof(int)> B; \textcolor{comment}{// a bit stream with maximum length of int to store a vertex index}
80 
81   map<pair<int, int>, vector<vector<int> > >::iterator it;
82   \textcolor{keywordtype}{int} x, xp;
83   \textcolor{keywordtype}{string} s; \textcolor{comment}{// the bit stream}
84 
85   \textcolor{comment}{// first, write the size of star\_edges so that the decoder knows how many blocks are coming}
86   int\_out = \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.size();
87   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
88   output\_bits += \textcolor{keyword}{sizeof} int\_out;
89 
90   \textcolor{keywordtype}{int} nu\_star\_edges = 0; \textcolor{comment}{// number of star edges }
91   \textcolor{keywordflow}{for} (it = \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.begin(); it!= \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.end(); it++)\{
92     x = it->first.first;
93     xp = it->first.second;
94     \textcolor{comment}{//write x and xp}
95     fwrite(&x, \textcolor{keyword}{sizeof} x, 1, f);
96     fwrite(&xp, \textcolor{keyword}{sizeof} xp, 1, f);
97     output\_bits += \textcolor{keyword}{sizeof} x;
98     output\_bits += \textcolor{keyword}{sizeof} xp;
99     s = \textcolor{stringliteral}{""};
100     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<it->second.size();i++)\{
101       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<it->second[i].size();j++)\{
102         s += \textcolor{stringliteral}{"1"};
103         B = it->second[i][j]; \textcolor{comment}{// convert the index of the other endpoint to binary}
104         s += B.to\_string().substr(8*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) - log2n, log2n); \textcolor{comment}{// take only log2n many bits of the
       representation (and this should be taken from the least significant bits)}
105         nu\_star\_edges ++;
106       \}
107       s += \textcolor{stringliteral}{"0"}; \textcolor{comment}{// to indicate that the neighbor list of this vertex is over now}
108     \}
109     \textcolor{comment}{//cerr << " write  x " << x << " xp " << xp << " s " << s << endl;}
110     \textcolor{comment}{//for (int i=0;i<it->second.size();i++)\{}
111     \textcolor{comment}{//  for (int j=0;j<it->second[i].size();j++)\{}
112     \textcolor{comment}{//    cerr << " , " << it->second[i][j];}
113     \textcolor{comment}{//  \}}
114     \textcolor{comment}{//  cerr << endl;}
115     \textcolor{comment}{//\}}
116     output\_bits += \hyperlink{compression__helper_8cpp_a9a2fbdf1fe0e38f631e7e242a819883b}{bit\_string\_write}(f, s); \textcolor{comment}{// write this bitstream to the output}
117   \}
118 
119   space\_log.push\_back(pair<string, int> (\textcolor{stringliteral}{"star edges"}, output\_bits));
120 
121 
122   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"vertex types"}, \textcolor{stringliteral}{""});
123   output\_bits = 0;
124 
125   \textcolor{comment}{// ==== write vertex types}
126 
127   \textcolor{comment}{// first, we need vertex types list (ver\_type\_list)}
128   \textcolor{comment}{// size of ver\_type\_list}
129   int\_out = \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();
130   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
131   output\_bits += \textcolor{keyword}{sizeof} int\_out;
132 
133   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();i++)\{
134     int\_out = \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();
135     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
136     output\_bits += \textcolor{keyword}{sizeof} int\_out;
137 
138     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();j++)\{
139       int\_out = \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i][j];
140       fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
141       output\_bits += \textcolor{keyword}{sizeof} int\_out;
142     \}
143   \}
144   space\_log.push\_back(pair<string, int>(\textcolor{stringliteral}{"vertex type list"}, output\_bits));
145   output\_bits = 0;
146   
147   \textcolor{comment}{// then, write ver\_types}
148 
149   \textcolor{comment}{// ver\_types.first}
150   \textcolor{comment}{// ver\_types.first.size():}
151   int\_out = \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size();
152   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
153   output\_bits += \textcolor{keyword}{sizeof} int\_out;
154 
155   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i =0;i<\hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size(); i++)\{
156     int\_out = \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first[i];
157     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
158     output\_bits += \textcolor{keyword}{sizeof} int\_out;
159   \}
160   \textcolor{comment}{// ver\_types.second}
161   output\_bits += mpz\_out\_raw(f, \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.second.get\_mpz\_t());
162 
163   space\_log.push\_back(pair<string, int> (\textcolor{stringliteral}{"vertex types"}, output\_bits));
164 
165   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"partition bipartite graphs"}, \textcolor{stringliteral}{""});
166   
167 
168   \textcolor{comment}{// ==== part bgraphs}
169   output\_bits = 0;
170 
171   \textcolor{comment}{// part\_bgraphs.size}
172   int\_out = \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.size();
173   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
174   output\_bits += \textcolor{keyword}{sizeof} int\_out;
175 
176   map<pair<int, int>, mpz\_class>::iterator it2;
177   \textcolor{keywordflow}{if} (\hyperlink{classlogger_a26812b5ba03f130e8dae3446d5fc032f}{logger::stat})\{
178     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" ==== statistics ==== "} << endl;
179     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" n:                "} << \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n} << endl;
180     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" h:                "} << \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h} << endl;
181     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" delta:            "} << \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta} << endl;
182     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. types         "} << 
      \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size() << endl;
183     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. * vertices    "} << \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n} - 
      \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[0] << endl;
184     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. * edges       "} << nu\_star\_edges << endl;
185     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. part bgraphs  "} << 
      \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.size() << endl;
186     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. part graphs   "} << 
      \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.size() << endl;
187   \}
188 
189   \textcolor{keywordflow}{for} (it2 = \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.begin(); it2 != \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.end(); it2++)\{
190     \textcolor{comment}{// first, write t, t'}
191     int\_out = it2->first.first;
192     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
193     output\_bits += \textcolor{keyword}{sizeof} int\_out;
194     int\_out = it2->first.second;
195     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
196     output\_bits += \textcolor{keyword}{sizeof} int\_out;
197     \textcolor{comment}{// then, the compressed integer}
198     output\_bits += mpz\_out\_raw(f, it2->second.get\_mpz\_t());
199   \}
200 
201   space\_log.push\_back(pair<string, int> (\textcolor{stringliteral}{"partition bipartite graphs"}, output\_bits));
202 
203   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"partition graphs"}, \textcolor{stringliteral}{""});
204   output\_bits = 0;
205   \textcolor{comment}{// === part graphs}
206 
207   \textcolor{comment}{// part\_graph.size}
208   int\_out = \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.size();
209   fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
210   output\_bits += \textcolor{keyword}{sizeof} int\_out;
211 
212   map< int, pair< mpz\_class, vector< int > > >::iterator it3;
213   \textcolor{keywordflow}{for} (it3 = \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.begin(); it3 != \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.end(); it3++)\{
214     int\_out = it3->first; \textcolor{comment}{// the type}
215     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
216     output\_bits += \textcolor{keyword}{sizeof} int\_out;
217 
218     \textcolor{comment}{// the mpz part}
219     output\_bits += mpz\_out\_raw(f, it3->second.first.get\_mpz\_t());
220     \textcolor{comment}{// the vector part}
221     \textcolor{comment}{// first its size}
222     int\_out = it3->second.second.size();
223     fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
224     output\_bits += \textcolor{keyword}{sizeof} int\_out;
225     \textcolor{comment}{// then element by element}
226     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<it3->second.second.size();j++)\{
227       int\_out = it3->second.second[j];
228       fwrite(&int\_out, \textcolor{keyword}{sizeof} int\_out, 1, f);
229       output\_bits += \textcolor{keyword}{sizeof} int\_out;
230     \}
231   \}
232   space\_log.push\_back(pair<string, int>(\textcolor{stringliteral}{"partition graphs"}, output\_bits));
233 
234 
235   \textcolor{keywordflow}{if} (\hyperlink{classlogger_a26812b5ba03f130e8dae3446d5fc032f}{logger::stat})\{
236     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << endl << endl;
237     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" Number of bytes used for each part "} << endl;
238     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" ---------------------------------- "} << endl << endl;
239 
240     \textcolor{keywordtype}{int} total\_bytes = 0;
241     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i < space\_log.size(); i++)
242       total\_bytes += space\_log[i].second;
243 
244     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i < space\_log.size(); i++)\{
245       *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << space\_log[i].first << \textcolor{stringliteral}{" -> "}  << space\_log[i].second << \textcolor{stringliteral}{"
       ( "} << float(100) * float(space\_log[i].second) / float(total\_bytes) << \textcolor{stringliteral}{" % "} << endl;
246     \}
247 
248     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" Total number of bytes wrote to the output = "} << 
      total\_bytes << endl;
249   \}
250   \hyperlink{classlogger_a9d29b49bd318a719a8e85b59eac54fe0}{logger::current\_depth}--;
251 \}
\end{DoxyCode}
\mbox{\Hypertarget{classmarked__graph__compressed_a13ab09e4b399f179ec91746ae2b8b38c}\label{classmarked__graph__compressed_a13ab09e4b399f179ec91746ae2b8b38c}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!binary\+\_\+write@{binary\+\_\+write}}
\index{binary\+\_\+write@{binary\+\_\+write}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{binary\+\_\+write()}{binary\_write()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily void marked\+\_\+graph\+\_\+compressed\+::binary\+\_\+write (\begin{DoxyParamCaption}\item[{string}]{s }\end{DoxyParamCaption})}

writes the compressed data to a binary file 
\begin{DoxyParams}{Parameters}
{\em s} & string containing the name of the binary file \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
255                                                   \{
256   
257   \hyperlink{classobitstream}{obitstream} oup(s);
258 
259   vector<pair<string, int> > space\_log; \textcolor{comment}{// stores the number of bits used to store each category. The
       string part is description of the category, and the int part is the number of bits of output used to express that
       part.}
260 
261   \textcolor{comment}{//int output\_bits; // the number of bits in the output corresponding to the current category under
       investigation, to be zeroed at each step.}
262 
263   \hyperlink{classlogger_a9d29b49bd318a719a8e85b59eac54fe0}{logger::current\_depth}++;
264   \textcolor{comment}{// ==== write n, h, delta}
265   \textcolor{comment}{//output\_bits = 0;}
266   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"n"}, \textcolor{stringliteral}{""});
267   oup << \hyperlink{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}{n}; \textcolor{comment}{//fwrite(&n, sizeof n, 1, f);}
268   \textcolor{comment}{//output\_bits += sizeof n;}
269 
270   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"h"}, \textcolor{stringliteral}{""});
271   oup << \hyperlink{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}{h}; \textcolor{comment}{//fwrite(&h, sizeof h, 1, f);}
272   \textcolor{comment}{//output\_bits += sizeof h;}
273 
274   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"delta"}, \textcolor{stringliteral}{""});
275   oup << \hyperlink{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}{delta}; \textcolor{comment}{//fwrite(&delta, sizeof delta, 1, f);}
276   \textcolor{comment}{//output\_bits += sizeof delta;}
277 
278   \textcolor{comment}{//space\_log.push\_back(pair<string, int> ("n, h, delta", output\_bits));}
279 
280   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"type\_mark"}, \textcolor{stringliteral}{""});
281   \textcolor{comment}{//output\_bits = 0;}
282 
283   \textcolor{keywordtype}{int} int\_out; \textcolor{comment}{// auxiliary variable, an integer value to be written to output}
284   \textcolor{comment}{// ==== write type\_mark}
285   \textcolor{comment}{// first, the number of types}
286   oup <<  \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();
287   \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
288   \textcolor{comment}{//output\_bits += sizeof int\_out;}
289   \textcolor{comment}{// then, marks one by one}
290   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size();i++)\{
291     oup <<  \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}[i];
292     \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
293     \textcolor{comment}{//output\_bits += sizeof int\_out;}
294   \}
295 
296   \textcolor{comment}{//space\_log.push\_back(pair<string, int>("type mark", output\_bits));}
297 
298   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"star\_vertices"}, \textcolor{stringliteral}{""});
299   \textcolor{comment}{//output\_bits = 0;}
300   \textcolor{comment}{// ==== write star vertices}
301   \textcolor{comment}{// first, write the frequency, note that star\_vertices.first is a vector of size 2 with the first entry
       being the number of zeros, and the second one the number of ones, so it enough to write only one of them}
302   oup << \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[0];
303   \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
304   \textcolor{comment}{//output\_bits += sizeof int\_out;}
305 
306   \textcolor{comment}{// then, we write the integer representation star\_vertices.second}
307   oup << \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.second;
308   \textcolor{comment}{//output\_bits +=  mpz\_out\_raw(f, star\_vertices.second.get\_mpz\_t()); // mpz\_out\_raw returns the number of
       bytes written to the output}
309 
310   \textcolor{comment}{//space\_log.push\_back(pair<string, int> ("star vertices", output\_bits));}
311 
312   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"star\_edges"}, \textcolor{stringliteral}{""});
313   \textcolor{comment}{// ==== write star edges}
314   \textcolor{comment}{//output\_bits = 0;}
315   \textcolor{comment}{//int log2n = 0; // the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log\_2 n),
       which is the number of bits to encode vertices}
316   \textcolor{comment}{//int n\_copy = n;}
317   \textcolor{comment}{//while(n\_copy > 0)\{}
318   \textcolor{comment}{//n\_copy >>= 1;}
319   \textcolor{comment}{//log2n ++;}
320   \textcolor{comment}{//\}}
321   \textcolor{comment}{//cerr << " log2n " << log2n << endl;}
322   \textcolor{comment}{//bitset<8*sizeof(int)> B; // a bit stream with maximum length of int to store a vertex index}
323 
324   map<pair<int, int>, vector<vector<int> > >::iterator it;
325   \textcolor{keywordtype}{int} x, xp;
326   \textcolor{comment}{//string s; // the bit stream}
327 
328   \textcolor{comment}{// first, write the size of star\_edges so that the decoder knows how many blocks are coming}
329   oup << \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.size();
330   \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
331   \textcolor{comment}{//output\_bits += sizeof int\_out;}
332 
333   \textcolor{keywordtype}{int} nu\_star\_edges = 0; \textcolor{comment}{// number of star edges }
334   \textcolor{keywordflow}{for} (it = \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.begin(); it!= \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.end(); it++)\{
335     x = it->first.first;
336     xp = it->first.second;
337     \textcolor{comment}{//write x and xp}
338     oup << x;
339     \textcolor{comment}{//fwrite(&x, sizeof x, 1, f);}
340     oup << xp;
341     \textcolor{comment}{//fwrite(&xp, sizeof xp, 1, f);}
342     \textcolor{comment}{//output\_bits += sizeof x;}
343     \textcolor{comment}{//output\_bits += sizeof xp;}
344     \textcolor{comment}{//s = "";}
345     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<it->second.size();i++)\{
346       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<it->second[i].size();j++)\{
347         oup.write\_bits(1,1); \textcolor{comment}{// write a single bit with value 1}
348         \textcolor{comment}{//s += "1";}
349         oup <<  it->second[i][j]; 
350         nu\_star\_edges ++;
351       \}
352       oup.write\_bits(0,1); \textcolor{comment}{// write 1 bit with value 0 }
353       \textcolor{comment}{//s += "0"; // to indicate that the neighbor list of this vertex is over now}
354     \}
355     \textcolor{comment}{//cerr << " write  x " << x << " xp " << xp << " s " << s << endl;}
356     \textcolor{comment}{//for (int i=0;i<it->second.size();i++)\{}
357     \textcolor{comment}{//  for (int j=0;j<it->second[i].size();j++)\{}
358     \textcolor{comment}{//    cerr << " , " << it->second[i][j];}
359     \textcolor{comment}{//  \}}
360     \textcolor{comment}{//  cerr << endl;}
361     \textcolor{comment}{//\}}
362     \textcolor{comment}{//output\_bits += bit\_string\_write(f, s); // write this bitstream to the output}
363   \}
364 
365   \textcolor{comment}{//space\_log.push\_back(pair<string, int> ("star edges", output\_bits));}
366 
367 
368   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"vertex types"}, \textcolor{stringliteral}{""});
369   \textcolor{comment}{//output\_bits = 0;}
370   
371   \textcolor{comment}{// ==== write vertex types}
372 
373   \textcolor{comment}{// first, we need vertex types list (ver\_type\_list)}
374   \textcolor{comment}{// size of ver\_type\_list}
375   oup <<  \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();
376   \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
377   \textcolor{comment}{//output\_bits += sizeof int\_out;}
378 
379   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.size();i++)\{
380     oup << \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();
381     \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
382     \textcolor{comment}{//output\_bits += sizeof int\_out;}
383 
384     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<\hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i].size();j++)\{
385       oup << \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}[i][j];
386       \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
387       \textcolor{comment}{//output\_bits += sizeof int\_out;}
388     \}
389   \}
390   \textcolor{comment}{//space\_log.push\_back(pair<string, int>("vertex type list", output\_bits));}
391   \textcolor{comment}{//output\_bits = 0;}
392   
393   \textcolor{comment}{// then, write ver\_types}
394 
395   \textcolor{comment}{// ver\_types.first}
396   \textcolor{comment}{// ver\_types.first.size():}
397   oup << \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size();
398   \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
399   \textcolor{comment}{//output\_bits += sizeof int\_out;}
400 
401   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i =0;i<\hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first.size(); i++)\{
402     oup <<  \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.first[i];
403     \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
404     \textcolor{comment}{//output\_bits += sizeof int\_out;}
405   \}
406   \textcolor{comment}{// ver\_types.second}
407   oup << \hyperlink{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}{ver\_types}.second;
408   \textcolor{comment}{//output\_bits += mpz\_out\_raw(f, ver\_types.second.get\_mpz\_t());}
409 
410   \textcolor{comment}{//space\_log.push\_back(pair<string, int> ("vertex types", output\_bits));}
411 
412   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"partition bipartite graphs"}, \textcolor{stringliteral}{""});
413   
414 
415   \textcolor{comment}{// ==== part bgraphs}
416   \textcolor{comment}{//output\_bits = 0;}
417 
418   \textcolor{comment}{// part\_bgraphs.size}
419   oup << \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.size();
420   \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
421   \textcolor{comment}{//output\_bits += sizeof int\_out;}
422 
423   map<pair<int, int>, mpz\_class>::iterator it2;
424   \textcolor{keywordflow}{if} (\hyperlink{classlogger_a26812b5ba03f130e8dae3446d5fc032f}{logger::stat})\{
425     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" ==== statistics ==== "} << endl;
426     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" n:                "} << n << endl;
427     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" h:                "} << h << endl;
428     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" delta:            "} << delta << endl;
429     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. types         "} << 
      \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.size() << endl;
430     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. * vertices    "} << n - 
      \hyperlink{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}{star\_vertices}.first[0] << endl;
431     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. * edges       "} << nu\_star\_edges << endl;
432     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. part bgraphs  "} << 
      \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.size() << endl;
433     *\hyperlink{classlogger_a7db37821f875f2ba3540980b355779f5}{logger::stat\_stream} << \textcolor{stringliteral}{" No. part graphs   "} << 
      \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.size() << endl;
434   \}
435 
436   \textcolor{keywordflow}{for} (it2 = \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.begin(); it2 != \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.end(); it2++)\{
437     \textcolor{comment}{// first, write t, t'}
438     oup << it2->first.first;
439     \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
440     \textcolor{comment}{//output\_bits += sizeof int\_out;}
441     oup <<  it2->first.second;
442     \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
443     \textcolor{comment}{//output\_bits += sizeof int\_out;}
444     \textcolor{comment}{// then, the compressed integer}
445     oup << it2->second;
446     \textcolor{comment}{//output\_bits += mpz\_out\_raw(f, it2->second.get\_mpz\_t());}
447   \}
448 
449   \textcolor{comment}{//space\_log.push\_back(pair<string, int> ("partition bipartite graphs", output\_bits));}
450 
451   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"partition graphs"}, \textcolor{stringliteral}{""});
452   \textcolor{comment}{//output\_bits = 0;}
453   \textcolor{comment}{// === part graphs}
454 
455   \textcolor{comment}{// part\_graph.size}
456   oup <<  \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.size();
457   \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
458   \textcolor{comment}{//output\_bits += sizeof int\_out;}
459 
460   map< int, pair< mpz\_class, vector< int > > >::iterator it3;
461   \textcolor{keywordflow}{for} (it3 = \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.begin(); it3 != \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.end(); it3++)\{
462     oup <<  it3->first; \textcolor{comment}{// the type}
463     \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
464     \textcolor{comment}{//output\_bits += sizeof int\_out;}
465 
466     \textcolor{comment}{// the mpz part}
467     oup << it3->second.first;
468     \textcolor{comment}{//output\_bits += mpz\_out\_raw(f, it3->second.first.get\_mpz\_t());}
469     \textcolor{comment}{// the vector part}
470     \textcolor{comment}{// first its size}
471     oup <<  it3->second.second.size();
472     \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
473     \textcolor{comment}{//output\_bits += sizeof int\_out;}
474     \textcolor{comment}{// then element by element}
475     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0;j<it3->second.second.size();j++)\{
476       oup <<  it3->second.second[j];
477       \textcolor{comment}{//fwrite(&int\_out, sizeof int\_out, 1, f);}
478       \textcolor{comment}{//output\_bits += sizeof int\_out;}
479     \}
480   \}
481   \textcolor{comment}{//space\_log.push\_back(pair<string, int>("partition graphs", output\_bits));}
482 
483   \textcolor{comment}{/*}
484 \textcolor{comment}{  if (logger::stat)\{}
485 \textcolor{comment}{    *logger::stat\_stream << endl << endl;}
486 \textcolor{comment}{    *logger::stat\_stream << " Number of bytes used for each part " << endl;}
487 \textcolor{comment}{    *logger::stat\_stream << " ---------------------------------- " << endl << endl;}
488 \textcolor{comment}{}
489 \textcolor{comment}{    int total\_bytes = 0;}
490 \textcolor{comment}{    for (int i=0; i < space\_log.size(); i++)}
491 \textcolor{comment}{      total\_bytes += space\_log[i].second;}
492 \textcolor{comment}{}
493 \textcolor{comment}{    for (int i=0; i < space\_log.size(); i++)\{}
494 \textcolor{comment}{      *logger::stat\_stream << space\_log[i].first << " -> "  << space\_log[i].second << " ( " << float(100) *
       float(space\_log[i].second) / float(total\_bytes) << " % " << endl;}
495 \textcolor{comment}{    \}}
496 \textcolor{comment}{}
497 \textcolor{comment}{    *logger::stat\_stream << " Total number of bytes wrote to the output = " << total\_bytes << endl;}
498 \textcolor{comment}{  \}}
499 \textcolor{comment}{  */}
500   oup.close();
501   \hyperlink{classlogger_a9d29b49bd318a719a8e85b59eac54fe0}{logger::current\_depth}--;
502 \}
\end{DoxyCode}
\mbox{\Hypertarget{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}\label{classmarked__graph__compressed_af58307bfadcaa4c3ca6dd594c2f9b3a9}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!clear@{clear}}
\index{clear@{clear}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{clear()}{clear()}}
{\footnotesize\ttfamily void marked\+\_\+graph\+\_\+compressed\+::clear (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}


\begin{DoxyCode}
4 \{
5   \hyperlink{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}{star\_edges}.clear();
6   \hyperlink{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}{type\_mark}.clear();
7   \hyperlink{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}{ver\_type\_list}.clear();
8   \hyperlink{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}{part\_bgraph}.clear();
9   \hyperlink{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}{part\_graph}.clear();
10 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}\label{classmarked__graph__compressed_a8b2aaac68e9332ddc78d88eb60b323a7}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!delta@{delta}}
\index{delta@{delta}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{delta}{delta}}
{\footnotesize\ttfamily int marked\+\_\+graph\+\_\+compressed\+::delta}



the degree threshold used when compression was performed 

\mbox{\Hypertarget{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}\label{classmarked__graph__compressed_af6ff623407b673d08d0cab77b39c2193}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!h@{h}}
\index{h@{h}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{h}{h}}
{\footnotesize\ttfamily int marked\+\_\+graph\+\_\+compressed\+::h}



the depth up to which the compression was performed 

\mbox{\Hypertarget{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}\label{classmarked__graph__compressed_a8d841016ddb11cfd33748c8deb6277ba}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!n@{n}}
\index{n@{n}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{n}{n}}
{\footnotesize\ttfamily int marked\+\_\+graph\+\_\+compressed\+::n}



the number of vertices 

\mbox{\Hypertarget{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}\label{classmarked__graph__compressed_a7b3267063fba30b45eb21b3ba4e07536}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!part\+\_\+bgraph@{part\+\_\+bgraph}}
\index{part\+\_\+bgraph@{part\+\_\+bgraph}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{part\+\_\+bgraph}{part\_bgraph}}
{\footnotesize\ttfamily map$<$pair$<$int, int$>$, mpz\+\_\+class$>$ marked\+\_\+graph\+\_\+compressed\+::part\+\_\+bgraph}



compressed form of partition bipartite graphs corresponding to colors in $C_<$. For a pair $0 \leq t < t' < L$ of half edge types, part\+\_\+bgraph\mbox{[}pair$<$int, int$>$(t,t\textquotesingle{})\mbox{]} is the compressed form of the bipartite graph with n left and right nodes, where a left node i is connected to a right node j if there is an edge connecting i to j with type t towards i and type t\textquotesingle{} towards j 

\mbox{\Hypertarget{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}\label{classmarked__graph__compressed_ae179a4737e6eab905c18a94d44ef64b7}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!part\+\_\+graph@{part\+\_\+graph}}
\index{part\+\_\+graph@{part\+\_\+graph}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{part\+\_\+graph}{part\_graph}}
{\footnotesize\ttfamily map$<$int, pair$<$mpz\+\_\+class, vector$<$int$>$ $>$ $>$ marked\+\_\+graph\+\_\+compressed\+::part\+\_\+graph}



compressed form of partition graphs corresponding to colors in $C_=$. For a half edge type t, part\+\_\+graph\mbox{[}t\mbox{]} is the compressed form of the simple unmarked graph with n vertices, where a node i is connected to a node j where there is an edge between i and j in the original graph with color (t,t) 

\mbox{\Hypertarget{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}\label{classmarked__graph__compressed_a7df5779d313486644132bd816937f532}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!star\+\_\+edges@{star\+\_\+edges}}
\index{star\+\_\+edges@{star\+\_\+edges}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{star\+\_\+edges}{star\_edges}}
{\footnotesize\ttfamily map$<$pair$<$int, int$>$ , vector$<$vector$<$int$>$ $>$ $>$ marked\+\_\+graph\+\_\+compressed\+::star\+\_\+edges}



for each pair of edge marks x,x\textquotesingle{}, and integer $k$, star\+\_\+edges\mbox{[}pair$<$int,int$>$(x,x\textquotesingle{})\mbox{]}\mbox{[}k\mbox{]} is a list of neighbors $w$ of the $k$th star vertex (say $v$) so that $v$ shares a star edge with $w$ so that the mark towards $v$ is x and the mark towards $w$ is xp. 

\mbox{\Hypertarget{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}\label{classmarked__graph__compressed_a7a4ced4586e2e353f9076bd447df5208}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!star\+\_\+vertices@{star\+\_\+vertices}}
\index{star\+\_\+vertices@{star\+\_\+vertices}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{star\+\_\+vertices}{star\_vertices}}
{\footnotesize\ttfamily pair$<$vector$<$int$>$, mpz\+\_\+class$>$ marked\+\_\+graph\+\_\+compressed\+::star\+\_\+vertices}



the compressed form of the star\+\_\+vertices list 

\mbox{\Hypertarget{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}\label{classmarked__graph__compressed_a86b00223525703e973415cbc9c94da68}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!type\+\_\+mark@{type\+\_\+mark}}
\index{type\+\_\+mark@{type\+\_\+mark}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{type\+\_\+mark}{type\_mark}}
{\footnotesize\ttfamily vector$<$int$>$ marked\+\_\+graph\+\_\+compressed\+::type\+\_\+mark}



for an edge type t, type\+\_\+mark\mbox{[}t\mbox{]} denotes the mark component of t 

\mbox{\Hypertarget{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}\label{classmarked__graph__compressed_af2e3e55223d436628a02758dfae88493}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!ver\+\_\+type\+\_\+list@{ver\+\_\+type\+\_\+list}}
\index{ver\+\_\+type\+\_\+list@{ver\+\_\+type\+\_\+list}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{ver\+\_\+type\+\_\+list}{ver\_type\_list}}
{\footnotesize\ttfamily vector$<$vector$<$int$>$ $>$ marked\+\_\+graph\+\_\+compressed\+::ver\+\_\+type\+\_\+list}



the list of all vertex types that appear in the graph, where the type of a vertex is a vector of integers, where its index 0 is the mark of the vertex, and indices $3k+1$, $3k+2$, $3k+3$ are $m$, $m'$ and $n_{m,m'}$, where $(m,m')$ is a type pair, and $n_{m,m'}$ is the number of edges connected to the vertex with that type. The list is sorted lexicographically to ensure unique representation. 

\mbox{\Hypertarget{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}\label{classmarked__graph__compressed_af446cc5e23c241a92b76642fd5ebc403}} 
\index{marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}!ver\+\_\+types@{ver\+\_\+types}}
\index{ver\+\_\+types@{ver\+\_\+types}!marked\+\_\+graph\+\_\+compressed@{marked\+\_\+graph\+\_\+compressed}}
\subsubsection{\texorpdfstring{ver\+\_\+types}{ver\_types}}
{\footnotesize\ttfamily pair$<$vector$<$int$>$, mpz\+\_\+class$>$ marked\+\_\+graph\+\_\+compressed\+::ver\+\_\+types}



the compressed form of vertex types, where the type of a vertex is the index with respect to ver\+\_\+type\+\_\+list of the list of integers specifying the type of the vertex (mark of the vertex followed by the number of edges of each type connected to that vertex) 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{marked__graph__compression_8h}{marked\+\_\+graph\+\_\+compression.\+h}\item 
\hyperlink{marked__graph__compression_8cpp}{marked\+\_\+graph\+\_\+compression.\+cpp}\end{DoxyCompactItemize}
