\doxysection{compression\+\_\+helper.\+h File Reference}
\hypertarget{compression__helper_8h}{}\label{compression__helper_8h}\index{compression\_helper.h@{compression\_helper.h}}
{\ttfamily \#include $<$iostream$>$}\newline
{\ttfamily \#include $<$gmpxx.\+h$>$}\newline
{\ttfamily \#include $<$vector$>$}\newline
{\ttfamily \#include $<$stdio.\+h$>$}\newline
{\ttfamily \#include $<$bitset$>$}\newline
{\ttfamily \#include $<$sstream$>$}\newline
{\ttfamily \#include "{}logger.\+h"{}}\newline
\doxysubsubsection*{Namespaces}
\begin{DoxyCompactItemize}
\item 
namespace \mbox{\hyperlink{namespacehelper__vars}{helper\+\_\+vars}}
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
mpz\+\_\+class \mbox{\hyperlink{compression__helper_8h_a4e5c8137a0b072800c7a8f0a80978468}{compute\+\_\+product\+\_\+old}} (int N, int k, int s)
\begin{DoxyCompactList}\small\item\em This function computes the product of consecutive integers separated by a given iteration. This is the old version which uses standard recursion. \end{DoxyCompactList}\item 
mpz\+\_\+class \mbox{\hyperlink{compression__helper_8h_a53d66dd1f27fd1a1986f80419cd2ff36}{compute\+\_\+product\+\_\+stack}} (int N, int k, int s)
\begin{DoxyCompactList}\small\item\em This function computes the product of consecutive integers separated by a given iteration. This is the new version which implements recursion via stack. \end{DoxyCompactList}\item 
mpz\+\_\+class \mbox{\hyperlink{compression__helper_8h_ae2afb43aabe50f7d42aae8f82b5a35f4}{compute\+\_\+product}} (int N, int k, int s)
\item 
void \mbox{\hyperlink{compression__helper_8h_af75857c18e9c23bb114e12642aa8c067}{compute\+\_\+product\+\_\+void}} (int N, int k, int s)
\item 
void \mbox{\hyperlink{compression__helper_8h_a9e9d7382f44b60395f11cdde9c52f4db}{compute\+\_\+array\+\_\+product}} (vector$<$ mpz\+\_\+class $>$ \&a)
\begin{DoxyCompactList}\small\item\em computes the product of elements in vector a by inline multiplication of adjacent elements recursively. The results will be in a\mbox{[}0\mbox{]}. \end{DoxyCompactList}\item 
mpz\+\_\+class \mbox{\hyperlink{compression__helper_8h_acecca9cb279d3b3d82915a07d67818cf}{binomial}} (const int n, const int m)
\begin{DoxyCompactList}\small\item\em computes the binomial coefficient n choose m = n! / m! (n-\/m)! \end{DoxyCompactList}\item 
mpz\+\_\+class \mbox{\hyperlink{compression__helper_8h_a840241744b179325ee9cea41a1124cdc}{prod\+\_\+factorial\+\_\+old}} (const vector$<$ int $>$ \&a, int i, int j)
\begin{DoxyCompactList}\small\item\em computes the product of factorials in a vector given a range \end{DoxyCompactList}\item 
mpz\+\_\+class \mbox{\hyperlink{compression__helper_8h_a86d8a20e022dc06b23df3b08ac10b7d1}{prod\+\_\+factorial}} (const vector$<$ int $>$ \&a, int i, int j)
\item 
int \mbox{\hyperlink{compression__helper_8h_a9a2fbdf1fe0e38f631e7e242a819883b}{bit\+\_\+string\+\_\+write}} (FILE \texorpdfstring{$\ast$}{*}f, const string \&s)
\begin{DoxyCompactList}\small\item\em Write a string containing 0 and 1 to a binary file, treating the string as a bit sequence. Returns the number of bytes written to the output. \end{DoxyCompactList}\item 
string \mbox{\hyperlink{compression__helper_8h_a40e8dcbc036f96b28e003e882c4890b7}{bit\+\_\+string\+\_\+read}} (FILE \texorpdfstring{$\ast$}{*}f)
\begin{DoxyCompactList}\small\item\em Reads a bit sequence from a binary file, assuming the bit sequence was generated by the {\ttfamily bit\+\_\+string\+\_\+write} function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
mpz\+\_\+class \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\+\_\+vars\+::mul\+\_\+1}}
\item 
mpz\+\_\+class \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\+\_\+vars\+::mul\+\_\+2}}
\begin{DoxyCompactList}\small\item\em helper variables in order to avoid initialization \end{DoxyCompactList}\item 
vector$<$ mpz\+\_\+class $>$ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\+\_\+vars\+::return\+\_\+stack}}
\item 
vector$<$ mpz\+\_\+class $>$ \mbox{\hyperlink{namespacehelper__vars_a54af4d4cefd8ae34c16c2b89992da473}{helper\+\_\+vars\+::mpz\+\_\+vec}}
\item 
vector$<$ mpz\+\_\+class $>$ \mbox{\hyperlink{namespacehelper__vars_ae0c8e9c39baed3d84b0f24cb7ef4c3e9}{helper\+\_\+vars\+::mpz\+\_\+vec2}}
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{compression__helper_8h_acecca9cb279d3b3d82915a07d67818cf}\label{compression__helper_8h_acecca9cb279d3b3d82915a07d67818cf} 
\index{compression\_helper.h@{compression\_helper.h}!binomial@{binomial}}
\index{binomial@{binomial}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{binomial()}{binomial()}}
{\footnotesize\ttfamily mpz\+\_\+class binomial (\begin{DoxyParamCaption}\item[{const int}]{n,  }\item[{const int}]{m }\end{DoxyParamCaption})}



computes the binomial coefficient n choose m = n! / m! (n-\/m)! 


\begin{DoxyParams}{Parameters}
{\em n} & integer \\
\hline
{\em m} & integer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the binomial coefficient n! / m! (n-\/m)!. If n \texorpdfstring{$<$}{<}= 0, or m \texorpdfstring{$>$}{>} n, or m \texorpdfstring{$<$}{<}= 0, returns 0 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00319\ \{}
\DoxyCodeLine{00320\ \ \ \textcolor{keywordflow}{if}\ (n\ <=\ 0\ or\ m\ >\ n\ or\ m\ <=\ 0)}
\DoxyCodeLine{00321\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00322\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{compression__helper_8cpp_ae2afb43aabe50f7d42aae8f82b5a35f4}{compute\_product}}(n,\ m,\ 1)\ /\ \mbox{\hyperlink{compression__helper_8cpp_ae2afb43aabe50f7d42aae8f82b5a35f4}{compute\_product}}(m,\ m,\ 1);}
\DoxyCodeLine{00323\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_a40e8dcbc036f96b28e003e882c4890b7}\label{compression__helper_8h_a40e8dcbc036f96b28e003e882c4890b7} 
\index{compression\_helper.h@{compression\_helper.h}!bit\_string\_read@{bit\_string\_read}}
\index{bit\_string\_read@{bit\_string\_read}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{bit\_string\_read()}{bit\_string\_read()}}
{\footnotesize\ttfamily string bit\+\_\+string\+\_\+read (\begin{DoxyParamCaption}\item[{FILE \texorpdfstring{$\ast$}{*}}]{f }\end{DoxyParamCaption})}



Reads a bit sequence from a binary file, assuming the bit sequence was generated by the {\ttfamily bit\+\_\+string\+\_\+write} function. 


\begin{DoxyParams}{Parameters}
{\em f} & a file pointer \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a string of zeros and ones. 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00376\ \ \ \textcolor{keywordtype}{int}\ nu\_bytes;}
\DoxyCodeLine{00377\ \ \ \textcolor{keywordtype}{int}\ ssize;}
\DoxyCodeLine{00378\ \ \ \textcolor{comment}{//\ read\ the\ number\ of\ bytes\ to\ read}}
\DoxyCodeLine{00379\ \ \ fread(\&ssize,\ \textcolor{keyword}{sizeof}(ssize),\ 1,\ f);}
\DoxyCodeLine{00380\ \ \ \textcolor{comment}{//cerr\ <<\ "{}\ ssize\ "{}\ <<\ ssize\ <<\ endl;}}
\DoxyCodeLine{00381\ \ \ nu\_bytes\ =\ ssize\ /\ 8;}
\DoxyCodeLine{00382\ \ \ \textcolor{keywordflow}{if}\ (ssize\ \%\ 8\ !=\ 0)}
\DoxyCodeLine{00383\ \ \ \ \ nu\_bytes\ ++;}
\DoxyCodeLine{00384\ }
\DoxyCodeLine{00385\ \ \ \textcolor{keywordtype}{int}\ last\_byte\_size\ =\ ssize\ \%\ 8;}
\DoxyCodeLine{00386\ \ \ \textcolor{keywordflow}{if}\ (last\_byte\_size\ ==\ 0)}
\DoxyCodeLine{00387\ \ \ \ \ last\_byte\_size\ \ =\ 8;}
\DoxyCodeLine{00388\ }
\DoxyCodeLine{00389\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ c;}
\DoxyCodeLine{00390\ \ \ bitset<8>\ B;}
\DoxyCodeLine{00391\ \ \ \textcolor{keywordtype}{string}\ s;\ }
\DoxyCodeLine{00392\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i=0;i<nu\_bytes;i++)\{}
\DoxyCodeLine{00393\ \ \ \ \ fread(\&c,\ \textcolor{keyword}{sizeof}(c),\ 1,\ f);}
\DoxyCodeLine{00394\ \ \ \ \ B\ =\ c;}
\DoxyCodeLine{00395\ \ \ \ \ \textcolor{comment}{//cout\ <<\ B\ <<\ endl;}}
\DoxyCodeLine{00396\ \ \ \ \ \textcolor{keywordflow}{if}\ (i\ <\ nu\_bytes\ -\/1)\{}
\DoxyCodeLine{00397\ \ \ \ \ \ \ s\ +=\ B.to\_string();}
\DoxyCodeLine{00398\ \ \ \ \ \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00399\ \ \ \ \ \ \ s\ +=\ B.to\_string().substr(8-\/last\_byte\_size,\ last\_byte\_size);}
\DoxyCodeLine{00400\ \ \ \ \ \}}
\DoxyCodeLine{00401\ \ \ \}}
\DoxyCodeLine{00402\ \ \ \textcolor{keywordflow}{return}\ s;}
\DoxyCodeLine{00403\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_a9a2fbdf1fe0e38f631e7e242a819883b}\label{compression__helper_8h_a9a2fbdf1fe0e38f631e7e242a819883b} 
\index{compression\_helper.h@{compression\_helper.h}!bit\_string\_write@{bit\_string\_write}}
\index{bit\_string\_write@{bit\_string\_write}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{bit\_string\_write()}{bit\_string\_write()}}
{\footnotesize\ttfamily int bit\+\_\+string\+\_\+write (\begin{DoxyParamCaption}\item[{FILE \texorpdfstring{$\ast$}{*}}]{f,  }\item[{const string \&}]{s }\end{DoxyParamCaption})}



Write a string containing 0 and 1 to a binary file, treating the string as a bit sequence. Returns the number of bytes written to the output. 

First, the size of the bit sequence is written to the output, then the input is split into 8 bit chunks, perhaps with some leftover, which are written to the output file as bytes. 
\begin{DoxyParams}{Parameters}
{\em f} & a file pointer \\
\hline
{\em s} & a string where each character is either 0 or 1 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of bytes written to the output 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00351\ \ \ \textcolor{comment}{//\ find\ out\ the\ number\ of\ bytes}}
\DoxyCodeLine{00352\ \ \ \textcolor{keywordtype}{int}\ ssize\ =\ s.size();}
\DoxyCodeLine{00353\ \ \ \textcolor{keywordtype}{int}\ nu\_bytes;\ \textcolor{comment}{//\ number\ of\ bytes\ wrote\ to\ the\ output}}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \textcolor{comment}{//if\ (ssize\ \%\ 8\ !=\ 0)\ //\ an\ incomplete\ byte\ is\ required}}
\DoxyCodeLine{00356\ \ \ \textcolor{comment}{//nu\_bytes++;}}
\DoxyCodeLine{00357\ }
\DoxyCodeLine{00358\ \ \ fwrite(\&ssize,\ \textcolor{keyword}{sizeof}(ssize),\ 1,\ f);\ \textcolor{comment}{//\ first,\ write\ down\ how\ many\ bytes\ are\ coming.}}
\DoxyCodeLine{00359\ \ \ nu\_bytes\ +=\ \textcolor{keyword}{sizeof}(ssize);}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ stringstream\ ss;}
\DoxyCodeLine{00362\ \ \ ss\ <<\ s;}
\DoxyCodeLine{00363\ }
\DoxyCodeLine{00364\ \ \ bitset<8>\ B;}
\DoxyCodeLine{00365\ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ c;\ }
\DoxyCodeLine{00366\ \ \ \textcolor{keywordflow}{while}\ (ss\ >>\ B)\{}
\DoxyCodeLine{00367\ \ \ \ \ c\ =\ B.to\_ulong();}
\DoxyCodeLine{00368\ \ \ \ \ fwrite(\&c,\ \textcolor{keyword}{sizeof}(c),\ 1,\ f);}
\DoxyCodeLine{00369\ \ \ \ \ nu\_bytes\ +=\ \textcolor{keyword}{sizeof}(c);}
\DoxyCodeLine{00370\ \ \ \}}
\DoxyCodeLine{00371\ \ \ \textcolor{keywordflow}{return}\ nu\_bytes;\ }
\DoxyCodeLine{00372\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_a9e9d7382f44b60395f11cdde9c52f4db}\label{compression__helper_8h_a9e9d7382f44b60395f11cdde9c52f4db} 
\index{compression\_helper.h@{compression\_helper.h}!compute\_array\_product@{compute\_array\_product}}
\index{compute\_array\_product@{compute\_array\_product}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{compute\_array\_product()}{compute\_array\_product()}}
{\footnotesize\ttfamily void compute\+\_\+array\+\_\+product (\begin{DoxyParamCaption}\item[{vector$<$ mpz\+\_\+class $>$ \&}]{a }\end{DoxyParamCaption})}



computes the product of elements in vector a by inline multiplication of adjacent elements recursively. The results will be in a\mbox{[}0\mbox{]}. 


\begin{DoxyCode}{0}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00238\ \ \ \textcolor{comment}{//logger::item\_start("{}Compute\ Array\ Product"{});}}
\DoxyCodeLine{00239\ \ \ \textcolor{keywordtype}{int}\ step\_size,\ to\_mul;\ }
\DoxyCodeLine{00240\ \ \ \textcolor{keywordtype}{int}\ k\ =\ a.size();\ }
\DoxyCodeLine{00241\ \ \ \textcolor{keywordflow}{for}\ (step\_size\ =\ 2,\ to\_mul\ =\ 1;\ to\_mul\ <\ k;\ step\_size\ <<=1,\ to\_mul\ <<=1)\{}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i=0;\ i<k;\ i+=step\_size)\{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (i+to\_mul\ <\ k)}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ a[i]\ *=\ a[i+to\_mul];}
\DoxyCodeLine{00245\ \ \ \ \ \}}
\DoxyCodeLine{00246\ \ \ \}}
\DoxyCodeLine{00247\ \ \ \textcolor{comment}{//logger::item\_stop("{}Compute\ Array\ Product"{});}}
\DoxyCodeLine{00248\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_ae2afb43aabe50f7d42aae8f82b5a35f4}\label{compression__helper_8h_ae2afb43aabe50f7d42aae8f82b5a35f4} 
\index{compression\_helper.h@{compression\_helper.h}!compute\_product@{compute\_product}}
\index{compute\_product@{compute\_product}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{compute\_product()}{compute\_product()}}
{\footnotesize\ttfamily mpz\+\_\+class compute\+\_\+product (\begin{DoxyParamCaption}\item[{int}]{N,  }\item[{int}]{k,  }\item[{int}]{s }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00252\ \ \ \textcolor{keywordflow}{if}\ (k==1)}
\DoxyCodeLine{00253\ \ \ \ \ \textcolor{keywordflow}{return}\ N;}
\DoxyCodeLine{00254\ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ 0)\ \textcolor{comment}{//\ TO\ CHECK\ because\ there\ are\ no\ terms\ to\ compute\ product}}
\DoxyCodeLine{00255\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00256\ }
\DoxyCodeLine{00257\ \ \ \textcolor{keywordflow}{if}\ (k\ <\ 0)\{}
\DoxyCodeLine{00258\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}\ WARNING:\ compute\_product\ called\ for\ k\ <\ 0,\ returning\ 1,\ N\ \ "{}}\ <<\ N\ <<\ \textcolor{stringliteral}{"{}\ k\ "{}}\ <<\ k\ <<\ \textcolor{stringliteral}{"{}\ s\ "{}}\ <<\ s\ <<\ endl;}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00260\ \ \ \}}
\DoxyCodeLine{00261\ \ \ \textcolor{keywordflow}{if}\ (N\ -\/\ (k-\/1)\ *\ s\ <=\ 0)\{\ \textcolor{comment}{//\ the\ terms\ go\ negative}}
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{comment}{//cerr\ <<\ "{}\ WARNING:\ compute\_product\ called\ for\ N\ -\/\ (k-\/1)\ *\ s\ <=\ 0\ "{}\ <<\ endl;}}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00264\ \ \ \}}
\DoxyCodeLine{00265\ }
\DoxyCodeLine{00266\ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ 2)\{}
\DoxyCodeLine{00267\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ =\ N;}
\DoxyCodeLine{00268\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}}\ =\ N\ -\/\ s;}
\DoxyCodeLine{00269\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ *\ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}};}
\DoxyCodeLine{00270\ \ \ \}}
\DoxyCodeLine{00271\ }
\DoxyCodeLine{00272\ \ \ \mbox{\hyperlink{namespacehelper__vars_a54af4d4cefd8ae34c16c2b89992da473}{helper\_vars::mpz\_vec}}.resize(k);}
\DoxyCodeLine{00273\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i=0;i<k;i++)}
\DoxyCodeLine{00274\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a54af4d4cefd8ae34c16c2b89992da473}{helper\_vars::mpz\_vec}}[i]\ =\ N\ -\/\ i\ *\ s;}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \ \ \mbox{\hyperlink{compression__helper_8cpp_a9e9d7382f44b60395f11cdde9c52f4db}{compute\_array\_product}}(\mbox{\hyperlink{namespacehelper__vars_a54af4d4cefd8ae34c16c2b89992da473}{helper\_vars::mpz\_vec}});}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \textcolor{comment}{//\ int\ step\_size,\ to\_mul;\ }}
\DoxyCodeLine{00279\ }
\DoxyCodeLine{00280\ }
\DoxyCodeLine{00281\ \ \ \textcolor{comment}{//\ for\ (step\_size\ =\ 2,\ to\_mul\ =\ 1;\ to\_mul\ <\ k;\ step\_size\ <<=1,\ to\_mul\ <<=1)\{}}
\DoxyCodeLine{00282\ \ \ \textcolor{comment}{//\ \ \ for\ (int\ i=0;\ i<k;\ i+=step\_size)\{}}
\DoxyCodeLine{00283\ \ \ \textcolor{comment}{//\ \ \ \ \ if\ (i+to\_mul\ <\ k)}}
\DoxyCodeLine{00284\ \ \ \textcolor{comment}{//\ \ \ \ \ \ \ helper\_vars::mpz\_vec[i]\ *=\ helper\_vars::mpz\_vec[i+to\_mul];}}
\DoxyCodeLine{00285\ \ \ \textcolor{comment}{//\ \ \ \}}}
\DoxyCodeLine{00286\ \ \ \textcolor{comment}{//\ \}}}
\DoxyCodeLine{00287\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacehelper__vars_a54af4d4cefd8ae34c16c2b89992da473}{helper\_vars::mpz\_vec}}[0];}
\DoxyCodeLine{00288\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_a4e5c8137a0b072800c7a8f0a80978468}\label{compression__helper_8h_a4e5c8137a0b072800c7a8f0a80978468} 
\index{compression\_helper.h@{compression\_helper.h}!compute\_product\_old@{compute\_product\_old}}
\index{compute\_product\_old@{compute\_product\_old}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{compute\_product\_old()}{compute\_product\_old()}}
{\footnotesize\ttfamily mpz\+\_\+class compute\+\_\+product\+\_\+old (\begin{DoxyParamCaption}\item[{int}]{N,  }\item[{int}]{k,  }\item[{int}]{s }\end{DoxyParamCaption})}



This function computes the product of consecutive integers separated by a given iteration. This is the old version which uses standard recursion. 


\begin{DoxyParams}{Parameters}
{\em N} & The first term in the product \\
\hline
{\em k} & the number of terms in the product \\
\hline
{\em s} & the iteration \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the product N $ N \times (N-s) \times (N-2s) \times \dots \times (N-(k-1)s) $ 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00009\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00010\ \ \ \textcolor{comment}{//cerr\ <<\ "{}\ compute\_product\ \ N\ "{}\ <<\ N\ <<\ "{}\ k\ "{}\ <<\ k\ <<\ "{}\ s\ "{}\ <<\ s\ <<\ endl;}}
\DoxyCodeLine{00011\ }
\DoxyCodeLine{00012\ \ \ \textcolor{keywordflow}{if}\ (k==1)}
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{keywordflow}{return}\ N;}
\DoxyCodeLine{00014\ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ 0)\ \textcolor{comment}{//\ TO\ CHECK\ because\ there\ are\ no\ terms\ to\ compute\ product}}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \ \ \textcolor{keywordflow}{if}\ (k\ <\ 0)\{}
\DoxyCodeLine{00018\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}\ WARNING:\ compute\_product\ called\ for\ k\ <\ 0,\ returning\ 1,\ N\ \ "{}}\ <<\ N\ <<\ \textcolor{stringliteral}{"{}\ k\ "{}}\ <<\ k\ <<\ \textcolor{stringliteral}{"{}\ s\ "{}}\ <<\ s\ <<\ endl;}
\DoxyCodeLine{00019\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00020\ \ \ \}}
\DoxyCodeLine{00021\ \ \ \textcolor{keywordflow}{if}\ (N\ -\/\ (k-\/1)\ *\ s\ <=\ 0)\{\ \textcolor{comment}{//\ the\ terms\ go\ negative}}
\DoxyCodeLine{00022\ \ \ \ \ \textcolor{comment}{//cerr\ <<\ "{}\ WARNING:\ compute\_product\ called\ for\ N\ -\/\ (k-\/1)\ *\ s\ <=\ 0\ "{}\ <<\ endl;}}
\DoxyCodeLine{00023\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00024\ \ \ \}}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ 2)}
\DoxyCodeLine{00027\ \ \ \ \ \textcolor{keywordflow}{return}\ mpz\_class(N)\ *\ mpz\_class(N-\/s);}
\DoxyCodeLine{00028\ \ \ \textcolor{comment}{//\ we\ do\ this\ by\ dividing\ the\ terms\ into\ two\ parts}}
\DoxyCodeLine{00029\ \ \ \textcolor{keywordtype}{int}\ m\ =\ k\ /\ 2;\ \textcolor{comment}{//\ the\ middle\ point}}
\DoxyCodeLine{00030\ \ \ mpz\_class\ left,\ right;\ \textcolor{comment}{//\ each\ of\ the\ half\ products\ }}
\DoxyCodeLine{00031\ \ \ left\ =\ \mbox{\hyperlink{compression__helper_8cpp_ae2afb43aabe50f7d42aae8f82b5a35f4}{compute\_product}}(N,\ m,\ s);}
\DoxyCodeLine{00032\ \ \ right\ =\ \mbox{\hyperlink{compression__helper_8cpp_ae2afb43aabe50f7d42aae8f82b5a35f4}{compute\_product}}(N-\/m\ *\ s,\ k-\/m,\ s);}
\DoxyCodeLine{00033\ \ \ \textcolor{comment}{//logger::item\_start("{}cp\_mul"{});}}
\DoxyCodeLine{00034\ \ \ mpz\_class\ ans\ =\ left*right;}
\DoxyCodeLine{00035\ \ \ \textcolor{comment}{//logger::item\_stop("{}cp\_mul"{});}}
\DoxyCodeLine{00036\ \ \ \textcolor{keywordflow}{return}\ ans;}
\DoxyCodeLine{00037\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_a53d66dd1f27fd1a1986f80419cd2ff36}\label{compression__helper_8h_a53d66dd1f27fd1a1986f80419cd2ff36} 
\index{compression\_helper.h@{compression\_helper.h}!compute\_product\_stack@{compute\_product\_stack}}
\index{compute\_product\_stack@{compute\_product\_stack}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{compute\_product\_stack()}{compute\_product\_stack()}}
{\footnotesize\ttfamily mpz\+\_\+class compute\+\_\+product\+\_\+stack (\begin{DoxyParamCaption}\item[{int}]{N,  }\item[{int}]{k,  }\item[{int}]{s }\end{DoxyParamCaption})}



This function computes the product of consecutive integers separated by a given iteration. This is the new version which implements recursion via stack. 


\begin{DoxyParams}{Parameters}
{\em N} & The first term in the product \\
\hline
{\em k} & the number of terms in the product \\
\hline
{\em s} & the iteration \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the product N $ N \times (N-s) \times (N-2s) \times \dots \times (N-(k-1)s) $ 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \textcolor{keywordflow}{if}\ (k==1)}
\DoxyCodeLine{00042\ \ \ \ \ \textcolor{keywordflow}{return}\ N;}
\DoxyCodeLine{00043\ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ 0)\ \textcolor{comment}{//\ TO\ CHECK\ because\ there\ are\ no\ terms\ to\ compute\ product}}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00045\ }
\DoxyCodeLine{00046\ \ \ \textcolor{keywordflow}{if}\ (k\ <\ 0)\{}
\DoxyCodeLine{00047\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}\ WARNING:\ compute\_product\ called\ for\ k\ <\ 0,\ returning\ 1,\ N\ \ "{}}\ <<\ N\ <<\ \textcolor{stringliteral}{"{}\ k\ "{}}\ <<\ k\ <<\ \textcolor{stringliteral}{"{}\ s\ "{}}\ <<\ s\ <<\ endl;}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordflow}{return}\ 1;}
\DoxyCodeLine{00049\ \ \ \}}
\DoxyCodeLine{00050\ \ \ \textcolor{keywordflow}{if}\ (N\ -\/\ (k-\/1)\ *\ s\ <=\ 0)\{\ \textcolor{comment}{//\ the\ terms\ go\ negative}}
\DoxyCodeLine{00051\ \ \ \ \ \textcolor{comment}{//cerr\ <<\ "{}\ WARNING:\ compute\_product\ called\ for\ N\ -\/\ (k-\/1)\ *\ s\ <=\ 0\ "{}\ <<\ endl;}}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{return}\ 0;}
\DoxyCodeLine{00053\ \ \ \}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ 2)\{}
\DoxyCodeLine{00056\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ =\ N;}
\DoxyCodeLine{00057\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}}\ =\ N\ -\/\ s;}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ *\ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}};}
\DoxyCodeLine{00059\ \ \ \}}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ \ \ \mbox{\hyperlink{classlogger_a7e21ec6ad2d40cfc2c6a383521b5641a}{logger::item\_start}}(\textcolor{stringliteral}{"{}CP\ body"{}});}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \textcolor{keywordtype}{int}\ k\_bits\ =\ 0;\ \textcolor{comment}{//\ roughly\ ,\ the\ number\ of\ bits\ in\ k,\ the\ depth\ of\ the\ stack\ during\ run\ time}}
\DoxyCodeLine{00064\ \ \ \textcolor{keywordtype}{int}\ k\_copy\ =\ k;}
\DoxyCodeLine{00065\ \ \ \textcolor{keywordflow}{while}\ (k\_copy\ >\ 0)\{}
\DoxyCodeLine{00066\ \ \ \ \ k\_bits\ ++;}
\DoxyCodeLine{00067\ \ \ \ \ k\_copy\ >>=\ 1;}
\DoxyCodeLine{00068\ \ \ \}}
\DoxyCodeLine{00069\ \ \ k\_bits\ +=\ 2;\ }
\DoxyCodeLine{00070\ \ \ vector<pair<int,\ int>\ >\ call\_stack(2\ *\ k\_bits);}
\DoxyCodeLine{00071\ \ \ \textcolor{comment}{//cout\ <<\ "{}\ 2\ *\ k\_bits\ "{}\ <<\ 2\ *\ k\_bits\ <<\ endl;\ }}
\DoxyCodeLine{00072\ \ \ \textcolor{keywordtype}{int}\ call\_pointer\ =\ 0;\ \textcolor{comment}{//\ size\ of\ the\ call\ pointer,\ so\ the\ top\ index\ is\ call\_pointer\ -\/\ 1}}
\DoxyCodeLine{00073\ \ \ vector<int>\ status\_stack(2\ *\ k\_bits);\ \textcolor{comment}{//\ 0:\ first\ meet,\ 1:\ to\ return\ }}
\DoxyCodeLine{00074\ \ \ \textcolor{comment}{//vector<mpz\_class>\ return\_stack(2\ *\ k\_bits);}}
\DoxyCodeLine{00075\ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}.resize(2*k\_bits);}
\DoxyCodeLine{00076\ \ \ \textcolor{keywordtype}{int}\ return\_pointer\ =\ 0;}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ call\_stack[call\_pointer]\ =\ pair<int,\ int>\ (N,\ k);}
\DoxyCodeLine{00079\ \ \ status\_stack[call\_pointer]\ =\ 0;}
\DoxyCodeLine{00080\ \ \ call\_pointer\ ++;}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ \textcolor{keywordtype}{int}\ m;}
\DoxyCodeLine{00083\ \ \ \textcolor{keywordtype}{int}\ N\_now,\ k\_now;\ \textcolor{comment}{//\ N\ and\ k\ for\ the\ current\ stack\ element}}
\DoxyCodeLine{00084\ \ \ }
\DoxyCodeLine{00085\ \ \ \textcolor{keywordflow}{while}\ (call\_pointer\ >\ 0)\{}
\DoxyCodeLine{00086\ \ \ \ \ N\_now\ =\ call\_stack[call\_pointer-\/1].first;}
\DoxyCodeLine{00087\ \ \ \ \ k\_now\ =\ call\_stack[call\_pointer-\/1].second;}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{comment}{//cout\ <<\ "{}call\_pointer\ =\ "{}\ <<\ call\_pointer\ <<\ "{}\ N\ =\ "{}\ <<\ N\_now\ <<\ "{}\ k\ =\ "{}\ <<\ k\_now\ <<\ "{}\ stat\ =\ "{}\ <<\ status\_stack[call\_pointer-\/1]\ <<\ endl;}}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{comment}{//cout\ <<\ "{}\ the\ whole\ stack\ "{}\ <<\ endl;}}
\DoxyCodeLine{00090\ \ \ \ \ \textcolor{comment}{//for\ (int\ i=0;i<call\_pointer;\ i++)\{}}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{comment}{//\ \ cout\ <<\ call\_stack[i].first\ <<\ "{}\ ,\ "{}\ <<\ call\_stack[i].second\ <<\ "{}\ "{}\ <<\ status\_stack[i]\ <<\ endl;}}
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{if}\ (status\_stack[call\_pointer-\/1]\ ==\ 1)\{\ \textcolor{comment}{//\ we\ should\ multiply\ two\ top\ elements\ in\ the\ return\ stack}}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \textcolor{comment}{//\ to\ collect\ two\ top\ elements\ in\ return\ stack\ and\ multiply\ them}}
\DoxyCodeLine{00095\ \ \ \ \ \ \ \mbox{\hyperlink{classlogger_a7e21ec6ad2d40cfc2c6a383521b5641a}{logger::item\_start}}(\textcolor{stringliteral}{"{}CP\ arithmetic"{}});}
\DoxyCodeLine{00096\ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer-\/2]\ =\ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer-\/2]\ *\ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer-\/1];}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \mbox{\hyperlink{classlogger_a6775fee9681c437fc9c05d71cfbbe4a2}{logger::item\_stop}}(\textcolor{stringliteral}{"{}CP\ arithmetic"{}});}
\DoxyCodeLine{00098\ \ \ \ \ \ \ return\_pointer-\/-\/;\ \textcolor{comment}{//\ remove\ two\ items,\ add\ one\ item}}
\DoxyCodeLine{00099\ \ \ \ \ \ \ call\_pointer\ -\/-\/;}
\DoxyCodeLine{00100\ \ \ \ \ \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \textcolor{comment}{//cout\ <<\ "{}\ else\ "{}\ <<\ endl;}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(k\_now\ ==\ 1)\{}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ to\ return\ the\ corresponding\ N}}
\DoxyCodeLine{00104\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer++]\ =\ call\_stack[call\_pointer-\/1].first;}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ call\_pointer\ -\/-\/;\ \textcolor{comment}{//\ pop\ this\ element}}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\_now\ ==\ 2)\{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ =\ N\_now;}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}}\ =\ N\_now\ -\/\ s;}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classlogger_a7e21ec6ad2d40cfc2c6a383521b5641a}{logger::item\_start}}(\textcolor{stringliteral}{"{}CP\ arithmetic"{}});}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer++]\ =\ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ *\ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}};}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{classlogger_a6775fee9681c437fc9c05d71cfbbe4a2}{logger::item\_stop}}(\textcolor{stringliteral}{"{}CP\ arithmetic"{}});}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ call\_pointer\ -\/-\/;\ }
\DoxyCodeLine{00114\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\_now\ >\ 2)\{}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ m\ =\ k\_now\ /\ 2;}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ status\_stack[call\_pointer-\/1]\ =\ 1;\ \textcolor{comment}{//\ when\ return\ to\ this\ state,\ we\ know\ that\ we\ should\ aggregate\ }}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ call\_stack[call\_pointer]\ =\ pair<int,\ int>(N\_now,\ m);}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ status\_stack[call\_pointer]\ =\ 0;\ \textcolor{comment}{//\ just\ added}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ call\_stack[call\_pointer+1]\ =\ pair<int,\ int>(N\_now\ -\/\ m*s,\ k\_now\ -\/\ m\ );}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ status\_stack[call\_pointer+1]\ \ =\ 0;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ call\_pointer\ +=\ 2;\ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00124\ \ \ \ \ \}}
\DoxyCodeLine{00125\ \ \ \}}
\DoxyCodeLine{00126\ \ \ \textcolor{comment}{//\ make\ sure\ there\ is\ exactly\ one\ element\ in\ return\ stack}}
\DoxyCodeLine{00127\ \ \ \textcolor{keywordflow}{if}\ (return\_pointer\ !=\ 1)\{}
\DoxyCodeLine{00128\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}\ return\ pointer\ is\ not\ zero"{}};}
\DoxyCodeLine{00129\ \ \ \}}
\DoxyCodeLine{00130\ \ \ \mbox{\hyperlink{classlogger_a6775fee9681c437fc9c05d71cfbbe4a2}{logger::item\_stop}}(\textcolor{stringliteral}{"{}CP\ body"{}});}
\DoxyCodeLine{00131\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[0];\ \textcolor{comment}{//\ the\ top\ element\ remaining\ in\ the\ return\ stack\ }}
\DoxyCodeLine{00132\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_af75857c18e9c23bb114e12642aa8c067}\label{compression__helper_8h_af75857c18e9c23bb114e12642aa8c067} 
\index{compression\_helper.h@{compression\_helper.h}!compute\_product\_void@{compute\_product\_void}}
\index{compute\_product\_void@{compute\_product\_void}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{compute\_product\_void()}{compute\_product\_void()}}
{\footnotesize\ttfamily void compute\+\_\+product\+\_\+void (\begin{DoxyParamCaption}\item[{int}]{N,  }\item[{int}]{k,  }\item[{int}]{s }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00137\ \ \ \textcolor{comment}{//cerr\ <<\ "{}\ void\ called\ N\ "{}\ <<\ N\ <<\ "{}\ k\ "{}\ <<\ k\ <<\ "{}\ s\ "{}\ <<\ s\ <<\ endl;}}
\DoxyCodeLine{00138\ \ \ \textcolor{keywordflow}{if}\ (k==1)\{}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}.resize(1);}
\DoxyCodeLine{00140\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[0]\ =\ N;\textcolor{comment}{//return\ N;}}
\DoxyCodeLine{00141\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00142\ \ \ \}}
\DoxyCodeLine{00143\ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ 0)\{\ \textcolor{comment}{//\ TO\ CHECK\ because\ there\ are\ no\ terms\ to\ compute\ product}}
\DoxyCodeLine{00144\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}.resize(1);}
\DoxyCodeLine{00145\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[0]\ =\ 1;\textcolor{comment}{//return\ 1;}}
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00147\ \ \ \}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \textcolor{keywordflow}{if}\ (k\ <\ 0)\{}
\DoxyCodeLine{00150\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}\ WARNING:\ compute\_product\ called\ for\ k\ <\ 0,\ returning\ 1,\ N\ \ "{}}\ <<\ N\ <<\ \textcolor{stringliteral}{"{}\ k\ "{}}\ <<\ k\ <<\ \textcolor{stringliteral}{"{}\ s\ "{}}\ <<\ s\ <<\ endl;}
\DoxyCodeLine{00151\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}.resize(1);}
\DoxyCodeLine{00152\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[0]\ =\ 1;\textcolor{comment}{//return\ 1;}}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00154\ \ \ \}}
\DoxyCodeLine{00155\ \ \ \textcolor{keywordflow}{if}\ (N\ -\/\ (k-\/1)\ *\ s\ <=\ 0)\{\ \textcolor{comment}{//\ the\ terms\ go\ negative}}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{comment}{//cerr\ <<\ "{}\ WARNING:\ compute\_product\ called\ for\ N\ -\/\ (k-\/1)\ *\ s\ <=\ 0\ "{}\ <<\ endl;}}
\DoxyCodeLine{00157\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}.resize(1);}
\DoxyCodeLine{00158\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[0]\ =\ 0;\ \textcolor{comment}{//return\ 0;}}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00160\ \ \ \}}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00162\ \ \ \textcolor{keywordflow}{if}\ (k\ ==\ 2)\{}
\DoxyCodeLine{00163\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ =\ N;}
\DoxyCodeLine{00164\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}}\ =\ N\ -\/\ s;}
\DoxyCodeLine{00165\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}.resize(1);}
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[0]\ =\ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ *\ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}};}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00168\ \ \ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \textcolor{keywordtype}{int}\ k\_bits\ =\ 0;\ \textcolor{comment}{//\ roughly\ ,\ the\ number\ of\ bits\ in\ k,\ the\ depth\ of\ the\ stack\ during\ run\ time}}
\DoxyCodeLine{00171\ \ \ \textcolor{keywordtype}{int}\ k\_copy\ =\ k;}
\DoxyCodeLine{00172\ \ \ \textcolor{keywordflow}{while}\ (k\_copy\ >\ 0)\{}
\DoxyCodeLine{00173\ \ \ \ \ k\_bits\ ++;}
\DoxyCodeLine{00174\ \ \ \ \ k\_copy\ >>=\ 1;}
\DoxyCodeLine{00175\ \ \ \}}
\DoxyCodeLine{00176\ \ \ k\_bits\ +=\ 2;\ }
\DoxyCodeLine{00177\ \ \ vector<pair<int,\ int>\ >\ call\_stack(2\ *\ k\_bits);}
\DoxyCodeLine{00178\ \ \ \textcolor{comment}{//cout\ <<\ "{}\ 2\ *\ k\_bits\ "{}\ <<\ 2\ *\ k\_bits\ <<\ endl;\ }}
\DoxyCodeLine{00179\ \ \ \textcolor{keywordtype}{int}\ call\_pointer\ =\ 0;\ \textcolor{comment}{//\ size\ of\ the\ call\ pointer,\ so\ the\ top\ index\ is\ call\_pointer\ -\/\ 1}}
\DoxyCodeLine{00180\ \ \ vector<int>\ status\_stack(2\ *\ k\_bits);\ \textcolor{comment}{//\ 0:\ first\ meet,\ 1:\ to\ return\ }}
\DoxyCodeLine{00181\ \ \ \textcolor{comment}{//vector<mpz\_class>\ return\_stack(2\ *\ k\_bits);}}
\DoxyCodeLine{00182\ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}.resize(2*k\_bits);}
\DoxyCodeLine{00183\ \ \ \textcolor{keywordtype}{int}\ return\_pointer\ =\ 0;}
\DoxyCodeLine{00184\ }
\DoxyCodeLine{00185\ \ \ call\_stack[call\_pointer]\ =\ pair<int,\ int>\ (N,\ k);}
\DoxyCodeLine{00186\ \ \ status\_stack[call\_pointer]\ =\ 0;}
\DoxyCodeLine{00187\ \ \ call\_pointer\ ++;}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \textcolor{keywordtype}{int}\ m;}
\DoxyCodeLine{00190\ \ \ \textcolor{keywordtype}{int}\ N\_now,\ k\_now;\ \textcolor{comment}{//\ N\ and\ k\ for\ the\ current\ stack\ element}}
\DoxyCodeLine{00191\ \ \ }
\DoxyCodeLine{00192\ \ \ \textcolor{keywordflow}{while}\ (call\_pointer\ >\ 0)\{}
\DoxyCodeLine{00193\ \ \ \ \ N\_now\ =\ call\_stack[call\_pointer-\/1].first;}
\DoxyCodeLine{00194\ \ \ \ \ k\_now\ =\ call\_stack[call\_pointer-\/1].second;}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{comment}{//cout\ <<\ "{}call\_pointer\ =\ "{}\ <<\ call\_pointer\ <<\ "{}\ N\ =\ "{}\ <<\ N\_now\ <<\ "{}\ k\ =\ "{}\ <<\ k\_now\ <<\ "{}\ stat\ =\ "{}\ <<\ status\_stack[call\_pointer-\/1]\ <<\ endl;}}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{comment}{//cout\ <<\ "{}\ the\ whole\ stack\ "{}\ <<\ endl;}}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{comment}{//for\ (int\ i=0;i<call\_pointer;\ i++)\{}}
\DoxyCodeLine{00198\ \ \ \ \ \textcolor{comment}{//\ \ cout\ <<\ call\_stack[i].first\ <<\ "{}\ ,\ "{}\ <<\ call\_stack[i].second\ <<\ "{}\ "{}\ <<\ status\_stack[i]\ <<\ endl;}}
\DoxyCodeLine{00199\ \ \ \ \ \textcolor{comment}{//\}}}
\DoxyCodeLine{00200\ \ \ \ \ \textcolor{keywordflow}{if}\ (status\_stack[call\_pointer-\/1]\ ==\ 1)\{\ \textcolor{comment}{//\ we\ should\ multiply\ two\ top\ elements\ in\ the\ return\ stack}}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \textcolor{comment}{//\ to\ collect\ two\ top\ elements\ in\ return\ stack\ and\ multiply\ them}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer-\/2]\ =\ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer-\/2]\ *\ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer-\/1];}
\DoxyCodeLine{00203\ \ \ \ \ \ \ return\_pointer-\/-\/;\ \textcolor{comment}{//\ remove\ two\ items,\ add\ one\ item}}
\DoxyCodeLine{00204\ \ \ \ \ \ \ call\_pointer\ -\/-\/;}
\DoxyCodeLine{00205\ \ \ \ \ \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \textcolor{comment}{//cout\ <<\ "{}\ else\ "{}\ <<\ endl;}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(k\_now\ ==\ 1)\{}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ to\ return\ the\ corresponding\ N}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer++]\ =\ call\_stack[call\_pointer-\/1].first;}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ call\_pointer\ -\/-\/;\ \textcolor{comment}{//\ pop\ this\ element}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\_now\ ==\ 2)\{}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ =\ N\_now;}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}}\ =\ N\_now\ -\/\ s;}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_a6d2100c373830cacd232319a9958652d}{helper\_vars::return\_stack}}[return\_pointer++]\ =\ \mbox{\hyperlink{namespacehelper__vars_af190146bcb041e9501bb622fd0a70e1e}{helper\_vars::mul\_1}}\ *\ \mbox{\hyperlink{namespacehelper__vars_a3ef4720a3a8f70853c651c0bba5107b2}{helper\_vars::mul\_2}};}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ call\_pointer\ -\/-\/;\ }
\DoxyCodeLine{00217\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\_now\ >\ 2)\{}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ m\ =\ k\_now\ /\ 2;}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ status\_stack[call\_pointer-\/1]\ =\ 1;\ \textcolor{comment}{//\ when\ return\ to\ this\ state,\ we\ know\ that\ we\ should\ aggregate\ }}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ call\_stack[call\_pointer]\ =\ pair<int,\ int>(N\_now,\ m);}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ status\_stack[call\_pointer]\ =\ 0;\ \textcolor{comment}{//\ just\ added}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ call\_stack[call\_pointer+1]\ =\ pair<int,\ int>(N\_now\ -\/\ m*s,\ k\_now\ -\/\ m\ );}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ status\_stack[call\_pointer+1]\ \ =\ 0;}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ call\_pointer\ +=\ 2;\ }
\DoxyCodeLine{00226\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00227\ \ \ \ \ \}}
\DoxyCodeLine{00228\ \ \ \}}
\DoxyCodeLine{00229\ \ \ \textcolor{comment}{//\ make\ sure\ there\ is\ exactly\ one\ element\ in\ return\ stack}}
\DoxyCodeLine{00230\ \ \ \textcolor{keywordflow}{if}\ (return\_pointer\ !=\ 1)\{}
\DoxyCodeLine{00231\ \ \ \ \ cerr\ <<\ \textcolor{stringliteral}{"{}\ return\ pointer\ is\ not\ zero"{}};}
\DoxyCodeLine{00232\ \ \ \}}
\DoxyCodeLine{00233\ \ \ \textcolor{comment}{//return\ helper\_vars::return\_stack[0];\ //\ the\ top\ element\ remaining\ in\ the\ return\ stack\ }}
\DoxyCodeLine{00234\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_a86d8a20e022dc06b23df3b08ac10b7d1}\label{compression__helper_8h_a86d8a20e022dc06b23df3b08ac10b7d1} 
\index{compression\_helper.h@{compression\_helper.h}!prod\_factorial@{prod\_factorial}}
\index{prod\_factorial@{prod\_factorial}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{prod\_factorial()}{prod\_factorial()}}
{\footnotesize\ttfamily mpz\+\_\+class prod\+\_\+factorial (\begin{DoxyParamCaption}\item[{const vector$<$ int $>$ \&}]{a,  }\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})}


\begin{DoxyCode}{0}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00339\ \ \ \textcolor{keywordflow}{if}\ (i==j)\{}
\DoxyCodeLine{00340\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{compression__helper_8cpp_ae2afb43aabe50f7d42aae8f82b5a35f4}{compute\_product}}(a[i],\ a[i],\ 1);}
\DoxyCodeLine{00341\ \ \ \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00342\ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_ae0c8e9c39baed3d84b0f24cb7ef4c3e9}{helper\_vars::mpz\_vec2}}.resize(j-\/i+1);}
\DoxyCodeLine{00343\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ k\ =\ i;\ k<=j;k++)}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \mbox{\hyperlink{namespacehelper__vars_ae0c8e9c39baed3d84b0f24cb7ef4c3e9}{helper\_vars::mpz\_vec2}}[k-\/\ i]\ =\ \mbox{\hyperlink{compression__helper_8cpp_ae2afb43aabe50f7d42aae8f82b5a35f4}{compute\_product}}(a[k],\ a[k],1);}
\DoxyCodeLine{00345\ \ \ \ \ \mbox{\hyperlink{compression__helper_8cpp_a9e9d7382f44b60395f11cdde9c52f4db}{compute\_array\_product}}(\mbox{\hyperlink{namespacehelper__vars_ae0c8e9c39baed3d84b0f24cb7ef4c3e9}{helper\_vars::mpz\_vec2}});}
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{namespacehelper__vars_ae0c8e9c39baed3d84b0f24cb7ef4c3e9}{helper\_vars::mpz\_vec2}}[0];}
\DoxyCodeLine{00347\ \ \ \}}
\DoxyCodeLine{00348\ \}}

\end{DoxyCode}
\Hypertarget{compression__helper_8h_a840241744b179325ee9cea41a1124cdc}\label{compression__helper_8h_a840241744b179325ee9cea41a1124cdc} 
\index{compression\_helper.h@{compression\_helper.h}!prod\_factorial\_old@{prod\_factorial\_old}}
\index{prod\_factorial\_old@{prod\_factorial\_old}!compression\_helper.h@{compression\_helper.h}}
\doxysubsubsection{\texorpdfstring{prod\_factorial\_old()}{prod\_factorial\_old()}}
{\footnotesize\ttfamily mpz\+\_\+class prod\+\_\+factorial\+\_\+old (\begin{DoxyParamCaption}\item[{const vector$<$ int $>$ \&}]{a,  }\item[{int}]{i,  }\item[{int}]{j }\end{DoxyParamCaption})}



computes the product of factorials in a vector given a range 


\begin{DoxyParams}{Parameters}
{\em a} & vector of integers \\
\hline
{\em i,j} & endpoints of the interval \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
$\prod_{v = i}^j a_v ! $ 
\end{DoxyReturn}

\begin{DoxyCode}{0}
\DoxyCodeLine{00327\ \{}
\DoxyCodeLine{00328\ \ \ \textcolor{keywordflow}{if}\ (i\ ==\ j)\{}
\DoxyCodeLine{00329\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{compression__helper_8cpp_ae2afb43aabe50f7d42aae8f82b5a35f4}{compute\_product}}(a[i],\ a[i],\ 1);}
\DoxyCodeLine{00330\ \ \ \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00331\ \ \ \ \ \textcolor{keywordtype}{int}\ k\ =\ (i+j)/2;}
\DoxyCodeLine{00332\ \ \ \ \ mpz\_class\ x\ =\ \mbox{\hyperlink{compression__helper_8cpp_a86d8a20e022dc06b23df3b08ac10b7d1}{prod\_factorial}}(a,\ i,\ k);}
\DoxyCodeLine{00333\ \ \ \ \ mpz\_class\ y\ =\ \mbox{\hyperlink{compression__helper_8cpp_a86d8a20e022dc06b23df3b08ac10b7d1}{prod\_factorial}}(a,\ k+1,\ j);}
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordflow}{return}\ x\ *\ y;}
\DoxyCodeLine{00335\ \ \ \}}
\DoxyCodeLine{00336\ \}}

\end{DoxyCode}
