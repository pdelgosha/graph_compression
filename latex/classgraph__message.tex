\hypertarget{classgraph__message}{}\section{graph\+\_\+message Class Reference}
\label{classgraph__message}\index{graph\+\_\+message@{graph\+\_\+message}}


this class takes care of message passing on marked graphs.  




{\ttfamily \#include $<$graph\+\_\+message.\+h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classgraph__message_a792e738b94a19f914e5495c416defe4d}{graph\+\_\+message} (const \hyperlink{classmarked__graph}{marked\+\_\+graph} \&\hyperlink{classgraph}{graph}, int depth, int max\+\_\+degree)
\begin{DoxyCompactList}\small\item\em constructor, given reference to a graph \end{DoxyCompactList}\item 
\hyperlink{classgraph__message_aa21140453eb0e1de98a2ddfcf2832aeb}{graph\+\_\+message} ()
\begin{DoxyCompactList}\small\item\em default constructor \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
vector$<$ vector$<$ vector$<$ int $>$ $>$ $>$ \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}
\begin{DoxyCompactList}\small\item\em messages\mbox{[}v\mbox{]}\mbox{[}i\mbox{]}\mbox{[}t\mbox{]} is the integer version of the message at time t from vertex v towards its ith neighbor (in the order given by adj\+\_\+list of vertex i in graph G). Messages will be useful to find edge types \end{DoxyCompactList}\item 
vector$<$ unordered\+\_\+map$<$ vector$<$ int $>$, int, \hyperlink{structvint__hash}{vint\+\_\+hash} $>$ $>$ \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\+\_\+dict}
\begin{DoxyCompactList}\small\item\em message\+\_\+dict\mbox{[}t\mbox{]} for $0 \leq t \leq h-1$ is the message dictionary at depth t, which maps each message to its corresponding index in the dictionary \end{DoxyCompactList}\item 
vector$<$ vector$<$ vector$<$ int $>$ $>$ $>$ \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\+\_\+list}
\begin{DoxyCompactList}\small\item\em message\+\_\+list\mbox{[}t\mbox{]} is the list of messages present in the graph at depth t, stored in an order consistent with message\+\_\+dict\mbox{[}t\mbox{]}, i.\+e. for a message m, if messsage\+\_\+dict\mbox{[}t\mbox{]}\mbox{[}m\mbox{]} = i, then message\+\_\+list\mbox{[}t\mbox{]}\mbox{[}i\mbox{]} = m. This is constructed in such a way that message\+\_\+list\mbox{[}t\mbox{]}\mbox{[}message\+\_\+dict\mbox{[}t\mbox{]}\mbox{[}x\mbox{]}\mbox{]} = x. message\+\_\+list\mbox{[}h-\/1\mbox{]} is sorted in reverse order so that all $\ast$ messages (those messages starting with -\/1) go to the end of the list. Star type messages (which roughly speaking corresponds to places where there is a vertex in the h neighborhood has degree more than delta) are vectors of size 2, first coordinate being -\/1, and the second being the edge mark component (towards the \textquotesingle{}me\textquotesingle{} vertex). \end{DoxyCompactList}\item 
vector$<$ int $>$ \hyperlink{classgraph__message_a49d9af5150daf0599c29fe18cb032fa5}{message\+\_\+mark}
\begin{DoxyCompactList}\small\item\em for an integer message such as m at depth h-\/1, message\+\_\+mark\mbox{[}m\mbox{]} denotes the mark component of the message that corresponds to m. The message corresponds to m is basically message\+\_\+list\mbox{[}h-\/1\mbox{]}\mbox{[}m\mbox{]} which is of type vector$<$int$>$ and the last component in this array is the mark component. \end{DoxyCompactList}\item 
vector$<$ bool $>$ \hyperlink{classgraph__message_a55ff5531a0043106369e84a7bc45e22d}{is\+\_\+star\+\_\+message}
\begin{DoxyCompactList}\small\item\em for a message m (integer type) at depth h-\/1, is\+\_\+star\+\_\+message\mbox{[}m\mbox{]} is true if the corresponding message starts with -\/1, ans is false otherwise. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classgraph__message_a40dadc59d582b290202e79bc4a9e896c}{update\+\_\+messages} (const \hyperlink{classmarked__graph}{marked\+\_\+graph} \&)
\begin{DoxyCompactList}\small\item\em performs the message passing algorithm and updates the messages array accordingly \end{DoxyCompactList}\item 
void \hyperlink{classgraph__message_a77d137b371134e292283fdd78634f4d4}{update\+\_\+message\+\_\+dictionary} (const \hyperlink{classmarked__graph}{marked\+\_\+graph} \&)
\begin{DoxyCompactList}\small\item\em update message\+\_\+dict and message\+\_\+list \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{classgraph__message_a934d63ed7275c211e13c6fb68824ed46}{h}
\begin{DoxyCompactList}\small\item\em the depth up to which we do message passing (the type of edges go through depth h-\/1) \end{DoxyCompactList}\item 
int \hyperlink{classgraph__message_a45dfd061b7bc73572e5132fbf66efd55}{Delta}
\begin{DoxyCompactList}\small\item\em the maximum degree threshold \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
this class takes care of message passing on marked graphs. 

This graph has a reference to a \hyperlink{classmarked__graph}{marked\+\_\+graph} object for which we perform message passing to find edge types. The edge types are discovered up to depth h-\/1, and with degree parameter Delta, where h and Delta are member objects. Star type messages (which roughly speaking corresponds to places where there is a vertex in the h neighborhood has degree more than delta) are vectors of size 2, first coordinate being -\/1, and the second being the edge mark component (towards the \textquotesingle{}me\textquotesingle{} vertex).

{\itshape Sample Usage}


\begin{DoxyCode}
\hyperlink{classmarked__graph}{marked\_graph} G;
... \textcolor{comment}{//define G}
\textcolor{keywordtype}{int} h = 10;
\textcolor{keywordtype}{int} Delta = 5; 
\hyperlink{classgraph__message}{graph\_message} M(G, h, Delta);
\end{DoxyCode}
 

\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classgraph__message_a792e738b94a19f914e5495c416defe4d}\label{classgraph__message_a792e738b94a19f914e5495c416defe4d}} 
\index{graph\+\_\+message@{graph\+\_\+message}!graph\+\_\+message@{graph\+\_\+message}}
\index{graph\+\_\+message@{graph\+\_\+message}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{graph\+\_\+message()}{graph\_message()}\hspace{0.1cm}{\footnotesize\ttfamily [1/2]}}
{\footnotesize\ttfamily graph\+\_\+message\+::graph\+\_\+message (\begin{DoxyParamCaption}\item[{const \hyperlink{classmarked__graph}{marked\+\_\+graph} \&}]{graph,  }\item[{int}]{depth,  }\item[{int}]{max\+\_\+degree }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



constructor, given reference to a graph 


\begin{DoxyCode}
57                                                                      \{
58     \hyperlink{classgraph__message_a934d63ed7275c211e13c6fb68824ed46}{h} = depth;
59     \hyperlink{classgraph__message_a45dfd061b7bc73572e5132fbf66efd55}{Delta} = max\_degree;
60     \hyperlink{classgraph__message_a40dadc59d582b290202e79bc4a9e896c}{update\_messages}(graph); \textcolor{comment}{// do message passing}
61   \}
\end{DoxyCode}
\mbox{\Hypertarget{classgraph__message_aa21140453eb0e1de98a2ddfcf2832aeb}\label{classgraph__message_aa21140453eb0e1de98a2ddfcf2832aeb}} 
\index{graph\+\_\+message@{graph\+\_\+message}!graph\+\_\+message@{graph\+\_\+message}}
\index{graph\+\_\+message@{graph\+\_\+message}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{graph\+\_\+message()}{graph\_message()}\hspace{0.1cm}{\footnotesize\ttfamily [2/2]}}
{\footnotesize\ttfamily graph\+\_\+message\+::graph\+\_\+message (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}



default constructor 


\begin{DoxyCode}
64 \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classgraph__message_a77d137b371134e292283fdd78634f4d4}\label{classgraph__message_a77d137b371134e292283fdd78634f4d4}} 
\index{graph\+\_\+message@{graph\+\_\+message}!update\+\_\+message\+\_\+dictionary@{update\+\_\+message\+\_\+dictionary}}
\index{update\+\_\+message\+\_\+dictionary@{update\+\_\+message\+\_\+dictionary}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{update\+\_\+message\+\_\+dictionary()}{update\_message\_dictionary()}}
{\footnotesize\ttfamily void graph\+\_\+message\+::update\+\_\+message\+\_\+dictionary (\begin{DoxyParamCaption}\item[{const \hyperlink{classmarked__graph}{marked\+\_\+graph} \&}]{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



update message\+\_\+dict and message\+\_\+list 

\mbox{\Hypertarget{classgraph__message_a40dadc59d582b290202e79bc4a9e896c}\label{classgraph__message_a40dadc59d582b290202e79bc4a9e896c}} 
\index{graph\+\_\+message@{graph\+\_\+message}!update\+\_\+messages@{update\+\_\+messages}}
\index{update\+\_\+messages@{update\+\_\+messages}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{update\+\_\+messages()}{update\_messages()}}
{\footnotesize\ttfamily void graph\+\_\+message\+::update\+\_\+messages (\begin{DoxyParamCaption}\item[{const \hyperlink{classmarked__graph}{marked\+\_\+graph} \&}]{G }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [private]}}



performs the message passing algorithm and updates the messages array accordingly 

The structure of messages is as follows. To simplify the notation, we use $M_k(v,w)$ to denote the message sent from $v$ towards $w$ at time step $k$, this is in fact messages\mbox{[}v\mbox{]}\mbox{[}i\mbox{]}\mbox{[}t\mbox{]} where i is the index of $w$ among neighbors of $v$.


\begin{DoxyItemize}
\item For $k = 0$, we have $M_0(v,w) = (\tau_G(v), 0,\xi_G(w,v))$ where $\tau_G(v)$ is the mark of vertex $v$ and $\xi_G(w,v)$ denotes the mark of the edge between $v$ and $w$ towards $v$.
\item For $k > 0$, if the degree of $v$ is bigger than Delta, we have $M_k(v,w) = (-1,\xi_G(w,v))$.
\item Otherwise, we form the list $(s_u: u \sim_G v, u \neq w)$, where for $u \sim_G v, u \neq w$, we set $s_u = (M_{k-1}(u,v), \xi_G(u,v))$.
\item If for some $u \sim_G v, u \neq w$, the sequence $s_u$ starts with a -\/1, we set $M_k(v,w) = (-1,\xi_G(w,v))$.
\item Otherwise, we sort the sequences $s_u$ nondecreasingly with respect to the lexicographic order and set $s$ to be the concatenation of the sorted list. Finally, we set $M_k(v,w) = (\tau_G(v), \deg_G(v) -1, s, \xi_G(w,v))$. 
\end{DoxyItemize}
\begin{DoxyCode}
24 \{
25   \hyperlink{classlogger_a9d29b49bd318a719a8e85b59eac54fe0}{logger::current\_depth}++;
26   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"graph\_message::update\_message init"}, \textcolor{stringliteral}{""});
27   \textcolor{keywordtype}{int} nu\_vertices = G.\hyperlink{classmarked__graph_acf79c6aeb8f32614cb14a5baaa6c9f9b}{nu\_vertices};
28 
29   \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}.resize(nu\_vertices);
30   \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}.resize(\hyperlink{classgraph__message_a934d63ed7275c211e13c6fb68824ed46}{h});
31   \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}.resize(\hyperlink{classgraph__message_a934d63ed7275c211e13c6fb68824ed46}{h});
32 
33   \textcolor{comment}{// initialize the messages}
34 
35   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"resizing messages"}, \textcolor{stringliteral}{""});
36   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} v=0;v<nu\_vertices;v++)\{
37     \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v].resize(G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size());
38     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size();i++)\{
39       \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v][i].resize(\hyperlink{classgraph__message_a934d63ed7275c211e13c6fb68824ed46}{h});
40     \}
41   \}
42 
43   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"initializing messages"},\textcolor{stringliteral}{""});
44   vector<int> m(3);
45   unordered\_map<vector<int>, int, \hyperlink{structvint__hash}{vint\_hash}>::iterator it;
46   \textcolor{comment}{//map<vector<int>, int>::iterator it;}
47 
48   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} v=0;v<nu\_vertices;v++)\{
49 
50     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size();i++)\{
51       \textcolor{comment}{// the message from v towards the ith neighbor (lets call is w) at time 0 has a mark component which
       is \(\backslash\)xi(v,w) and a subtree component which is a single root with mark \(\backslash\)tau(v). This is encoded as a message
       vector with size 3 of the form (\(\backslash\)tau(v), 0,\(\backslash\)xi(v,w)) where the last 0 indicates that there is no offspring.}
52 
53 
54       \textcolor{comment}{//vector<int> m;}
55       \textcolor{comment}{//m.clear();}
56       \textcolor{comment}{//m.push\_back(G.ver\_mark[v]);}
57       \textcolor{comment}{//m.push\_back(0);}
58       \textcolor{comment}{//m.push\_back(G.adj\_list[v][i].second.first);}
59 
60       m[0] = G.\hyperlink{classmarked__graph_ac83e9377dd4d8bb95be1ac949b127296}{ver\_mark}[v];
61       m[1] = 0;
62       m[2] = G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v][i].second.first;
63 
64       \textcolor{comment}{// adding this message to the message dictionary}
65       it = \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[0].find(m); 
66       \textcolor{keywordflow}{if} (it == \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[0].end())\{
67         \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[0][m] = \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[0].size();
68         \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v][i][0] = \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[0].size();
69         \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[0].push\_back(m);
70       \}\textcolor{keywordflow}{else}\{
71         \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v][i][0] = it->second;
72       \}
73 
74       \textcolor{comment}{//messages[v][i][0] = message\_dict[0][m]; // the message at time 0}
75     \}
76   \}
77 
78   \textcolor{comment}{// updating messages}
79   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"updating messages"}, \textcolor{stringliteral}{""});
80   m.reserve(5+ 2 * \hyperlink{classgraph__message_a45dfd061b7bc73572e5132fbf66efd55}{Delta});
81 
82   duration<float> diff;
83   high\_resolution\_clock::time\_point t1, t2; 
84   \textcolor{keywordtype}{float} agg\_search = 0;
85   \textcolor{keywordtype}{float} agg\_insert = 0;
86   \textcolor{keywordtype}{float} agg\_m = 0;
87   \textcolor{keywordtype}{float} agg\_sort = 0;
88 
89   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} t=1;t<\hyperlink{classgraph__message_a934d63ed7275c211e13c6fb68824ed46}{h};t++)\{
90     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} v=0;v<nu\_vertices;v++)\{
91       \textcolor{comment}{//cerr << " vertex " << v << endl;}
92       \textcolor{keywordflow}{if} (G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size() <= \hyperlink{classgraph__message_a45dfd061b7bc73572e5132fbf66efd55}{Delta})\{
93         \textcolor{comment}{// the degree of v is no more than Delta}
94         \textcolor{comment}{// do the standard message passing by aggregating messages from neighbors}
95         \textcolor{comment}{// stacking all the messages from neighbors of v towards v}
96         vector<pair<pair<int, int>, \textcolor{keywordtype}{int}> > neighbor\_messages; \textcolor{comment}{// the first component is the message and the
       second is the name of the neighbor}
97         \textcolor{comment}{// the second component is stored so that after sorting, we know the owner of the message}
98 
99         \textcolor{comment}{// the message from each neighbor of v, say w,  towards v is considered, the mark of the edge
       between w and v towards v is added to it, and then all these objects are stacked in neighbor\_messages to be
       sorted and used afterwards }
100         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size();i++)\{
101           \textcolor{keywordtype}{int} w = G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v][i].first; \textcolor{comment}{// what is the name of the neighbor I am looking at now,
       which is the ith neighbor of vertex v }
102           \textcolor{keywordtype}{int} my\_location = G.\hyperlink{classmarked__graph_a3ae722ea9583ad23af34d789a88ac01a}{adj\_location}[w].at(v); \textcolor{comment}{// where is the place of node v among the
       list of neighbors of the ith neighbor of v}
103           \textcolor{keywordtype}{int} previous\_message = \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[w][my\_location][t-1]; \textcolor{comment}{// the message sent from this
       neighbor towards v at time t-1}
104           \textcolor{keywordtype}{int} mark\_to\_v = G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v][i].second.first;
105           neighbor\_messages.push\_back(pair<pair<int, int> , \textcolor{keywordtype}{int}> (pair<int,int>(previous\_message, mark\_to\_v
      ), w));
106         \}
107 
108         t1 = high\_resolution\_clock::now();
109         sort(neighbor\_messages.begin(), neighbor\_messages.end()); \textcolor{comment}{// sorts lexicographically}
110         t2 = high\_resolution\_clock::now();
111         diff = t2 - t1;
112         agg\_sort += diff.count();
113 
114         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size();i++)\{
115           \textcolor{comment}{// let w be the current ith neighbor of v}
116           \textcolor{keywordtype}{int} w = G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v][i].first;
117           \textcolor{comment}{// first, start with the mark of v and the number of offsprings in the subgraph component of the
       message}
118           \textcolor{comment}{//vector<int> m; // the message that v is going to send to w}
119           t1 = high\_resolution\_clock::now();
120           m.clear();
121           m.push\_back(G.\hyperlink{classmarked__graph_ac83e9377dd4d8bb95be1ac949b127296}{ver\_mark}[v]); \textcolor{comment}{// mark of v}
122           m.push\_back(G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size()-1); \textcolor{comment}{// the number of offsprings in the subgraph
       component of the message}
123           t2 = high\_resolution\_clock::now();
124           diff = t2 - t1;
125           agg\_m += diff.count();
126 
127           \textcolor{comment}{// stacking messages from all neighbors of v expect for w towards v at time t-1}
128           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size();j++)\{
129             \textcolor{keywordflow}{if} (neighbor\_messages[j].second != w)\{
130               \textcolor{keywordflow}{if} (\hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[t-1][neighbor\_messages[j].first.first][0] == -1)\{
131                 \textcolor{comment}{// this means that one of the messages that should be aggregated is * typed, therefore the
       outgoing messages should also be * typed}
132                 \textcolor{comment}{// i.e. the message has only two entries: (-1, \(\backslash\)xi(w,v)) where \(\backslash\)xi(w,v) is the mark of the
       edge between v and w towards v}
133                 \textcolor{comment}{// since after this loop, the mark \(\backslash\)xi(w,v) is added to the message (after the comment
       starting with 'finally'), we only add the initial -1 part}
134                 t1 = high\_resolution\_clock::now();
135                 m.resize(0);
136                 m.push\_back(-1);
137                 t2 = high\_resolution\_clock::now();
138                 diff = t2 - t1;
139                 agg\_m += diff.count();
140                 \textcolor{keywordflow}{break}; \textcolor{comment}{// the message is decided, we do not need to go over any of the other neighbor
       messages, hence break}
141               \}
142               \textcolor{comment}{// this message should be added to the list of messages}
143               t1 = high\_resolution\_clock::now();
144               m.push\_back(neighbor\_messages[j].first.first); \textcolor{comment}{// message part}
145               m.push\_back(neighbor\_messages[j].first.second); \textcolor{comment}{// mark part towards v}
146               t2 = high\_resolution\_clock::now();
147               diff = t2 - t1;
148               agg\_m += diff.count();
149 
150             \}
151           \}
152           \textcolor{comment}{// if we break, we reach at this point and message is (-1), otherwise the message is of the form
       (\(\backslash\)tau(v), \(\backslash\)deg(v) - 1, ...) where ... is the list of all neighbor messages towards v except for w. }
153           \textcolor{comment}{// finally, the mark of the edge between v and w towards v, \(\backslash\)xi(w,v), should be added to this
       list}
154           t1 = high\_resolution\_clock::now();
155           m.push\_back(G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v][i].second.first);
156           t2 = high\_resolution\_clock::now();
157           diff = t2 - t1;
158           agg\_m += diff.count();
159 
160           \textcolor{comment}{// set the current message}
161           t1 = high\_resolution\_clock::now();
162           it = \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[t].find(m);
163           t2 = high\_resolution\_clock::now();
164           diff = t2 - t1;
165           agg\_search += diff.count();
166 
167           \textcolor{keywordflow}{if} (it == \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[t].end())\{
168             t1 = high\_resolution\_clock::now();
169             \textcolor{comment}{//message\_dict[t][m] = message\_list[t].size();}
170             \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[t].insert(pair<vector<int>, \textcolor{keywordtype}{int}> (m, 
      \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[t].size()));
171             t2 = high\_resolution\_clock::now();
172             diff = t2 - t1;
173             agg\_insert += diff.count();
174 
175             \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v][i][t] = \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[t].size();
176             \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[t].push\_back(m);
177           \}\textcolor{keywordflow}{else}\{
178             \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v][i][t] = it->second;
179           \}
180         \}
181       \}\textcolor{keywordflow}{else}\{
182         \textcolor{comment}{// if the degree of v is bigger than Delta, the message towards all neighbors is of the form *}
183         \textcolor{comment}{// i.e. message of v towards a neighbor w is of the form (-1, \(\backslash\)xi(w,v)) where \(\backslash\)xi(w,v) is the mark
       of the edge between v and w towards v}
184         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size();i++)\{
185           \textcolor{comment}{//vector<int> m; // the current message from v to ith neighbor}
186           t1 = high\_resolution\_clock::now();
187           m.clear();
188           m.resize(2);
189           m[0] = -1;
190           m[1] = G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v][i].second.first;
191           t2 = high\_resolution\_clock::now();
192           diff = t2 - t1;
193           agg\_m += diff.count();
194 
195           \textcolor{comment}{// set the current message}
196           t1 = high\_resolution\_clock::now();
197           it = \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[t].find(m);
198           t2 = high\_resolution\_clock::now();
199           diff = t2 - t1;
200           agg\_search += diff.count();
201 
202           \textcolor{keywordflow}{if} (it == \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[t].end())\{
203             t1 = high\_resolution\_clock::now();
204             \textcolor{comment}{//message\_dict[t][m] = message\_list[t].size();}
205             \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[t].insert(pair<vector<int>, \textcolor{keywordtype}{int}> (m, 
      \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[t].size()));
206             t2 = high\_resolution\_clock::now();
207             diff = t2 - t1;
208             agg\_insert += diff.count();
209             \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v][i][t] = \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[t].size();
210             \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[t].push\_back(m);
211           \}\textcolor{keywordflow}{else}\{
212             \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v][i][t] = it->second;
213           \}
214         \}
215       \}
216     \}
217   \}
218   cerr << \textcolor{stringliteral}{" total time to search in hash table: "} << agg\_search << endl;
219   cerr << \textcolor{stringliteral}{" total time to insert in hash table: "} << agg\_insert << endl;
220   cerr << \textcolor{stringliteral}{" total time to modify vector m  "} << agg\_m << endl;
221   cerr << \textcolor{stringliteral}{" total time to sort  "} << agg\_sort << endl;
222 
223   \textcolor{comment}{// now, we should update messages at time h-1 so that if the message from v to w is *, i.e. is of the
       form (-1,x), then the message from w to v is also of the similar form, i.e. it is (-1,x') where x' = \(\backslash\)xi(v,w)}
224   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"* symmetrizing"}, \textcolor{stringliteral}{""});
225   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} v=0;v<nu\_vertices;v++)\{
226     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v].size();i++)\{
227       \textcolor{keywordflow}{if} (\hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[h-1][\hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[v][i][h-1]][0] == -1)\{
228         \textcolor{comment}{// it is of the form *}
229         \textcolor{keywordtype}{int} w = G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v][i].first; \textcolor{comment}{// the other endpoint of the edge}
230         \textcolor{keywordtype}{int} my\_location = G.\hyperlink{classmarked__graph_a3ae722ea9583ad23af34d789a88ac01a}{adj\_location}[w].at(v); \textcolor{comment}{// so that adj\_list[w][my\_location].first =
       v}
231         \textcolor{comment}{//vector<int> m;}
232         m.clear();
233         m.resize(2);
234         m[0] = -1;
235         m[1] = G.\hyperlink{classmarked__graph_a1a0bf7ca413a278763f7c878b3b6fd6f}{adj\_list}[v][i].second.second; \textcolor{comment}{// the mark towards w}
236         \textcolor{keywordflow}{if} (\hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[h-1].find(m) == \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[h-1].end())\{
237           \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[h-1][m] = \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[h-1].size();
238           \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[h-1].push\_back(m);
239         \}
240         \hyperlink{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}{messages}[w][my\_location][h-1] = \hyperlink{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}{message\_dict}[h-1][m];
241       \}
242     \}
243   \}
244 
245   \textcolor{comment}{// setting message\_mark and is\_star\_message}
246   \hyperlink{classlogger_a710163deb17bc81f70d53d285b8ac9ac}{logger::add\_entry}(\textcolor{stringliteral}{"setting message\_mark and is\_star\_message"}, \textcolor{stringliteral}{""});
247   \hyperlink{classgraph__message_a49d9af5150daf0599c29fe18cb032fa5}{message\_mark}.resize(\hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[h-1].size());
248   \hyperlink{classgraph__message_a55ff5531a0043106369e84a7bc45e22d}{is\_star\_message}.resize(\hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[h-1].size());
249   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<\hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[h-1].size();i++)\{
250     \hyperlink{classgraph__message_a49d9af5150daf0599c29fe18cb032fa5}{message\_mark}[i] = \hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[h-1][i].back(); \textcolor{comment}{// the last element is the mark
       component}
251     \hyperlink{classgraph__message_a55ff5531a0043106369e84a7bc45e22d}{is\_star\_message}[i] = (\hyperlink{classgraph__message_aa17fdb629b423343edfafa97252763ef}{message\_list}[h-1][i][0] == -1); \textcolor{comment}{// message is star
       type when the first element is -1}
252   \}
253   \hyperlink{classlogger_a9d29b49bd318a719a8e85b59eac54fe0}{logger::current\_depth}--;
254 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classgraph__message_a45dfd061b7bc73572e5132fbf66efd55}\label{classgraph__message_a45dfd061b7bc73572e5132fbf66efd55}} 
\index{graph\+\_\+message@{graph\+\_\+message}!Delta@{Delta}}
\index{Delta@{Delta}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{Delta}{Delta}}
{\footnotesize\ttfamily int graph\+\_\+message\+::\+Delta\hspace{0.3cm}{\ttfamily [private]}}



the maximum degree threshold 

\mbox{\Hypertarget{classgraph__message_a934d63ed7275c211e13c6fb68824ed46}\label{classgraph__message_a934d63ed7275c211e13c6fb68824ed46}} 
\index{graph\+\_\+message@{graph\+\_\+message}!h@{h}}
\index{h@{h}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{h}{h}}
{\footnotesize\ttfamily int graph\+\_\+message\+::h\hspace{0.3cm}{\ttfamily [private]}}



the depth up to which we do message passing (the type of edges go through depth h-\/1) 

\mbox{\Hypertarget{classgraph__message_a55ff5531a0043106369e84a7bc45e22d}\label{classgraph__message_a55ff5531a0043106369e84a7bc45e22d}} 
\index{graph\+\_\+message@{graph\+\_\+message}!is\+\_\+star\+\_\+message@{is\+\_\+star\+\_\+message}}
\index{is\+\_\+star\+\_\+message@{is\+\_\+star\+\_\+message}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{is\+\_\+star\+\_\+message}{is\_star\_message}}
{\footnotesize\ttfamily vector$<$bool$>$ graph\+\_\+message\+::is\+\_\+star\+\_\+message}



for a message m (integer type) at depth h-\/1, is\+\_\+star\+\_\+message\mbox{[}m\mbox{]} is true if the corresponding message starts with -\/1, ans is false otherwise. 

\mbox{\Hypertarget{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}\label{classgraph__message_ab54d89b122c2b1322da0d5db2043fb84}} 
\index{graph\+\_\+message@{graph\+\_\+message}!message\+\_\+dict@{message\+\_\+dict}}
\index{message\+\_\+dict@{message\+\_\+dict}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{message\+\_\+dict}{message\_dict}}
{\footnotesize\ttfamily vector$<$unordered\+\_\+map$<$vector$<$int$>$, int, \hyperlink{structvint__hash}{vint\+\_\+hash}$>$ $>$ graph\+\_\+message\+::message\+\_\+dict}



message\+\_\+dict\mbox{[}t\mbox{]} for $0 \leq t \leq h-1$ is the message dictionary at depth t, which maps each message to its corresponding index in the dictionary 

\mbox{\Hypertarget{classgraph__message_aa17fdb629b423343edfafa97252763ef}\label{classgraph__message_aa17fdb629b423343edfafa97252763ef}} 
\index{graph\+\_\+message@{graph\+\_\+message}!message\+\_\+list@{message\+\_\+list}}
\index{message\+\_\+list@{message\+\_\+list}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{message\+\_\+list}{message\_list}}
{\footnotesize\ttfamily vector$<$vector$<$vector$<$int$>$ $>$ $>$ graph\+\_\+message\+::message\+\_\+list}



message\+\_\+list\mbox{[}t\mbox{]} is the list of messages present in the graph at depth t, stored in an order consistent with message\+\_\+dict\mbox{[}t\mbox{]}, i.\+e. for a message m, if messsage\+\_\+dict\mbox{[}t\mbox{]}\mbox{[}m\mbox{]} = i, then message\+\_\+list\mbox{[}t\mbox{]}\mbox{[}i\mbox{]} = m. This is constructed in such a way that message\+\_\+list\mbox{[}t\mbox{]}\mbox{[}message\+\_\+dict\mbox{[}t\mbox{]}\mbox{[}x\mbox{]}\mbox{]} = x. message\+\_\+list\mbox{[}h-\/1\mbox{]} is sorted in reverse order so that all $\ast$ messages (those messages starting with -\/1) go to the end of the list. Star type messages (which roughly speaking corresponds to places where there is a vertex in the h neighborhood has degree more than delta) are vectors of size 2, first coordinate being -\/1, and the second being the edge mark component (towards the \textquotesingle{}me\textquotesingle{} vertex). 

\mbox{\Hypertarget{classgraph__message_a49d9af5150daf0599c29fe18cb032fa5}\label{classgraph__message_a49d9af5150daf0599c29fe18cb032fa5}} 
\index{graph\+\_\+message@{graph\+\_\+message}!message\+\_\+mark@{message\+\_\+mark}}
\index{message\+\_\+mark@{message\+\_\+mark}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{message\+\_\+mark}{message\_mark}}
{\footnotesize\ttfamily vector$<$int$>$ graph\+\_\+message\+::message\+\_\+mark}



for an integer message such as m at depth h-\/1, message\+\_\+mark\mbox{[}m\mbox{]} denotes the mark component of the message that corresponds to m. The message corresponds to m is basically message\+\_\+list\mbox{[}h-\/1\mbox{]}\mbox{[}m\mbox{]} which is of type vector$<$int$>$ and the last component in this array is the mark component. 

\mbox{\Hypertarget{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}\label{classgraph__message_aac77e098f0acf9650116a8e51fe3b4b7}} 
\index{graph\+\_\+message@{graph\+\_\+message}!messages@{messages}}
\index{messages@{messages}!graph\+\_\+message@{graph\+\_\+message}}
\subsubsection{\texorpdfstring{messages}{messages}}
{\footnotesize\ttfamily vector$<$vector$<$vector$<$int $>$ $>$ $>$ graph\+\_\+message\+::messages}



messages\mbox{[}v\mbox{]}\mbox{[}i\mbox{]}\mbox{[}t\mbox{]} is the integer version of the message at time t from vertex v towards its ith neighbor (in the order given by adj\+\_\+list of vertex i in graph G). Messages will be useful to find edge types 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
\hyperlink{graph__message_8h}{graph\+\_\+message.\+h}\item 
\hyperlink{graph__message_8cpp}{graph\+\_\+message.\+cpp}\end{DoxyCompactItemize}
