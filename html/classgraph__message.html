<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Marked Graph Compression: graph_message Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Marked Graph Compression
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="classgraph__message-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">graph_message Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>this class takes care of message passing on marked graphs.  
 <a href="classgraph__message.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="graph__message_8h_source.html">graph_message.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a792e738b94a19f914e5495c416defe4d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#a792e738b94a19f914e5495c416defe4d">graph_message</a> (const <a class="el" href="classmarked__graph.html">marked_graph</a> &amp;<a class="el" href="classgraph.html">graph</a>, int depth, int max_degree)</td></tr>
<tr class="memdesc:a792e738b94a19f914e5495c416defe4d"><td class="mdescLeft">&#160;</td><td class="mdescRight">constructor, given reference to a graph  <a href="#a792e738b94a19f914e5495c416defe4d">More...</a><br /></td></tr>
<tr class="separator:a792e738b94a19f914e5495c416defe4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa21140453eb0e1de98a2ddfcf2832aeb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#aa21140453eb0e1de98a2ddfcf2832aeb">graph_message</a> ()</td></tr>
<tr class="memdesc:aa21140453eb0e1de98a2ddfcf2832aeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">default constructor  <a href="#aa21140453eb0e1de98a2ddfcf2832aeb">More...</a><br /></td></tr>
<tr class="separator:aa21140453eb0e1de98a2ddfcf2832aeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:af680c8a1755cf8d4aba389c1a3d6634e"><td class="memItemLeft" align="right" valign="top">vector&lt; vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">messages</a></td></tr>
<tr class="memdesc:af680c8a1755cf8d4aba389c1a3d6634e"><td class="mdescLeft">&#160;</td><td class="mdescRight">messages[v][i] is the integer version of the message from vertex v towards its ith neighbor (in the order given by adj_list of vertex i in graph G). The message is at any given step that update_messages is running, so after finishing update_message, the messages are at step (depth) h-1.  <a href="#af680c8a1755cf8d4aba389c1a3d6634e">More...</a><br /></td></tr>
<tr class="separator:af680c8a1755cf8d4aba389c1a3d6634e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a557473b726dc5d80618055a6b843670f"><td class="memItemLeft" align="right" valign="top">unordered_map&lt; vector&lt; int &gt;, int, <a class="el" href="structvint__hash.html">vint_hash</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#a557473b726dc5d80618055a6b843670f">message_dict</a></td></tr>
<tr class="memdesc:a557473b726dc5d80618055a6b843670f"><td class="mdescLeft">&#160;</td><td class="mdescRight">message_dict is the message dictionary at any step that update_messages is running, which maps each message to its corresponding index in the dictionary. When update_messages is over, this corresponds to step (depth) h-1  <a href="#a557473b726dc5d80618055a6b843670f">More...</a><br /></td></tr>
<tr class="separator:a557473b726dc5d80618055a6b843670f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49d9af5150daf0599c29fe18cb032fa5"><td class="memItemLeft" align="right" valign="top">vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#a49d9af5150daf0599c29fe18cb032fa5">message_mark</a></td></tr>
<tr class="memdesc:a49d9af5150daf0599c29fe18cb032fa5"><td class="mdescLeft">&#160;</td><td class="mdescRight">for an integer message \(m\), message_mark[m] is the mark component associated to the message m at any step that update_messages is working. This is basically the last index in the vector message associate to m. When update_messages is over, this corresponds to step (depth) h-1.  <a href="#a49d9af5150daf0599c29fe18cb032fa5">More...</a><br /></td></tr>
<tr class="separator:a49d9af5150daf0599c29fe18cb032fa5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ff5531a0043106369e84a7bc45e22d"><td class="memItemLeft" align="right" valign="top">vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#a55ff5531a0043106369e84a7bc45e22d">is_star_message</a></td></tr>
<tr class="memdesc:a55ff5531a0043106369e84a7bc45e22d"><td class="mdescLeft">&#160;</td><td class="mdescRight">for an integer message \(m\), is_star_message[m] is true if m is a star message and false otherwise. Note that m is star type iff the first index in the vector message corresponding to m is -1. This is updated at step of update_messages, so when it is over, it corresponds to step (depth) h-1.  <a href="#a55ff5531a0043106369e84a7bc45e22d">More...</a><br /></td></tr>
<tr class="separator:a55ff5531a0043106369e84a7bc45e22d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a40dadc59d582b290202e79bc4a9e896c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#a40dadc59d582b290202e79bc4a9e896c">update_messages</a> (const <a class="el" href="classmarked__graph.html">marked_graph</a> &amp;)</td></tr>
<tr class="memdesc:a40dadc59d582b290202e79bc4a9e896c"><td class="mdescLeft">&#160;</td><td class="mdescRight">performs the message passing algorithm and updates the messages array accordingly  <a href="#a40dadc59d582b290202e79bc4a9e896c">More...</a><br /></td></tr>
<tr class="separator:a40dadc59d582b290202e79bc4a9e896c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa76d1d5420a12477fa1dddd878d78c8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a> (const vector&lt; int &gt; &amp;m, int v, int i)</td></tr>
<tr class="memdesc:aa76d1d5420a12477fa1dddd878d78c8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">update message_dict and message_list  <a href="#aa76d1d5420a12477fa1dddd878d78c8f">More...</a><br /></td></tr>
<tr class="separator:aa76d1d5420a12477fa1dddd878d78c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a934d63ed7275c211e13c6fb68824ed46"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#a934d63ed7275c211e13c6fb68824ed46">h</a></td></tr>
<tr class="memdesc:a934d63ed7275c211e13c6fb68824ed46"><td class="mdescLeft">&#160;</td><td class="mdescRight">the depth up to which we do message passing (the type of edges go through depth h-1)  <a href="#a934d63ed7275c211e13c6fb68824ed46">More...</a><br /></td></tr>
<tr class="separator:a934d63ed7275c211e13c6fb68824ed46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45dfd061b7bc73572e5132fbf66efd55"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a></td></tr>
<tr class="memdesc:a45dfd061b7bc73572e5132fbf66efd55"><td class="mdescLeft">&#160;</td><td class="mdescRight">the maximum degree threshold  <a href="#a45dfd061b7bc73572e5132fbf66efd55">More...</a><br /></td></tr>
<tr class="separator:a45dfd061b7bc73572e5132fbf66efd55"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>this class takes care of message passing on marked graphs. </p>
<p>This graph has a reference to a <a class="el" href="classmarked__graph.html" title="simple marked graph ">marked_graph</a> object for which we perform message passing to find edge types. The edge types are discovered up to depth h-1, and with degree parameter Delta, where h and Delta are member objects. Star type messages (which roughly speaking corresponds to places where there is a vertex in the h neighborhood has degree more than delta) are vectors of size 2, first coordinate being -1, and the second being the edge mark component (towards the 'me' vertex).</p>
<p><em>Sample Usage</em></p>
<div class="fragment"><div class="line"><a class="code" href="classmarked__graph.html">marked_graph</a> G;</div><div class="line">... <span class="comment">//define G</span></div><div class="line"><span class="keywordtype">int</span> <a class="code" href="classgraph__message.html#a934d63ed7275c211e13c6fb68824ed46">h</a> = 10;</div><div class="line"><span class="keywordtype">int</span> <a class="code" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a> = 5; </div><div class="line"><a class="code" href="classgraph__message.html">graph_message</a> M(G, h, Delta);</div></div><!-- fragment --> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a792e738b94a19f914e5495c416defe4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a792e738b94a19f914e5495c416defe4d">&#9670;&nbsp;</a></span>graph_message() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">graph_message::graph_message </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmarked__graph.html">marked_graph</a> &amp;&#160;</td>
          <td class="paramname"><em>graph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max_degree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>constructor, given reference to a graph </p>
<div class="fragment"><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                                                                     {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="classgraph__message.html#a934d63ed7275c211e13c6fb68824ed46">h</a> = depth;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a> = max_degree;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="classgraph__message.html#a40dadc59d582b290202e79bc4a9e896c">update_messages</a>(graph); <span class="comment">// do message passing</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  }</div><div class="ttc" id="classgraph__message_html_a40dadc59d582b290202e79bc4a9e896c"><div class="ttname"><a href="classgraph__message.html#a40dadc59d582b290202e79bc4a9e896c">graph_message::update_messages</a></div><div class="ttdeci">void update_messages(const marked_graph &amp;)</div><div class="ttdoc">performs the message passing algorithm and updates the messages array accordingly ...</div><div class="ttdef"><b>Definition:</b> graph_message.cpp:23</div></div>
<div class="ttc" id="classgraph__message_html_a45dfd061b7bc73572e5132fbf66efd55"><div class="ttname"><a href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">graph_message::Delta</a></div><div class="ttdeci">int Delta</div><div class="ttdoc">the maximum degree threshold </div><div class="ttdef"><b>Definition:</b> graph_message.h:34</div></div>
<div class="ttc" id="classgraph__message_html_a934d63ed7275c211e13c6fb68824ed46"><div class="ttname"><a href="classgraph__message.html#a934d63ed7275c211e13c6fb68824ed46">graph_message::h</a></div><div class="ttdeci">int h</div><div class="ttdoc">the depth up to which we do message passing (the type of edges go through depth h-1) ...</div><div class="ttdef"><b>Definition:</b> graph_message.h:33</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa21140453eb0e1de98a2ddfcf2832aeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa21140453eb0e1de98a2ddfcf2832aeb">&#9670;&nbsp;</a></span>graph_message() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">graph_message::graph_message </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>default constructor </p>
<div class="fragment"><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;{}</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa76d1d5420a12477fa1dddd878d78c8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa76d1d5420a12477fa1dddd878d78c8f">&#9670;&nbsp;</a></span>send_message()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void graph_message::send_message </td>
          <td>(</td>
          <td class="paramtype">const vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>update message_dict and message_list </p>
<p>send the message m from vertex v towards its ith neighbor. Updates message_dict, message_mark and is_message_star</p>
<p>sends a message by setting messages, and puts it in the message hash table message_dict. It also updates message_mark and is_star_message corresponding to step s and the input message.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">m</td><td>the message to be sent </td></tr>
    <tr><td class="paramname">v</td><td>the vertex from which the message is originated </td></tr>
    <tr><td class="paramname">i</td><td>the message is sent to the ith neighbor of v </td></tr>
    <tr><td class="paramname">s</td><td>the step, or depth ( \(0 \lee s &lt; h\)) </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                                                                         {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  unordered_map&lt;vector&lt;int&gt;, int, <a class="code" href="structvint__hash.html">vint_hash</a>&gt;::iterator it;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">//cerr &lt;&lt; &quot; send message (&quot;;</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">//for (int k=0;k&lt;m.size();k++){</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">//  cerr &lt;&lt; m[k];</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">//  if (k&lt;m.size()-1)</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">//    cerr &lt;&lt; &quot;, &quot;;</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">//cerr &lt;&lt; &quot;): &quot; &lt;&lt; v &lt;&lt; &quot; -&gt; &quot; &lt;&lt; i;</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  it = <a class="code" href="classgraph__message.html#a557473b726dc5d80618055a6b843670f">message_dict</a>.find(m);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="keywordflow">if</span> (it == <a class="code" href="classgraph__message.html#a557473b726dc5d80618055a6b843670f">message_dict</a>.end()){</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="comment">// this is a new message</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="classgraph__message.html#a557473b726dc5d80618055a6b843670f">message_dict</a>.insert(pair&lt;vector&lt;int&gt;, <span class="keywordtype">int</span>&gt; (m, <a class="code" href="classgraph__message.html#a49d9af5150daf0599c29fe18cb032fa5">message_mark</a>.size())); <span class="comment">// insert the message into the hash table, message_mark[s].size() is in fact the number of registered marks at step s</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">messages</a>[v][i] = <a class="code" href="classgraph__message.html#a49d9af5150daf0599c29fe18cb032fa5">message_mark</a>.size(); <span class="comment">// set the message</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <a class="code" href="classgraph__message.html#a49d9af5150daf0599c29fe18cb032fa5">message_mark</a>.push_back(m.back()); <span class="comment">// register m by adding its mark component (which is m.back() the last element in m) to the list of marks at step s</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="classgraph__message.html#a55ff5531a0043106369e84a7bc45e22d">is_star_message</a>.push_back(m[0]==-1); <span class="comment">// check if m is star type, and add this information to the list</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;  }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// the message already exists, just use the registered integer value corresponding to m and send the message</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">messages</a>[v][i] = it-&gt;second;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  }</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="comment">//cout &lt;&lt; &quot; message = &quot; &lt;&lt; messages[v][i] &lt;&lt; endl;</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div><div class="ttc" id="classgraph__message_html_a557473b726dc5d80618055a6b843670f"><div class="ttname"><a href="classgraph__message.html#a557473b726dc5d80618055a6b843670f">graph_message::message_dict</a></div><div class="ttdeci">unordered_map&lt; vector&lt; int &gt;, int, vint_hash &gt; message_dict</div><div class="ttdoc">message_dict is the message dictionary at any step that update_messages is running, which maps each message to its corresponding index in the dictionary. When update_messages is over, this corresponds to step (depth) h-1 </div><div class="ttdef"><b>Definition:</b> graph_message.h:54</div></div>
<div class="ttc" id="classgraph__message_html_af680c8a1755cf8d4aba389c1a3d6634e"><div class="ttname"><a href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">graph_message::messages</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; messages</div><div class="ttdoc">messages[v][i] is the integer version of the message from vertex v towards its ith neighbor (in the o...</div><div class="ttdef"><b>Definition:</b> graph_message.h:48</div></div>
<div class="ttc" id="structvint__hash_html"><div class="ttname"><a href="structvint__hash.html">vint_hash</a></div><div class="ttdef"><b>Definition:</b> graph_message.h:13</div></div>
<div class="ttc" id="classgraph__message_html_a49d9af5150daf0599c29fe18cb032fa5"><div class="ttname"><a href="classgraph__message.html#a49d9af5150daf0599c29fe18cb032fa5">graph_message::message_mark</a></div><div class="ttdeci">vector&lt; int &gt; message_mark</div><div class="ttdoc">for an integer message , message_mark[m] is the mark component associated to the message m at any ste...</div><div class="ttdef"><b>Definition:</b> graph_message.h:60</div></div>
<div class="ttc" id="classgraph__message_html_a55ff5531a0043106369e84a7bc45e22d"><div class="ttname"><a href="classgraph__message.html#a55ff5531a0043106369e84a7bc45e22d">graph_message::is_star_message</a></div><div class="ttdeci">vector&lt; bool &gt; is_star_message</div><div class="ttdoc">for an integer message , is_star_message[m] is true if m is a star message and false otherwise...</div><div class="ttdef"><b>Definition:</b> graph_message.h:62</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a40dadc59d582b290202e79bc4a9e896c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40dadc59d582b290202e79bc4a9e896c">&#9670;&nbsp;</a></span>update_messages()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void graph_message::update_messages </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classmarked__graph.html">marked_graph</a> &amp;&#160;</td>
          <td class="paramname"><em>G</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>performs the message passing algorithm and updates the messages array accordingly </p>
<p>The structure of messages is as follows. To simplify the notation, we use \(M_k(v,w)\) to denote the message sent from \(v\) towards \(w\) at time step \(k\), this is in fact messages[v][i][t] where i is the index of \(w\) among neighbors of \(v\).</p>
<ul>
<li>For \(k = 0\), we have \(M_0(v,w) = (\tau_G(v), 0,\xi_G(w,v))\) where \(\tau_G(v)\) is the mark of vertex \(v\) and \(\xi_G(w,v)\) denotes the mark of the edge between \(v\) and \(w\) towards \(v\).</li>
<li>For \(k &gt; 0\), if the degree of \(v\) is bigger than Delta, we have \(M_k(v,w) = (-1,\xi_G(w,v))\).</li>
<li>Otherwise, we form the list \((s_u: u \sim_G v, u \neq w)\), where for \(u \sim_G v, u \neq w\), we set \(s_u = (M_{k-1}(u,v), \xi_G(u,v))\).</li>
<li>If for some \(u \sim_G v, u \neq w\), the sequence \(s_u\) starts with a -1, we set \(M_k(v,w) = (-1,\xi_G(w,v))\).</li>
<li>Otherwise, we sort the sequences \(s_u\) nondecreasingly with respect to the lexicographic order and set \(s\) to be the concatenation of the sorted list. Finally, we set \(M_k(v,w) = (\tau_G(v), \deg_G(v) -1, s, \xi_G(w,v))\). </li>
</ul>
<div class="fragment"><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;{</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <a class="code" href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a>++;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;graph_message::update_message init&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordtype">int</span> nu_vertices = G.<a class="code" href="classmarked__graph.html#acf79c6aeb8f32614cb14a5baaa6c9f9b">nu_vertices</a>;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keywordtype">int</span> w;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <span class="keywordtype">int</span> my_location;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  <a class="code" href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">messages</a>.resize(nu_vertices);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <span class="comment">//inward_message.resize(nu_vertices);</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">//message_dict.resize(h);</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <span class="comment">//message_list.resize(h);</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="comment">//message_mark.resize(h);</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="comment">//is_star_message.resize(h);</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  </div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="comment">// initialize the messages</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;resizing messages&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v=0;v&lt;nu_vertices;v++){</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    <a class="code" href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">messages</a>[v].resize(G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v].size());</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="comment">//inward_messages[v].resize(G.adj_list[v].size());</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="comment">//for (int i=0;i&lt;G.adj_list[v].size();i++){</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="comment">//messages[v][i].resize(h);</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;      <span class="comment">//inward_messages[v][i].resize(h);</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  }</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;initializing messages&quot;</span>,<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  vector&lt;int&gt; m(3);</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  unordered_map&lt;vector&lt;int&gt;, int, <a class="code" href="structvint__hash.html">vint_hash</a>&gt;::iterator it;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">//map&lt;vector&lt;int&gt;, int&gt;::iterator it;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v=0;v&lt;nu_vertices;v++){</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v].size();i++){</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="comment">// the message from v towards the ith neighbor (lets call is w) at time 0 has a mark component which is \xi(v,w) and a subtree component which is a single root with mark \tau(v). This is encoded as a message vector with size 3 of the form (\tau(v), 0,\xi(v,w)) where the last 0 indicates that there is no offspring.</span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      <span class="comment">//vector&lt;int&gt; m;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="comment">//m.clear();</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">//m.push_back(G.ver_mark[v]);</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="comment">//m.push_back(0);</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="comment">//m.push_back(G.adj_list[v][i].second.first);</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      m[0] = G.<a class="code" href="classmarked__graph.html#ac83e9377dd4d8bb95be1ac949b127296">ver_mark</a>[v];</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      m[1] = 0;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      m[2] = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].second.first;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m, v, i);</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="comment">// adding this message to the message dictionary</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="comment">//it = message_dict[0].find(m);</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="comment">//w = G.adj_list[v][i].first;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="comment">/*</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">      if (it == message_dict[0].end()){</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">        message_dict[0][m] = message_list[0].size();</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">        messages[v][i][0] = message_list[0].size();</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">        message_list[0].push_back(m);</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">      }else{</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">        messages[v][i][0] = it-&gt;second;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">      }</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">      */</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <span class="comment">//messages[v][i][0] = message_dict[0][m]; // the message at time 0</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// these are copies of message_dict, message_mark and is_star_message at the previous step, which are used to update messages at the current step.</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  unordered_map&lt;vector&lt;int&gt;, int, <a class="code" href="structvint__hash.html">vint_hash</a>&gt; message_dict_old;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  vector&lt;int&gt; message_mark_old;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  vector&lt;bool&gt; is_star_message_old;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  vector&lt;vector&lt;int&gt; &gt; messages_old;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// updating messages</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;updating messages&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  m.reserve(5+ 2 * <a class="code" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a>);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  vector&lt;int&gt; m2;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  m2.reserve(5 + 2*<a class="code" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a>); <span class="comment">// an auxiliary message when we need to work with two types of messages simultaneously </span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  duration&lt;float&gt; diff;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  high_resolution_clock::time_point t1, t2; </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">float</span> agg_search = 0;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">float</span> agg_insert = 0;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">float</span> agg_m = 0;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordtype">float</span> agg_sort = 0;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keywordtype">float</span> agg_neigh_message = 0;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  vector&lt;pair&lt;pair&lt;int, int&gt;, <span class="keywordtype">int</span>&gt; &gt; neighbor_messages; <span class="comment">// the first component is the message and the second is the name of the neighbor</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="comment">// the second component is stored so that after sorting, we know the owner of the message</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  neighbor_messages.reserve(5+2*<a class="code" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> nu_star_neigh; <span class="comment">// number of star neighbors, i.e. neighbors of a vertex v whose message towards v are star type</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordtype">int</span> star_neigh_index; <span class="comment">// the index of the star neighbor of v, this is only useful when there is one star neighbor, if there are more than one star neighbor, then the message sent from v towards all other neighbors are star typed</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordtype">int</span> star_neigh; <span class="comment">// the label of the star neighbor, i.e. star_neigh = G.adj_list[v][star_neigh_index].first;</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">int</span> previous_message; <span class="comment">// the message from the previous step</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordtype">int</span> mark_to_v; <span class="comment">// mark towards the current vertex directed from its neighbor</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  vector&lt;int&gt; neighbors_list; <span class="comment">// the list of neighbors of a vertex in the order after sorting with respect to their corresponding messages</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  neighbors_list.reserve(<a class="code" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a> + 3);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordtype">int</span> deg_v; <span class="comment">// the degree of vertex v </span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> s=1; s&lt;<a class="code" href="classgraph__message.html#a934d63ed7275c211e13c6fb68824ed46">h</a>;s++){ <span class="comment">// s stands for step</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">//cerr &lt;&lt; endl &lt;&lt; endl&lt;&lt; &quot; depth &quot; &lt;&lt; s &lt;&lt; endl;</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// store variables corresponding to the previous step in their old version, and clearing the variables for this step:</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    message_dict_old = <a class="code" href="classgraph__message.html#a557473b726dc5d80618055a6b843670f">message_dict</a>;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    messages_old = <a class="code" href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">messages</a>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    message_mark_old = <a class="code" href="classgraph__message.html#a49d9af5150daf0599c29fe18cb032fa5">message_mark</a>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    is_star_message_old = <a class="code" href="classgraph__message.html#a55ff5531a0043106369e84a7bc45e22d">is_star_message</a>;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classgraph__message.html#a557473b726dc5d80618055a6b843670f">message_dict</a>.clear();</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classgraph__message.html#a49d9af5150daf0599c29fe18cb032fa5">message_mark</a>.clear();</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <a class="code" href="classgraph__message.html#a55ff5531a0043106369e84a7bc45e22d">is_star_message</a>.clear();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="comment">// we do not clear messages since we need its size to be the same, and we only modify its content</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    </div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v=0;v&lt;nu_vertices;v++){</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      deg_v = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v].size();</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">if</span> (deg_v==1){</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        <span class="comment">// no need to collect messages, there is only one message towards the one neighbor, which is known </span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        m.resize(3); <span class="comment">// there is only one message which is of the form \f$(\theta, 0, x)\f$, where \f$\theta\f$ is the mark of v, and \f$x = \xi_G(w,v)\f$  where \f$w\f$ is the only neighbor of v</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        m[0] = G.<a class="code" href="classmarked__graph.html#ac83e9377dd4d8bb95be1ac949b127296">ver_mark</a>[v];</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        m[1] = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        m[2] = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][0].second.first;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m, v, 0);</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> (deg_v &lt;= <a class="code" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a>){</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;          neighbor_messages.clear();</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          nu_star_neigh = 0;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;deg_v;i++){</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            w = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].first; <span class="comment">// neighbor label</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            my_location = G.<a class="code" href="classmarked__graph.html#aee10b537408de42476609c1e45c075d0">index_in_neighbor</a>[v][i];</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            previous_message = messages_old[w][my_location]; <span class="comment">// the message sent from this neighbor towards v at time t-1</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            <span class="comment">// check if previous message is star</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">if</span> (is_star_message_old[previous_message]){</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;              nu_star_neigh ++;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;              star_neigh_index = i;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;              star_neigh = w;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            <span class="keywordflow">if</span> (nu_star_neigh &gt;= 2)</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;              <span class="keywordflow">break</span>; <span class="comment">// then message towards all neighbors will be star, no need to collect messages</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            mark_to_v = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].second.first;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            neighbor_messages.push_back(pair&lt;pair&lt;int, int&gt; , <span class="keywordtype">int</span>&gt; (pair&lt;int,int&gt;(previous_message, mark_to_v), i));</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;          }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;          <span class="keywordflow">if</span> (nu_star_neigh == 2){</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="comment">// message towards all the neighbors will be star</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            m.resize(2);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            m[0] = -1;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v].size();i++){</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;              m[1] = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].second.first; </div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m, v, i); <span class="comment">// send message m from v towards its ith neighbor at step s</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;          }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;          <span class="keywordflow">if</span> (nu_star_neigh == 1){</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="comment">// the message towards all the neighbors except for that star neighbor is star</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="comment">// let m be the message towards that neighbor and m2 be the star messages</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="comment">// sorting neighbor messages</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            sort(neighbor_messages.begin(), neighbor_messages.end());</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="comment">// preparing m </span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            m.resize(0);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            m.push_back(G.<a class="code" href="classmarked__graph.html#ac83e9377dd4d8bb95be1ac949b127296">ver_mark</a>[v]);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            m.push_back(G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v].size()-1);</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            </div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;neighbor_messages.size();i++){</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;              <span class="keywordflow">if</span> (neighbor_messages[i].second != star_neigh_index){</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                <span class="comment">// collect the messages of non star neighbors</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                m.push_back(neighbor_messages[i].first.first);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                m.push_back(neighbor_messages[i].first.second);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;              }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            }</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="comment">// finalize m by inserting its mark component</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            m.push_back(G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][star_neigh_index].second.first);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="comment">// prepare star messages</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            m2.resize(2);</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            m2[0] = -1;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;deg_v;i++){</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;              <span class="keywordflow">if</span> (i==star_neigh_index){</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                <span class="comment">// send the prepared message m</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m, v, i);</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;              }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                <span class="comment">// prepare a star message and send it</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                m2[1] = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].second.first;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m2, v, i);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;              }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;            }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;          }</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;          <span class="keywordflow">if</span> (nu_star_neigh == 0){</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            <span class="comment">// no star neighbor, so we can prepare messages to all neighbors comfortably as none of them are star type</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            <span class="comment">// we do this by a masking technique</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">// sorting neighbor messages</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            sort(neighbor_messages.begin(), neighbor_messages.end());</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">if</span> (neighbor_messages.size() != deg_v){</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;              cerr &lt;&lt; <span class="stringliteral">&quot; Error: no star messages and yet neighbor_messages does not have a size equal to the deg of v, step &quot;</span> &lt;&lt; s &lt;&lt; <span class="stringliteral">&quot; v= &quot;</span> &lt;&lt; v &lt;&lt;  <span class="stringliteral">&quot; deg_v= &quot;</span> &lt;&lt; deg_v &lt;&lt; <span class="stringliteral">&quot; neighbor_messages.size() &quot;</span> &lt;&lt; neighbor_messages.size() &lt;&lt; endl;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            m.resize(1 + 1 + 2*(G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v].size()-1) +1); <span class="comment">// 1 for vertex mark, 1 for deg -1, for (deg-1) many neighbors, each we have 2 values, and finally 1 for the mark component</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            m[0] = G.<a class="code" href="classmarked__graph.html#ac83e9377dd4d8bb95be1ac949b127296">ver_mark</a>[v];</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            m[1] = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v].size()-1;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            neighbors_list.resize(deg_v);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;neighbor_messages.size();i++){</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;              m[2*(i+1)]   = neighbor_messages[i].first.first;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;              m[2*(i+1)+1] = neighbor_messages[i].first.second;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;              neighbors_list[i] = neighbor_messages[i].second;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            }</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="comment">// swapping the last message so that its mark component comes first, so that we can treat m as a valid message in our standard</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            swap(m[2*deg_v], m[2*deg_v+1]);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=neighbor_messages.size()-1;i&gt;=0;i--){</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;              <span class="keywordflow">if</span> (i &lt; neighbor_messages.size()-1){</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                swap(m[2*deg_v], m[2*(i+1)+1]);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                swap(m[2*deg_v+1], m[2*(i+1)]);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                swap(neighbors_list[deg_v-1], neighbors_list[i]);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;              }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;              <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m,v,neighbors_list[deg_v-1]);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;          }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (deg_v &gt; <a class="code" href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">Delta</a>){ <span class="comment">// the message towards all neighbors is star</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;          m.resize(2);</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;          m[0] = -1;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;deg_v;i++){</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            m[1] = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].second.first;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m,v,i);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    }</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  }</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;* symmetrizing&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordtype">bool</span> star1, star2;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  m.resize(2); <span class="comment">// prepare for star message</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  m[0] = -1;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> v=0;v&lt;nu_vertices;v++){</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v].size();i++){</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      w = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].first;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      my_location = G.<a class="code" href="classmarked__graph.html#aee10b537408de42476609c1e45c075d0">index_in_neighbor</a>[v][i];</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">if</span> (w &gt; v){ <span class="comment">// to avoid going over edges twice </span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        star1 = <a class="code" href="classgraph__message.html#a55ff5531a0043106369e84a7bc45e22d">is_star_message</a>[<a class="code" href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">messages</a>[v][i]];</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        star2 = <a class="code" href="classgraph__message.html#a55ff5531a0043106369e84a7bc45e22d">is_star_message</a>[messages[w][my_location]];</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        <span class="keywordflow">if</span> (star1 and !star2){</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          <span class="comment">// messages[v][i] should also become star</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          m[1] = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].second.first;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;          <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m,v,i);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (!star1 and star2){</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          <span class="comment">// message[w][my_location] should be star</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;          m[1] = G.<a class="code" href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">adj_list</a>[v][i].second.second;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;          <a class="code" href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">send_message</a>(m,w,my_location);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      }</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a>--;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="comment">// ==================================================</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="comment">// ==================================================</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// ==================================================</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">// ==================================================</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="comment">// ==================================================</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// ==================================================</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="comment">// ==================================================</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">// ==================================================</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">/*</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">  for (int t=1;t&lt;h;t++){</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">    for (int v=0;v&lt;nu_vertices;v++){</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">      //cerr &lt;&lt; &quot; vertex &quot; &lt;&lt; v &lt;&lt; endl;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">      if (G.adj_list[v].size() &lt;= Delta){</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">        // the degree of v is no more than Delta</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">        // do the standard message passing by aggregating messages from neighbors</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">        // stacking all the messages from neighbors of v towards v</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">        neighbor_messages.clear();</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">        // the message from each neighbor of v, say w,  towards v is considered, the mark of the edge between w and v towards v is added to it, and then all these objects are stacked in neighbor_messages to be sorted and used afterwards</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">        //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">        for (int i=0;i&lt;G.adj_list[v].size();i++){</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">          w = G.adj_list[v][i].first; // what is the name of the neighbor I am looking at now, which is the ith neighbor of vertex v </span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">          //my_location = G.adj_location[w].at(v); &lt;--- the inefficient way</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">          my_location = G.index_in_neighbor[v][i];</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">          // where is the place of node v among the list of neighbors of the ith neighbor of v</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">          int previous_message = messages[w][my_location][t-1]; // the message sent from this neighbor towards v at time t-1</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">          int mark_to_v = G.adj_list[v][i].second.first;</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">          neighbor_messages.push_back(pair&lt;pair&lt;int, int&gt; , int&gt; (pair&lt;int,int&gt;(previous_message, mark_to_v), w));</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">        //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">        //diff = t2 - t1;</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">        //agg_neigh_message += diff.count();</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">        //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">        sort(neighbor_messages.begin(), neighbor_messages.end()); // sorts lexicographically</span></div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">        //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">        //diff = t2 - t1;</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">        //agg_sort += diff.count();</span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">        for (int i=0;i&lt;G.adj_list[v].size();i++){</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">          // let w be the current ith neighbor of v</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">          int w = G.adj_list[v][i].first;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">          // first, start with the mark of v and the number of offsprings in the subgraph component of the message</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">          //vector&lt;int&gt; m; // the message that v is going to send to w</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">          //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment">          m.clear();</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">          m.push_back(G.ver_mark[v]); // mark of v</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">          m.push_back(G.adj_list[v].size()-1); // the number of offsprings in the subgraph component of the message</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">          //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">          //diff = t2 - t1;</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment">          //agg_m += diff.count();</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment">          // stacking messages from all neighbors of v expect for w towards v at time t-1</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">          for (int j=0;j&lt;G.adj_list[v].size();j++){</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">            if (neighbor_messages[j].second != w){</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">              if (message_list[t-1][neighbor_messages[j].first.first][0] == -1){</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">                // this means that one of the messages that should be aggregated is * typed, therefore the outgoing messages should also be * typed</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">                // i.e. the message has only two entries: (-1, \xi(w,v)) where \xi(w,v) is the mark of the edge between v and w towards v</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">                // since after this loop, the mark \xi(w,v) is added to the message (after the comment starting with &#39;finally&#39;), we only add the initial -1 part</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">                //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">                m.resize(0);</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">                m.push_back(-1);</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">                //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">                //diff = t2 - t1;</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">                //agg_m += diff.count();</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">                break; // the message is decided, we do not need to go over any of the other neighbor messages, hence break</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">              }</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">              // this message should be added to the list of messages</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">              //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">              m.push_back(neighbor_messages[j].first.first); // message part</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">              m.push_back(neighbor_messages[j].first.second); // mark part towards v</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">              //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">              //diff = t2 - t1;</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">              //agg_m += diff.count();</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">            }</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">          }</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">          // if we break, we reach at this point and message is (-1), otherwise the message is of the form (\tau(v), \deg(v) - 1, ...) where ... is the list of all neighbor messages towards v except for w. </span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">          // finally, the mark of the edge between v and w towards v, \xi(w,v), should be added to this list</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">          //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">          m.push_back(G.adj_list[v][i].second.first);</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">          //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">          //diff = t2 - t1;</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">          //agg_m += diff.count();</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">          // set the current message</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment">          //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">          it = message_dict[t].find(m);</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">          //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">          //diff = t2 - t1;</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">          //agg_search += diff.count();</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment">          if (it == message_dict[t].end()){</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">            //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">            //message_dict[t][m] = message_list[t].size();</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">            message_dict[t].insert(pair&lt;vector&lt;int&gt;, int&gt; (m, message_list[t].size()));</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">            //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">            //diff = t2 - t1;</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">            //agg_insert += diff.count();</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">            messages[v][i][t] = message_list[t].size();</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">            message_list[t].push_back(m);</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">          }else{</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">            messages[v][i][t] = it-&gt;second;</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">          }</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">      }else{</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">        // if the degree of v is bigger than Delta, the message towards all neighbors is of the form *</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">        // i.e. message of v towards a neighbor w is of the form (-1, \xi(w,v)) where \xi(w,v) is the mark of the edge between v and w towards v</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">        for (int i=0;i&lt;G.adj_list[v].size();i++){</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">          //vector&lt;int&gt; m; // the current message from v to ith neighbor</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">          //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">          m.clear();</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">          m.resize(2);</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">          m[0] = -1;</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">          m[1] = G.adj_list[v][i].second.first;</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">          //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">          //diff = t2 - t1;</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">          //agg_m += diff.count();</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">          // set the current message</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">          //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">          it = message_dict[t].find(m);</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">          //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">          //diff = t2 - t1;</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">          //agg_search += diff.count();</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">          if (it == message_dict[t].end()){</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">            //t1 = high_resolution_clock::now();</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">            //message_dict[t][m] = message_list[t].size();</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">            message_dict[t].insert(pair&lt;vector&lt;int&gt;, int&gt; (m, message_list[t].size()));</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">            //t2 = high_resolution_clock::now();</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">            //diff = t2 - t1;</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">            //agg_insert += diff.count();</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">            messages[v][i][t] = message_list[t].size();</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">            message_list[t].push_back(m);</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">          }else{</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">            messages[v][i][t] = it-&gt;second;</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">          }</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">      }</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">  cerr &lt;&lt; &quot; total time to search in hash table: &quot; &lt;&lt; agg_search &lt;&lt; endl;</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">  cerr &lt;&lt; &quot; total time to insert in hash table: &quot; &lt;&lt; agg_insert &lt;&lt; endl;</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment">  cerr &lt;&lt; &quot; total time to modify vector m  &quot; &lt;&lt; agg_m &lt;&lt; endl;</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">  cerr &lt;&lt; &quot; total time to sort  &quot; &lt;&lt; agg_sort &lt;&lt; endl;</span></div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">  cerr &lt;&lt; &quot; total time to collect neighbor messages &quot; &lt;&lt;  agg_neigh_message &lt;&lt; endl;</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment">  // now, we should update messages at time h-1 so that if the message from v to w is *, i.e. is of the form (-1,x), then the message from w to v is also of the similar form, i.e. it is (-1,x&#39;) where x&#39; = \xi(v,w)</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">  logger::add_entry(&quot;* symmetrizing&quot;, &quot;&quot;);</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment">  for (int v=0;v&lt;nu_vertices;v++){</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">    for (int i=0;i&lt;G.adj_list[v].size();i++){</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">      if (message_list[h-1][messages[v][i][h-1]][0] == -1){</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment">        // it is of the form *</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">        w = G.adj_list[v][i].first; // the other endpoint of the edge</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">        //my_location = G.adj_location[w].at(v); // so that adj_list[w][my_location].first = v</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment">        my_location = G.index_in_neighbor[v][i];</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">        //vector&lt;int&gt; m;</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment">        m.clear();</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">        m.resize(2);</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">        m[0] = -1;</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">        m[1] = G.adj_list[v][i].second.second; // the mark towards w</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">        if (message_dict[h-1].find(m) == message_dict[h-1].end()){</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">          message_dict[h-1][m] = message_list[h-1].size();</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">          message_list[h-1].push_back(m);</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">        messages[w][my_location][h-1] = message_dict[h-1][m];</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">      }</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">  // setting message_mark and is_star_message</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">  logger::add_entry(&quot;setting message_mark and is_star_message&quot;, &quot;&quot;);</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">  message_mark.resize(message_list[h-1].size());</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">  is_star_message.resize(message_list[h-1].size());</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">  for (int i=0;i&lt;message_list[h-1].size();i++){</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">    message_mark[i] = message_list[h-1][i].back(); // the last element is the mark component</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">    is_star_message[i] = (message_list[h-1][i][0] == -1); // message is star type when the first element is -1</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">  }</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">  logger::current_depth--;</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">  */</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div><div class="ttc" id="classlogger_html_a710163deb17bc81f70d53d285b8ac9ac"><div class="ttname"><a href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a></div><div class="ttdeci">static void add_entry(string name, string description)</div><div class="ttdef"><b>Definition:</b> logger.cpp:19</div></div>
<div class="ttc" id="classlogger_html_a9d29b49bd318a719a8e85b59eac54fe0"><div class="ttname"><a href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a></div><div class="ttdeci">static int current_depth</div><div class="ttdef"><b>Definition:</b> logger.h:30</div></div>
<div class="ttc" id="classmarked__graph_html_a1a0bf7ca413a278763f7c878b3b6fd6f"><div class="ttname"><a href="classmarked__graph.html#a1a0bf7ca413a278763f7c878b3b6fd6f">marked_graph::adj_list</a></div><div class="ttdeci">vector&lt; vector&lt; pair&lt; int, pair&lt; int, int &gt; &gt; &gt; &gt; adj_list</div><div class="ttdoc">adj_list[i] is the list of edges connected to vertex i, each of the format (other endpoint...</div><div class="ttdef"><b>Definition:</b> marked_graph.h:18</div></div>
<div class="ttc" id="classgraph__message_html_a557473b726dc5d80618055a6b843670f"><div class="ttname"><a href="classgraph__message.html#a557473b726dc5d80618055a6b843670f">graph_message::message_dict</a></div><div class="ttdeci">unordered_map&lt; vector&lt; int &gt;, int, vint_hash &gt; message_dict</div><div class="ttdoc">message_dict is the message dictionary at any step that update_messages is running, which maps each message to its corresponding index in the dictionary. When update_messages is over, this corresponds to step (depth) h-1 </div><div class="ttdef"><b>Definition:</b> graph_message.h:54</div></div>
<div class="ttc" id="classgraph__message_html_af680c8a1755cf8d4aba389c1a3d6634e"><div class="ttname"><a href="classgraph__message.html#af680c8a1755cf8d4aba389c1a3d6634e">graph_message::messages</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; messages</div><div class="ttdoc">messages[v][i] is the integer version of the message from vertex v towards its ith neighbor (in the o...</div><div class="ttdef"><b>Definition:</b> graph_message.h:48</div></div>
<div class="ttc" id="structvint__hash_html"><div class="ttname"><a href="structvint__hash.html">vint_hash</a></div><div class="ttdef"><b>Definition:</b> graph_message.h:13</div></div>
<div class="ttc" id="classgraph__message_html_a49d9af5150daf0599c29fe18cb032fa5"><div class="ttname"><a href="classgraph__message.html#a49d9af5150daf0599c29fe18cb032fa5">graph_message::message_mark</a></div><div class="ttdeci">vector&lt; int &gt; message_mark</div><div class="ttdoc">for an integer message , message_mark[m] is the mark component associated to the message m at any ste...</div><div class="ttdef"><b>Definition:</b> graph_message.h:60</div></div>
<div class="ttc" id="classgraph__message_html_a45dfd061b7bc73572e5132fbf66efd55"><div class="ttname"><a href="classgraph__message.html#a45dfd061b7bc73572e5132fbf66efd55">graph_message::Delta</a></div><div class="ttdeci">int Delta</div><div class="ttdoc">the maximum degree threshold </div><div class="ttdef"><b>Definition:</b> graph_message.h:34</div></div>
<div class="ttc" id="classmarked__graph_html_acf79c6aeb8f32614cb14a5baaa6c9f9b"><div class="ttname"><a href="classmarked__graph.html#acf79c6aeb8f32614cb14a5baaa6c9f9b">marked_graph::nu_vertices</a></div><div class="ttdeci">int nu_vertices</div><div class="ttdoc">number of vertices in the graph </div><div class="ttdef"><b>Definition:</b> marked_graph.h:17</div></div>
<div class="ttc" id="classmarked__graph_html_ac83e9377dd4d8bb95be1ac949b127296"><div class="ttname"><a href="classmarked__graph.html#ac83e9377dd4d8bb95be1ac949b127296">marked_graph::ver_mark</a></div><div class="ttdeci">vector&lt; int &gt; ver_mark</div><div class="ttdoc">ver_mark[i] is the mark of vertex i </div><div class="ttdef"><b>Definition:</b> marked_graph.h:23</div></div>
<div class="ttc" id="classgraph__message_html_aa76d1d5420a12477fa1dddd878d78c8f"><div class="ttname"><a href="classgraph__message.html#aa76d1d5420a12477fa1dddd878d78c8f">graph_message::send_message</a></div><div class="ttdeci">void send_message(const vector&lt; int &gt; &amp;m, int v, int i)</div><div class="ttdoc">update message_dict and message_list </div><div class="ttdef"><b>Definition:</b> graph_message.cpp:480</div></div>
<div class="ttc" id="classgraph__message_html_a934d63ed7275c211e13c6fb68824ed46"><div class="ttname"><a href="classgraph__message.html#a934d63ed7275c211e13c6fb68824ed46">graph_message::h</a></div><div class="ttdeci">int h</div><div class="ttdoc">the depth up to which we do message passing (the type of edges go through depth h-1) ...</div><div class="ttdef"><b>Definition:</b> graph_message.h:33</div></div>
<div class="ttc" id="classmarked__graph_html_aee10b537408de42476609c1e45c075d0"><div class="ttname"><a href="classmarked__graph.html#aee10b537408de42476609c1e45c075d0">marked_graph::index_in_neighbor</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; index_in_neighbor</div><div class="ttdoc">index_in_neighbor[v][i] is the index of vertex v in the adjacency list of the ith neighbor of v ...</div><div class="ttdef"><b>Definition:</b> marked_graph.h:21</div></div>
<div class="ttc" id="classgraph__message_html_a55ff5531a0043106369e84a7bc45e22d"><div class="ttname"><a href="classgraph__message.html#a55ff5531a0043106369e84a7bc45e22d">graph_message::is_star_message</a></div><div class="ttdeci">vector&lt; bool &gt; is_star_message</div><div class="ttdoc">for an integer message , is_star_message[m] is true if m is a star message and false otherwise...</div><div class="ttdef"><b>Definition:</b> graph_message.h:62</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a45dfd061b7bc73572e5132fbf66efd55"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45dfd061b7bc73572e5132fbf66efd55">&#9670;&nbsp;</a></span>Delta</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int graph_message::Delta</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the maximum degree threshold </p>

</div>
</div>
<a id="a934d63ed7275c211e13c6fb68824ed46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a934d63ed7275c211e13c6fb68824ed46">&#9670;&nbsp;</a></span>h</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int graph_message::h</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>the depth up to which we do message passing (the type of edges go through depth h-1) </p>

</div>
</div>
<a id="a55ff5531a0043106369e84a7bc45e22d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55ff5531a0043106369e84a7bc45e22d">&#9670;&nbsp;</a></span>is_star_message</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;bool&gt; graph_message::is_star_message</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>for an integer message \(m\), is_star_message[m] is true if m is a star message and false otherwise. Note that m is star type iff the first index in the vector message corresponding to m is -1. This is updated at step of update_messages, so when it is over, it corresponds to step (depth) h-1. </p>

</div>
</div>
<a id="a557473b726dc5d80618055a6b843670f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a557473b726dc5d80618055a6b843670f">&#9670;&nbsp;</a></span>message_dict</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unordered_map&lt;vector&lt;int&gt;, int, <a class="el" href="structvint__hash.html">vint_hash</a>&gt; graph_message::message_dict</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>message_dict is the message dictionary at any step that update_messages is running, which maps each message to its corresponding index in the dictionary. When update_messages is over, this corresponds to step (depth) h-1 </p>

</div>
</div>
<a id="a49d9af5150daf0599c29fe18cb032fa5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49d9af5150daf0599c29fe18cb032fa5">&#9670;&nbsp;</a></span>message_mark</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;int&gt; graph_message::message_mark</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>for an integer message \(m\), message_mark[m] is the mark component associated to the message m at any step that update_messages is working. This is basically the last index in the vector message associate to m. When update_messages is over, this corresponds to step (depth) h-1. </p>

</div>
</div>
<a id="af680c8a1755cf8d4aba389c1a3d6634e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af680c8a1755cf8d4aba389c1a3d6634e">&#9670;&nbsp;</a></span>messages</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;vector&lt;int &gt; &gt; graph_message::messages</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>messages[v][i] is the integer version of the message from vertex v towards its ith neighbor (in the order given by adj_list of vertex i in graph G). The message is at any given step that update_messages is running, so after finishing update_message, the messages are at step (depth) h-1. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="graph__message_8h_source.html">graph_message.h</a></li>
<li><a class="el" href="graph__message_8cpp.html">graph_message.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
