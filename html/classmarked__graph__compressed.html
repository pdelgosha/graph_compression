<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Marked Graph Compression: marked_graph_compressed Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Marked Graph Compression
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classmarked__graph__compressed-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">marked_graph_compressed Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="marked__graph__compression_8h_source.html">marked_graph_compression.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:af58307bfadcaa4c3ca6dd594c2f9b3a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#af58307bfadcaa4c3ca6dd594c2f9b3a9">clear</a> ()</td></tr>
<tr class="separator:af58307bfadcaa4c3ca6dd594c2f9b3a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9cdb7fc43badd58fb5202f74ffac723"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#ab9cdb7fc43badd58fb5202f74ffac723">binary_write</a> (FILE *f)</td></tr>
<tr class="memdesc:ab9cdb7fc43badd58fb5202f74ffac723"><td class="mdescLeft">&#160;</td><td class="mdescRight">writes the compressed data to a binary file  <a href="#ab9cdb7fc43badd58fb5202f74ffac723">More...</a><br /></td></tr>
<tr class="separator:ab9cdb7fc43badd58fb5202f74ffac723"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13ab09e4b399f179ec91746ae2b8b38c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a13ab09e4b399f179ec91746ae2b8b38c">binary_write</a> (string s)</td></tr>
<tr class="separator:a13ab09e4b399f179ec91746ae2b8b38c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9db2d11bd63ad3d5a75e47b4023a89dd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a9db2d11bd63ad3d5a75e47b4023a89dd">binary_read</a> (FILE *f)</td></tr>
<tr class="memdesc:a9db2d11bd63ad3d5a75e47b4023a89dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">read the compressed data from a binary file  <a href="#a9db2d11bd63ad3d5a75e47b4023a89dd">More...</a><br /></td></tr>
<tr class="separator:a9db2d11bd63ad3d5a75e47b4023a89dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01c67fe4234738db6bb60459515c3ad8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a01c67fe4234738db6bb60459515c3ad8">binary_read</a> (string s)</td></tr>
<tr class="separator:a01c67fe4234738db6bb60459515c3ad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ce51414e335d817f4be781fdcfbe9b1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a5ce51414e335d817f4be781fdcfbe9b1">vtype_max_match</a> (int i, int j)</td></tr>
<tr class="memdesc:a5ce51414e335d817f4be781fdcfbe9b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">finds the maximum number of (t,t',n) blocks that match between two entries of ver_type_list  <a href="#a5ce51414e335d817f4be781fdcfbe9b1">More...</a><br /></td></tr>
<tr class="separator:a5ce51414e335d817f4be781fdcfbe9b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a889749dd51bc37917a156e337eac142a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a889749dd51bc37917a156e337eac142a">vtype_list_write</a> (<a class="el" href="classobitstream.html">obitstream</a> &amp;oup)</td></tr>
<tr class="memdesc:a889749dd51bc37917a156e337eac142a"><td class="mdescLeft">&#160;</td><td class="mdescRight">writes the ver_type_list array to the output using difference coding, assuming that its entries are lexicographically sorted (as vectors)  <a href="#a889749dd51bc37917a156e337eac142a">More...</a><br /></td></tr>
<tr class="separator:a889749dd51bc37917a156e337eac142a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af29f16cbd56583652118eb24a7c233b7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#af29f16cbd56583652118eb24a7c233b7">vtype_list_read</a> (<a class="el" href="classibitstream.html">ibitstream</a> &amp;inp)</td></tr>
<tr class="memdesc:af29f16cbd56583652118eb24a7c233b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">reads the ver_type_list array from the input, assuming the bit sequence was generated during compression using vtype_list_write  <a href="#af29f16cbd56583652118eb24a7c233b7">More...</a><br /></td></tr>
<tr class="separator:af29f16cbd56583652118eb24a7c233b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31f9ea72682f9072d0f90faf58a603fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">vtype_block_write</a> (<a class="el" href="classobitstream.html">obitstream</a> &amp;oup, int i, int j)</td></tr>
<tr class="separator:a31f9ea72682f9072d0f90faf58a603fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad443f83015addcc0f2b0e35351ae9362"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#ad443f83015addcc0f2b0e35351ae9362">vtype_block_write</a> (<a class="el" href="classobitstream.html">obitstream</a> &amp;oup, int i, int j, int ir, int jr)</td></tr>
<tr class="separator:ad443f83015addcc0f2b0e35351ae9362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4bf8563a2dfd3038dc5833c014320487"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">vtype_block_read</a> (<a class="el" href="classibitstream.html">ibitstream</a> &amp;inp, int i, int j)</td></tr>
<tr class="separator:a4bf8563a2dfd3038dc5833c014320487"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01a434f3313d99b5877eddacb380cf15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a01a434f3313d99b5877eddacb380cf15">vtype_block_read</a> (<a class="el" href="classibitstream.html">ibitstream</a> &amp;inp, int i, int j, int ir, int jr)</td></tr>
<tr class="separator:a01a434f3313d99b5877eddacb380cf15"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a8d841016ddb11cfd33748c8deb6277ba"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a></td></tr>
<tr class="memdesc:a8d841016ddb11cfd33748c8deb6277ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">the number of vertices  <a href="#a8d841016ddb11cfd33748c8deb6277ba">More...</a><br /></td></tr>
<tr class="separator:a8d841016ddb11cfd33748c8deb6277ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6ff623407b673d08d0cab77b39c2193"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a></td></tr>
<tr class="memdesc:af6ff623407b673d08d0cab77b39c2193"><td class="mdescLeft">&#160;</td><td class="mdescRight">the depth up to which the compression was performed  <a href="#af6ff623407b673d08d0cab77b39c2193">More...</a><br /></td></tr>
<tr class="separator:af6ff623407b673d08d0cab77b39c2193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b2aaac68e9332ddc78d88eb60b323a7"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a></td></tr>
<tr class="memdesc:a8b2aaac68e9332ddc78d88eb60b323a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">the degree threshold used when compression was performed  <a href="#a8b2aaac68e9332ddc78d88eb60b323a7">More...</a><br /></td></tr>
<tr class="separator:a8b2aaac68e9332ddc78d88eb60b323a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a4ced4586e2e353f9076bd447df5208"><td class="memItemLeft" align="right" valign="top">pair&lt; vector&lt; int &gt;, mpz_class &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a></td></tr>
<tr class="memdesc:a7a4ced4586e2e353f9076bd447df5208"><td class="mdescLeft">&#160;</td><td class="mdescRight">the compressed form of the star_vertices list  <a href="#a7a4ced4586e2e353f9076bd447df5208">More...</a><br /></td></tr>
<tr class="separator:a7a4ced4586e2e353f9076bd447df5208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7df5779d313486644132bd816937f532"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; int, int &gt;, vector&lt; vector&lt; int &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a></td></tr>
<tr class="memdesc:a7df5779d313486644132bd816937f532"><td class="mdescLeft">&#160;</td><td class="mdescRight">for each pair of edge marks x,x', and integer \(k\), star_edges[pair&lt;int,int&gt;(x,x')][k] is a list of neighbors \(w\) of the \(k\)th star vertex (say \(v\)) so that \(v\) shares a star edge with \(w\) so that the mark towards \(v\) is x and the mark towards \(w\) is xp.  <a href="#a7df5779d313486644132bd816937f532">More...</a><br /></td></tr>
<tr class="separator:a7df5779d313486644132bd816937f532"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86b00223525703e973415cbc9c94da68"><td class="memItemLeft" align="right" valign="top">vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a></td></tr>
<tr class="memdesc:a86b00223525703e973415cbc9c94da68"><td class="mdescLeft">&#160;</td><td class="mdescRight">for an edge type t, type_mark[t] denotes the mark component of t  <a href="#a86b00223525703e973415cbc9c94da68">More...</a><br /></td></tr>
<tr class="separator:a86b00223525703e973415cbc9c94da68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2e3e55223d436628a02758dfae88493"><td class="memItemLeft" align="right" valign="top">vector&lt; vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a></td></tr>
<tr class="memdesc:af2e3e55223d436628a02758dfae88493"><td class="mdescLeft">&#160;</td><td class="mdescRight">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of integers, where its index 0 is the mark of the vertex, and indices \(3k+1\), \(3k+2\), \(3k+3\) are \(m\), \(m&#39;\) and \(n_{m,m&#39;}\), where \((m,m&#39;)\) is a type pair, and \(n_{m,m&#39;}\) is the number of edges connected to the vertex with that type. The list is sorted lexicographically to ensure unique representation.  <a href="#af2e3e55223d436628a02758dfae88493">More...</a><br /></td></tr>
<tr class="separator:af2e3e55223d436628a02758dfae88493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af446cc5e23c241a92b76642fd5ebc403"><td class="memItemLeft" align="right" valign="top">pair&lt; vector&lt; int &gt;, mpz_class &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a></td></tr>
<tr class="memdesc:af446cc5e23c241a92b76642fd5ebc403"><td class="mdescLeft">&#160;</td><td class="mdescRight">the compressed form of vertex types, where the type of a vertex is the index with respect to ver_type_list of the list of integers specifying the type of the vertex (mark of the vertex followed by the number of edges of each type connected to that vertex)  <a href="#af446cc5e23c241a92b76642fd5ebc403">More...</a><br /></td></tr>
<tr class="separator:af446cc5e23c241a92b76642fd5ebc403"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b3267063fba30b45eb21b3ba4e07536"><td class="memItemLeft" align="right" valign="top">map&lt; pair&lt; int, int &gt;, mpz_class &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a></td></tr>
<tr class="memdesc:a7b3267063fba30b45eb21b3ba4e07536"><td class="mdescLeft">&#160;</td><td class="mdescRight">compressed form of partition bipartite graphs corresponding to colors in \(C_&lt;\). For a pair \(0 \leq t &lt; t&#39; &lt; L\) of half edge types, part_bgraph[pair&lt;int, int&gt;(t,t')] is the compressed form of the bipartite graph with n left and right nodes, where a left node i is connected to a right node j if there is an edge connecting i to j with type t towards i and type t' towards j  <a href="#a7b3267063fba30b45eb21b3ba4e07536">More...</a><br /></td></tr>
<tr class="separator:a7b3267063fba30b45eb21b3ba4e07536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae179a4737e6eab905c18a94d44ef64b7"><td class="memItemLeft" align="right" valign="top">map&lt; int, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a></td></tr>
<tr class="memdesc:ae179a4737e6eab905c18a94d44ef64b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">compressed form of partition graphs corresponding to colors in \(C_=\). For a half edge type t, part_graph[t] is the compressed form of the simple unmarked graph with n vertices, where a node i is connected to a node j where there is an edge between i and j in the original graph with color (t,t)  <a href="#ae179a4737e6eab905c18a94d44ef64b7">More...</a><br /></td></tr>
<tr class="separator:ae179a4737e6eab905c18a94d44ef64b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9db2d11bd63ad3d5a75e47b4023a89dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9db2d11bd63ad3d5a75e47b4023a89dd">&#9670;&nbsp;</a></span>binary_read() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::binary_read </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read the compressed data from a binary file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>a <code>FILE*</code> object which is the address of the binary file to write </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                                                {</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af58307bfadcaa4c3ca6dd594c2f9b3a9">clear</a>(); <span class="comment">// to make sure nothing is stored inside me before reading</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">// ==== read n, h, delta</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  fread(&amp;<a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>, <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>, 1, f);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  fread(&amp;<a class="code" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a>, <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a>, 1, f);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  fread(&amp;<a class="code" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a>, <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a>, 1, f);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordtype">int</span> int_in; <span class="comment">// auxiliary input integer</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  <span class="comment">// ===== read type_mark</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">// read number of types</span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.resize(int_in);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.size();i++){</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>[i] = int_in;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">// ==== read star_vertices</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="comment">// first, read the frequency.</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first = vector&lt;int&gt;(2); <span class="comment">// frequency,</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="comment">// we read its first index which is number of zeros, and the second is n - the first.</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[0] = int_in;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[1] = <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a> - int_in;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="comment">// the integer representation which is star_vertices.second</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  mpz_inp_raw(<a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.second.get_mpz_t(), f);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  <span class="comment">// ==== read star_edges</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  <span class="keywordtype">int</span> log2n = 0; <span class="comment">// the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log_2 n), which is the number of bits to encode vertices</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;  <span class="keywordtype">int</span> n_copy = <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="keywordflow">while</span>(n_copy &gt; 0){</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    n_copy &gt;&gt;= 1;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    log2n ++;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  }</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  bitset&lt;8*sizeof(int)&gt; B; <span class="comment">// a bit stream with maximum length of int to store a vertex index</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="keywordtype">string</span> s;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  stringstream ss;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="keywordtype">int</span> sp; <span class="comment">// the index of the string s we are studying </span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">// read the size of star_edges</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="keywordtype">int</span> star_edges_size;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  fread(&amp;star_edges_size, <span class="keyword">sizeof</span> star_edges_size, 1, f);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordtype">int</span> x, xp; <span class="comment">// edge marks</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;  <span class="keywordtype">int</span> nu_star_vertices = <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[1];</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  vector&lt;vector&lt;int&gt; &gt; V; <span class="comment">// the list of star edges corresponding to each mark pair</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  V.resize(nu_star_vertices);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;star_edges_size;i++){</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    fread(&amp;x, <span class="keyword">sizeof</span> x, 1, f);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    fread(&amp;xp, <span class="keyword">sizeof</span> xp, 1, f);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    s = <a class="code" href="compression__helper_8cpp.html#a40e8dcbc036f96b28e003e882c4890b7">bit_string_read</a>(f);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">//cerr &lt;&lt; &quot; read  x &quot; &lt;&lt; x &lt;&lt; &quot; xp &quot; &lt;&lt; xp &lt;&lt; &quot; s &quot; &lt;&lt; s &lt;&lt; endl;</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    sp = 0; <span class="comment">// starting from zero </span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nu_star_vertices; j++){ <span class="comment">// </span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      V[j].clear(); <span class="comment">// make it fresh</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">while</span>(s[sp++] == <span class="charliteral">&#39;1&#39;</span>){ <span class="comment">// there is still some edge connected to this vertex </span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment">// read log2n many bits</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot; s subtr &quot; &lt;&lt; s.substr(sp, log2n);</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="comment">//ss &lt;&lt; s.substr(sp, log2n);</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        B = bitset&lt;8*sizeof(int)&gt;(s.substr(sp, log2n));</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot; ss &quot; &lt;&lt; ss.str() &lt;&lt; endl;</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        sp += log2n;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="comment">//ss &gt;&gt; B;</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;        V[j].push_back(B.to_ulong());</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      }</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      <span class="comment">//for (int k=0;k&lt;V[j].size();k++)</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;      <span class="comment">//  cerr &lt;&lt; &quot; , &quot; &lt;&lt; V[j][k];</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="comment">//cerr &lt;&lt; endl;</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    }</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.insert(pair&lt; pair&lt;int, int&gt; , vector&lt;vector&lt;int&gt; &gt; &gt; (pair&lt;int, int&gt;(x, xp), V));</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  }</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="comment">// ==== read vertex_types</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;  <span class="comment">// read ver_type_list</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f); <span class="comment">// size of ver_type_list</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.resize(int_in);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.size();i++){</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f); <span class="comment">// size of ver_type_list[i]</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].resize(int_in);</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size();j++){</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][j] = int_in;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  }</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="comment">// ver_types</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">// ver_types.first</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">// ver_types.first.size()</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first.resize(int_in);</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first.size();i++){</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first[i] = int_in;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  }</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="comment">// ver_types.second</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  mpz_inp_raw(<a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.second.get_mpz_t(), f);</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="comment">// === part bgraphs</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordtype">int</span> part_bgraph_size;</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordtype">int</span> t, tp;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  pair&lt;int, int&gt; type; </div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  mpz_class part_g; </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  fread(&amp;part_bgraph_size, <span class="keyword">sizeof</span> part_bgraph_size, 1, f);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;part_bgraph_size;i++){</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    <span class="comment">// read t, t&#39;</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    fread(&amp;t, <span class="keyword">sizeof</span> t, 1, f);</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    fread(&amp;tp, <span class="keyword">sizeof</span> tp, 1, f);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    type = pair&lt;int, int&gt;(t, tp);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    mpz_inp_raw(part_g.get_mpz_t(), f);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.insert(pair&lt;pair&lt;int, int&gt;, mpz_class&gt; (type, part_g));</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  }</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="comment">// === part graphs</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="comment">// first, the size</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordtype">int</span> part_graph_size;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordtype">int</span> v_size;</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  vector&lt;int&gt; W; </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  fread(&amp;part_graph_size, <span class="keyword">sizeof</span> part_graph_size, 1, f);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;part_graph_size; i++){</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <span class="comment">// first, the type</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;    fread(&amp;t, <span class="keyword">sizeof</span> t, 1, f);</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    <span class="comment">// then, the mpz part</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    mpz_inp_raw(part_g.get_mpz_t(), f);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="comment">// then, the vector size</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    fread(&amp;v_size, <span class="keyword">sizeof</span> v_size, 1, f);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    W.resize(v_size);</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;v_size; j++){</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;      fread(&amp;int_in, <span class="keyword">sizeof</span> int_in, 1, f);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;      W[j] = int_in;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    }</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.insert(pair&lt;<span class="keywordtype">int</span>, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt;(t, pair&lt;mpz_class, vector&lt;int&gt; &gt;(part_g, W)));</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  }</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af446cc5e23c241a92b76642fd5ebc403"><div class="ttname"><a href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">marked_graph_compressed::ver_types</a></div><div class="ttdeci">pair&lt; vector&lt; int &gt;, mpz_class &gt; ver_types</div><div class="ttdoc">the compressed form of vertex types, where the type of a vertex is the index with respect to ver_type...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:33</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7df5779d313486644132bd816937f532"><div class="ttname"><a href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">marked_graph_compressed::star_edges</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, vector&lt; vector&lt; int &gt; &gt; &gt; star_edges</div><div class="ttdoc">for each pair of edge marks x,x&amp;#39;, and integer , star_edges[pair&lt;int,int&gt;(x,x&amp;#39;)][k] is a list of neigh...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:26</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7b3267063fba30b45eb21b3ba4e07536"><div class="ttname"><a href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">marked_graph_compressed::part_bgraph</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, mpz_class &gt; part_bgraph</div><div class="ttdoc">compressed form of partition bipartite graphs corresponding to colors in . For a pair  of half edge t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:35</div></div>
<div class="ttc" id="compression__helper_8cpp_html_a40e8dcbc036f96b28e003e882c4890b7"><div class="ttname"><a href="compression__helper_8cpp.html#a40e8dcbc036f96b28e003e882c4890b7">bit_string_read</a></div><div class="ttdeci">string bit_string_read(FILE *f)</div><div class="ttdoc">Reads a bit sequence from a binary file, assuming the bit sequence was generated by the bit_string_wr...</div><div class="ttdef"><b>Definition:</b> compression_helper.cpp:375</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af58307bfadcaa4c3ca6dd594c2f9b3a9"><div class="ttname"><a href="classmarked__graph__compressed.html#af58307bfadcaa4c3ca6dd594c2f9b3a9">marked_graph_compressed::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.cpp:8</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7a4ced4586e2e353f9076bd447df5208"><div class="ttname"><a href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">marked_graph_compressed::star_vertices</a></div><div class="ttdeci">pair&lt; vector&lt; int &gt;, mpz_class &gt; star_vertices</div><div class="ttdoc">the compressed form of the star_vertices list </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:25</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a86b00223525703e973415cbc9c94da68"><div class="ttname"><a href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">marked_graph_compressed::type_mark</a></div><div class="ttdeci">vector&lt; int &gt; type_mark</div><div class="ttdoc">for an edge type t, type_mark[t] denotes the mark component of t </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:28</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a8b2aaac68e9332ddc78d88eb60b323a7"><div class="ttname"><a href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">marked_graph_compressed::delta</a></div><div class="ttdeci">int delta</div><div class="ttdoc">the degree threshold used when compression was performed </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:24</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af6ff623407b673d08d0cab77b39c2193"><div class="ttname"><a href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">marked_graph_compressed::h</a></div><div class="ttdeci">int h</div><div class="ttdoc">the depth up to which the compression was performed </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:23</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a8d841016ddb11cfd33748c8deb6277ba"><div class="ttname"><a href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">marked_graph_compressed::n</a></div><div class="ttdeci">int n</div><div class="ttdoc">the number of vertices </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:22</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_ae179a4737e6eab905c18a94d44ef64b7"><div class="ttname"><a href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">marked_graph_compressed::part_graph</a></div><div class="ttdeci">map&lt; int, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt; part_graph</div><div class="ttdoc">compressed form of partition graphs corresponding to colors in . For a half edge type t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:37</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a01c67fe4234738db6bb60459515c3ad8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01c67fe4234738db6bb60459515c3ad8">&#9670;&nbsp;</a></span>binary_read() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::binary_read </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>read the compressed data from a binary file </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>string containing the name of the binary file </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                                                 {</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <a class="code" href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a>++;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af58307bfadcaa4c3ca6dd594c2f9b3a9">clear</a>(); <span class="comment">// to make sure nothing is stored inside me before reading</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <a class="code" href="classibitstream.html">ibitstream</a> inp(s);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <span class="comment">// ==== read n, h, delta</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> int_in; <span class="comment">// auxiliary input integer</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  inp &gt;&gt; int_in; </div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a> = int_in; <span class="comment">// I need to do this, since ibitstream::operator &gt;&gt; gets unsigned int&amp; and the compile can not cast int&amp; to unsigned int&amp;</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a> = int_in;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;delta&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a> = int_in;</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">//fread(&amp;n, sizeof n, 1, f);</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;  <span class="comment">//fread(&amp;h, sizeof h, 1, f);</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  <span class="comment">//fread(&amp;delta, sizeof delta, 1, f);</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;type_mark&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <span class="comment">// ===== read type_mark</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="comment">// read number of types</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">//fread(&amp;int_in, sizeof int_in, 1, f);</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.resize(int_in);</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.size();i++){</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    inp &gt;&gt; int_in;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>[i] = int_in;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="comment">//fread(&amp;int_in, sizeof int_in, 1, f);</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="comment">//type_mark[i] = int_in;</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;  }</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;star vertices&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;  <span class="comment">// ==== read star_vertices</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="comment">// first, read the frequency.</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first = vector&lt;int&gt;(2); <span class="comment">// frequency,</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;  <span class="comment">// we read its first index which is number of zeros, and the second is n - the first.</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="comment">//fread(&amp;int_in, sizeof int_in, 1, f);</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[0] = int_in;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[1] = <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a> - int_in;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;  <span class="comment">// the integer representation which is star_vertices.second</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;  inp &gt;&gt; <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.second;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  <span class="comment">//mpz_inp_raw(star_vertices.second.get_mpz_t(), f);</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;star edges&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;  <span class="comment">// ==== read star_edges</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="comment">//int log2n = 0; // the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log_2 n), which is the number of bits to encode vertices</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  <span class="comment">//int n_copy = n;</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;  <span class="comment">//while(n_copy &gt; 0){</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;  <span class="comment">//n_copy &gt;&gt;= 1;</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <span class="comment">//log2n ++;</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="comment">//}</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="comment">//bitset&lt;8*sizeof(int)&gt; B; // a bit stream with maximum length of int to store a vertex index</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;  <span class="comment">//string s;</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <span class="comment">//stringstream ss;</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  <span class="comment">//int sp; // the index of the string s we are studying </span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="comment">// read the size of star_edges</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> star_edges_size;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  inp &gt;&gt; star_edges_size;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;  <span class="comment">//cerr &lt;&lt; &quot; star edges size &quot; &lt;&lt; star_edges_size &lt;&lt; endl;</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="comment">//fread(&amp;star_edges_size, sizeof star_edges_size, 1, f);</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> x, xp; <span class="comment">// edge marks</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;  <span class="keywordtype">int</span> nu_star_vertices = <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[1];</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_nsv = <a class="code" href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a>(nu_star_vertices-1); <span class="comment">// defined to chose compression method, see below</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_nb_nsv = <a class="code" href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a>(nb_nsv); <span class="comment">// defined to chose compression method, see below</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff_threshold = nb_nsv - nb_nb_nsv;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_diff; <span class="comment">// number of bits in diff</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  vector&lt;vector&lt;int&gt; &gt; V; <span class="comment">// the list of star edges corresponding to each mark pair</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  V.resize(nu_star_vertices);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_bits = <a class="code" href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a>(<a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>); <span class="comment">// the number of bits in n, i.e. \f$1 + \lfloor \log_2 n \rfloor\f$</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff; <span class="comment">// to decode differences between star vertex indices in star edges</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;star_edges_size;i++){</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    inp &gt;&gt; x;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    inp &gt;&gt; xp;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    <span class="comment">//cerr &lt;&lt; &quot; x  &quot; &lt;&lt; x &lt;&lt; &quot; xp &quot; &lt;&lt; xp &lt;&lt; &quot; i = &quot; &lt;&lt; i &lt;&lt; endl; </span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="comment">//fread(&amp;x, sizeof x, 1, f);</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="comment">//fread(&amp;xp, sizeof xp, 1, f);</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  </div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;    <span class="comment">//s = bit_string_read(f);</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="comment">//cerr &lt;&lt; &quot; read  x &quot; &lt;&lt; x &lt;&lt; &quot; xp &quot; &lt;&lt; xp &lt;&lt; &quot; s &quot; &lt;&lt; s &lt;&lt; endl;</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;    <span class="comment">//sp = 0; // starting from zero </span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;nu_star_vertices; j++){ <span class="comment">// </span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      V[j].clear(); <span class="comment">// make it fresh</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;      <span class="comment">//inp.bin_inter_decode(V[j], n_bits); // use binary interpolative decoding</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="comment">//cerr &lt;&lt; &quot;  jth star vertex j = &quot; &lt;&lt; j&lt;&lt; endl; </span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;      inp &gt;&gt; int_in; <span class="comment">// the number of star edges connected to jth star vertex</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      <span class="comment">//cerr &lt;&lt; &quot; number of star edges &quot; &lt;&lt; int_in &lt;&lt; endl;</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;int_in; k++){</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="comment">// read diff</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot; k &quot; &lt;&lt; k &lt;&lt; endl;</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">if</span> (inp.read_bit()){ <span class="comment">// the flag bit is one, we have used the first method </span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;          nb_diff = inp.read_bits(nb_nb_nsv);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          diff = 0; <span class="comment">// initialize</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          <span class="keywordflow">if</span> (nb_diff &gt; 1) <span class="comment">// otherwise, reading zero bits is as iff diff = 0 (before adding the leading one) this is important when real diff is 1</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            diff = inp.read_bits(nb_diff-1);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          diff += (1&lt;&lt;(nb_diff-1)); <span class="comment">// bring the lading bit in diff back </span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        }<span class="keywordflow">else</span>{ <span class="comment">// use the second method to read diff</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          diff = inp.read_bits(nb_nsv);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="comment">//if (int_in &lt; 100)</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="comment">//  cerr &lt;&lt; diff &lt;&lt; &quot; &quot;;</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot; diff &quot; &lt;&lt; diff &lt;&lt; endl;</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="keywordflow">if</span>(k==0)</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;          V[j].push_back(j+diff);</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          V[j].push_back(V[j][k-1]+diff);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="comment">//if (int_in &lt; 100)</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="comment">//  cerr &lt;&lt; endl;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.insert(pair&lt; pair&lt;int, int&gt; , vector&lt;vector&lt;int&gt; &gt; &gt; (pair&lt;int, int&gt;(x, xp), V));</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;  }</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;vertex types&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="comment">// ==== read vertex_types</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af29f16cbd56583652118eb24a7c233b7">vtype_list_read</a>(inp);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">// // read ver_type_list</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="comment">// inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="comment">// //fread(&amp;int_in, sizeof int_in, 1, f); // size of ver_type_list</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="comment">// ver_type_list.resize(int_in);</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  <span class="comment">// for (int i=0; i&lt;ver_type_list.size();i++){</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  <span class="comment">//   inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <span class="comment">//   //fread(&amp;int_in, sizeof int_in, 1, f); // size of ver_type_list[i]</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <span class="comment">//   ver_type_list[i].resize(int_in);</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="comment">//   inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;  <span class="comment">//   ver_type_list[i][0] = int_in; // read the vertex mark part</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <span class="comment">//   for (int j=0;j&lt;((ver_type_list[i].size()-1)/3); j++){</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">//     // the triple is 3j+1, 3j+2, 3j+3</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="comment">//     if (j==0){</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <span class="comment">//       // the first chunk is written of the form t,t&#39;,n-1. The reason we write n-1 is because we know n &gt; 0, so it is better to save some bits!</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <span class="comment">//       inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <span class="comment">//       ver_type_list[i][3*j+1] = int_in;</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <span class="comment">//       inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;  <span class="comment">//       ver_type_list[i][3*j+2] = int_in;</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;  <span class="comment">//       inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;  <span class="comment">//       ver_type_list[i][3*j+3] = int_in + 1; // since we had subtracted one during compression</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;  <span class="comment">//     }else{</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;  <span class="comment">//       // we know that the list is lexicographically ordered, so the t here is not less than the t is the previous chunk, so better to write their difference</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <span class="comment">//       inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  <span class="comment">//       ver_type_list[i][3*j+1] = int_in + ver_type_list[i][3*(j-1)+1]; // since we had encoded the difference during the compression phasen</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">//       // if t_here is equal to t_previous, then t&#39;_here &gt;= t&#39;_previous, so better to encode their difference!</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;  <span class="comment">//       if (ver_type_list[i][3*j+1] == ver_type_list[i][3*(j-1)+1]){</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">//         inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;  <span class="comment">//         ver_type_list[i][3*j+2] = int_in + ver_type_list[i][3*(j-1)+2];</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;  <span class="comment">//       }else{</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <span class="comment">//         // otherwise, just write t&#39;_here</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;  <span class="comment">//         inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <span class="comment">//         ver_type_list[i][3*j+2] = int_in;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  <span class="comment">//       }</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="comment">//       inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="comment">//       ver_type_list[i][3*j+3]= int_in + 1; // since we had subtracted one during compression</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;  <span class="comment">//     }</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;  <span class="comment">//   }</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;  <span class="comment">//   /* the old way of reading the list</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">//   for (int j=0;j&lt;ver_type_list[i].size();j++){</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <span class="comment">//     //fread(&amp;int_in, sizeof int_in, 1, f);</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;  <span class="comment">//     inp &gt;&gt; int_in;</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="comment">//     if (j%3 == 0 and j &gt; 0) // we know that the cont part is positive, so no need to add one during compression. So during compression, we subtract one to make it nonnegative</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="comment">//       int_in ++;</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="comment">//     ver_type_list[i][j] = int_in;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;  <span class="comment">//   }</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="comment">//   */</span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="comment">// ver_types</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;  <span class="comment">// ver_types.first</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;  <span class="comment">// ver_types.first.size()</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="comment">//fread(&amp;int_in, sizeof int_in, 1, f);</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first.resize(int_in);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first.size();i++){</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">//fread(&amp;int_in, sizeof int_in, 1, f);</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    inp &gt;&gt; int_in;</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first[i] = int_in;<span class="comment">// = int_in;</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;  <span class="comment">// ver_types.second</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;  inp &gt;&gt; <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.second;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <span class="comment">//mpz_inp_raw(ver_types.second.get_mpz_t(), f);</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;partition bipartite graphs&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;  <span class="comment">// === part bgraphs</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> part_bgraph_size;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> t, tp;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  pair&lt;int, int&gt; type; </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  mpz_class part_g;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  inp &gt;&gt; part_bgraph_size;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;  <span class="comment">//fread(&amp;part_bgraph_size, sizeof part_bgraph_size, 1, f);</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;part_bgraph_size;i++){</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="comment">// read t, t&#39;</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    inp &gt;&gt; t;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    inp &gt;&gt; tp;</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="comment">//fread(&amp;t, sizeof t, 1, f);</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="comment">//fread(&amp;tp, sizeof tp, 1, f);</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    type = pair&lt;int, int&gt;(t, tp);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    inp &gt;&gt; part_g;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    <span class="comment">//mpz_inp_raw(part_g.get_mpz_t(), f);</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.insert(pair&lt;pair&lt;int, int&gt;, mpz_class&gt; (type, part_g));</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  }</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;partition graphs&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  <span class="comment">// === part graphs</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="comment">// first, the size</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> part_graph_size;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v_size;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  vector&lt;int&gt; W; </div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  inp &gt;&gt; part_graph_size;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <span class="comment">//fread(&amp;part_graph_size, sizeof part_graph_size, 1, f);</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;part_graph_size; i++){</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="comment">// first, the type</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    inp &gt;&gt; t; </div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">//fread(&amp;t, sizeof t, 1, f);</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="comment">// then, the mpz part</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    inp &gt;&gt; part_g;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    <span class="comment">//mpz_inp_raw(part_g.get_mpz_t(), f);</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    <span class="comment">// then, the vector size</span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    inp &gt;&gt; v_size;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="comment">//fread(&amp;v_size, sizeof v_size, 1, f);</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    W.resize(v_size);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;v_size; j++){</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="comment">//fread(&amp;int_in, sizeof int_in, 1, f);</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      inp &gt;&gt; int_in;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      W[j] = int_in; <span class="comment">//= int_in;</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.insert(pair&lt;<span class="keywordtype">int</span>, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt;(t, pair&lt;mpz_class, vector&lt;int&gt; &gt;(part_g, W)));</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  }</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  inp.close();</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  <a class="code" href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a>--;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af446cc5e23c241a92b76642fd5ebc403"><div class="ttname"><a href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">marked_graph_compressed::ver_types</a></div><div class="ttdeci">pair&lt; vector&lt; int &gt;, mpz_class &gt; ver_types</div><div class="ttdoc">the compressed form of vertex types, where the type of a vertex is the index with respect to ver_type...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:33</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7df5779d313486644132bd816937f532"><div class="ttname"><a href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">marked_graph_compressed::star_edges</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, vector&lt; vector&lt; int &gt; &gt; &gt; star_edges</div><div class="ttdoc">for each pair of edge marks x,x&amp;#39;, and integer , star_edges[pair&lt;int,int&gt;(x,x&amp;#39;)][k] is a list of neigh...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:26</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7b3267063fba30b45eb21b3ba4e07536"><div class="ttname"><a href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">marked_graph_compressed::part_bgraph</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, mpz_class &gt; part_bgraph</div><div class="ttdoc">compressed form of partition bipartite graphs corresponding to colors in . For a pair  of half edge t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:35</div></div>
<div class="ttc" id="classlogger_html_a710163deb17bc81f70d53d285b8ac9ac"><div class="ttname"><a href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a></div><div class="ttdeci">static void add_entry(string name, string description)</div><div class="ttdef"><b>Definition:</b> logger.cpp:25</div></div>
<div class="ttc" id="classlogger_html_a9d29b49bd318a719a8e85b59eac54fe0"><div class="ttname"><a href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a></div><div class="ttdeci">static int current_depth</div><div class="ttdef"><b>Definition:</b> logger.h:33</div></div>
<div class="ttc" id="classibitstream_html"><div class="ttname"><a href="classibitstream.html">ibitstream</a></div><div class="ttdoc">deals with reading bit streams from binary files, this is the reverse of obitstream ...</div><div class="ttdef"><b>Definition:</b> bitstream.h:118</div></div>
<div class="ttc" id="bitstream_8cpp_html_a9dfce6f51e3febb3973aa3b16c2fecb4"><div class="ttname"><a href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a></div><div class="ttdeci">unsigned int nu_bits(unsigned int n)</div><div class="ttdoc">returns number of bits in a positive integer n, e.g. 3 has 3 bits, 12 has 4 bits, and 0 has 0 bits...</div><div class="ttdef"><b>Definition:</b> bitstream.cpp:635</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af58307bfadcaa4c3ca6dd594c2f9b3a9"><div class="ttname"><a href="classmarked__graph__compressed.html#af58307bfadcaa4c3ca6dd594c2f9b3a9">marked_graph_compressed::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.cpp:8</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7a4ced4586e2e353f9076bd447df5208"><div class="ttname"><a href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">marked_graph_compressed::star_vertices</a></div><div class="ttdeci">pair&lt; vector&lt; int &gt;, mpz_class &gt; star_vertices</div><div class="ttdoc">the compressed form of the star_vertices list </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:25</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a86b00223525703e973415cbc9c94da68"><div class="ttname"><a href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">marked_graph_compressed::type_mark</a></div><div class="ttdeci">vector&lt; int &gt; type_mark</div><div class="ttdoc">for an edge type t, type_mark[t] denotes the mark component of t </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:28</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a8b2aaac68e9332ddc78d88eb60b323a7"><div class="ttname"><a href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">marked_graph_compressed::delta</a></div><div class="ttdeci">int delta</div><div class="ttdoc">the degree threshold used when compression was performed </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:24</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af6ff623407b673d08d0cab77b39c2193"><div class="ttname"><a href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">marked_graph_compressed::h</a></div><div class="ttdeci">int h</div><div class="ttdoc">the depth up to which the compression was performed </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:23</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af29f16cbd56583652118eb24a7c233b7"><div class="ttname"><a href="classmarked__graph__compressed.html#af29f16cbd56583652118eb24a7c233b7">marked_graph_compressed::vtype_list_read</a></div><div class="ttdeci">void vtype_list_read(ibitstream &amp;inp)</div><div class="ttdoc">reads the ver_type_list array from the input, assuming the bit sequence was generated during compress...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.cpp:1149</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a8d841016ddb11cfd33748c8deb6277ba"><div class="ttname"><a href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">marked_graph_compressed::n</a></div><div class="ttdeci">int n</div><div class="ttdoc">the number of vertices </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:22</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_ae179a4737e6eab905c18a94d44ef64b7"><div class="ttname"><a href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">marked_graph_compressed::part_graph</a></div><div class="ttdeci">map&lt; int, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt; part_graph</div><div class="ttdoc">compressed form of partition graphs corresponding to colors in . For a half edge type t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:37</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab9cdb7fc43badd58fb5202f74ffac723"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9cdb7fc43badd58fb5202f74ffac723">&#9670;&nbsp;</a></span>binary_write() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::binary_write </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>writes the compressed data to a binary file </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f</td><td>a <code>FILE*</code> object which is the address of the binary file to write </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                                                 {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  vector&lt;pair&lt;string, int&gt; &gt; space_log; <span class="comment">// stores the number of bits used to store each category. The string part is description of the category, and the int part is the number of bits of output used to express that part.</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keywordtype">int</span> output_bits; <span class="comment">// the number of bits in the output corresponding to the current category under investigation, to be zeroed at each step.</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;  <a class="code" href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a>++;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="comment">// ==== write n, h, delta</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  output_bits = 0;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  fwrite(&amp;<a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>, <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>, 1, f);</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  output_bits += <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  fwrite(&amp;<a class="code" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a>, <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a>, 1, f);</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  output_bits += <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;delta&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  fwrite(&amp;<a class="code" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a>, <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a>, 1, f);</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  output_bits += <span class="keyword">sizeof</span> <a class="code" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;n, h, delta&quot;</span>, output_bits));</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;type_mark&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  output_bits = 0;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">int</span> int_out; <span class="comment">// auxiliary variable, an integer value to be written to output</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">// ==== write type_mark</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">// first, the number of types</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  int_out = <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.size();</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">// then, marks one by one</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.size();i++){</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    int_out = <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>[i];</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  space_log.push_back(pair&lt;string, int&gt;(<span class="stringliteral">&quot;type mark&quot;</span>, output_bits));</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;star_vertices&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  output_bits = 0;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="comment">// ==== write star vertices</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="comment">// first, write the frequency, note that star_vertices.first is a vector of size 2 with the first entry being the number of zeros, and the second one the number of ones, so it enough to write only one of them</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  int_out = <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[0];</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="comment">// then, we write the integer representation star_vertices.second</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  output_bits +=  mpz_out_raw(f, <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.second.get_mpz_t()); <span class="comment">// mpz_out_raw returns the number of bytes written to the output</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;star vertices&quot;</span>, output_bits));</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;star_edges&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">// ==== write star edges</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  output_bits = 0;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordtype">int</span> log2n = 0; <span class="comment">// the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log_2 n), which is the number of bits to encode vertices</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordtype">int</span> n_copy = <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">while</span>(n_copy &gt; 0){</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    n_copy &gt;&gt;= 1;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    log2n ++;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  }</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="comment">//cerr &lt;&lt; &quot; log2n &quot; &lt;&lt; log2n &lt;&lt; endl;</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  bitset&lt;8*sizeof(int)&gt; B; <span class="comment">// a bit stream with maximum length of int to store a vertex index</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  map&lt;pair&lt;int, int&gt;, vector&lt;vector&lt;int&gt; &gt; &gt;::iterator it;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keywordtype">int</span> x, xp;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">string</span> s; <span class="comment">// the bit stream</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="comment">// first, write the size of star_edges so that the decoder knows how many blocks are coming</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  int_out = <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.size();</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">int</span> nu_star_edges = 0; <span class="comment">// number of star edges </span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordflow">for</span> (it = <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.begin(); it!= <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.end(); it++){</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    x = it-&gt;first.first;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    xp = it-&gt;first.second;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="comment">//write x and xp</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    fwrite(&amp;x, <span class="keyword">sizeof</span> x, 1, f);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    fwrite(&amp;xp, <span class="keyword">sizeof</span> xp, 1, f);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    output_bits += <span class="keyword">sizeof</span> x;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    output_bits += <span class="keyword">sizeof</span> xp;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;it-&gt;second.size();i++){</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;it-&gt;second[i].size();j++){</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        s += <span class="stringliteral">&quot;1&quot;</span>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        B = it-&gt;second[i][j]; <span class="comment">// convert the index of the other endpoint to binary</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        s += B.to_string().substr(8*<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) - log2n, log2n); <span class="comment">// take only log2n many bits of the representation (and this should be taken from the least significant bits)</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        nu_star_edges ++;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      }</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      s += <span class="stringliteral">&quot;0&quot;</span>; <span class="comment">// to indicate that the neighbor list of this vertex is over now</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    }</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="comment">//cerr &lt;&lt; &quot; write  x &quot; &lt;&lt; x &lt;&lt; &quot; xp &quot; &lt;&lt; xp &lt;&lt; &quot; s &quot; &lt;&lt; s &lt;&lt; endl;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">//for (int i=0;i&lt;it-&gt;second.size();i++){</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="comment">//  for (int j=0;j&lt;it-&gt;second[i].size();j++){</span></div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">//    cerr &lt;&lt; &quot; , &quot; &lt;&lt; it-&gt;second[i][j];</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="comment">//  }</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">//  cerr &lt;&lt; endl;</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="comment">//}</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    output_bits += <a class="code" href="compression__helper_8cpp.html#a9a2fbdf1fe0e38f631e7e242a819883b">bit_string_write</a>(f, s); <span class="comment">// write this bitstream to the output</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;star edges&quot;</span>, output_bits));</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;vertex types&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  output_bits = 0;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// ==== write vertex types</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="comment">// first, we need vertex types list (ver_type_list)</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="comment">// size of ver_type_list</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  int_out = <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.size();</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.size();i++){</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    int_out = <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size();</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size();j++){</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      int_out = <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][j];</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  }</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  space_log.push_back(pair&lt;string, int&gt;(<span class="stringliteral">&quot;vertex type list&quot;</span>, output_bits));</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  output_bits = 0;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  </div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// then, write ver_types</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// ver_types.first</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// ver_types.first.size():</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  int_out = <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first.size();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;<a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first.size(); i++){</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    int_out = <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first[i];</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">// ver_types.second</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  output_bits += mpz_out_raw(f, <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.second.get_mpz_t());</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;vertex types&quot;</span>, output_bits));</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;partition bipartite graphs&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  </div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// ==== part bgraphs</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  output_bits = 0;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="comment">// part_bgraphs.size</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  int_out = <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.size();</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  map&lt;pair&lt;int, int&gt;, mpz_class&gt;::iterator it2;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlogger.html#a26812b5ba03f130e8dae3446d5fc032f">logger::stat</a>){</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; ==== statistics ==== &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; n:                &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a> &lt;&lt; endl;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; h:                &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a> &lt;&lt; endl;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; delta:            &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a> &lt;&lt; endl;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. edge types    &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. vertex types  &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. * vertices    &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a> - <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[0] &lt;&lt; endl;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. * edges       &quot;</span> &lt;&lt; nu_star_edges &lt;&lt; endl;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. part bgraphs  &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. part graphs   &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordflow">for</span> (it2 = <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.begin(); it2 != <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.end(); it2++){</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// first, write t, t&#39;</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    int_out = it2-&gt;first.first;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    int_out = it2-&gt;first.second;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// then, the compressed integer</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    output_bits += mpz_out_raw(f, it2-&gt;second.get_mpz_t());</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;partition bipartite graphs&quot;</span>, output_bits));</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;partition graphs&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  output_bits = 0;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="comment">// === part graphs</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// part_graph.size</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  int_out = <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.size();</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  map&lt; int, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt;::iterator it3;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keywordflow">for</span> (it3 = <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.begin(); it3 != <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.end(); it3++){</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    int_out = it3-&gt;first; <span class="comment">// the type</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// the mpz part</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    output_bits += mpz_out_raw(f, it3-&gt;second.first.get_mpz_t());</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="comment">// the vector part</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// first its size</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    int_out = it3-&gt;second.second.size();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// then element by element</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;it3-&gt;second.second.size();j++){</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      int_out = it3-&gt;second.second[j];</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      fwrite(&amp;int_out, <span class="keyword">sizeof</span> int_out, 1, f);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      output_bits += <span class="keyword">sizeof</span> int_out;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  space_log.push_back(pair&lt;string, int&gt;(<span class="stringliteral">&quot;partition graphs&quot;</span>, output_bits));</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlogger.html#a26812b5ba03f130e8dae3446d5fc032f">logger::stat</a>){</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; endl &lt;&lt; endl;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; Number of bytes used for each part &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; ---------------------------------- &quot;</span> &lt;&lt; endl &lt;&lt; endl;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keywordtype">int</span> total_bytes = 0;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; space_log.size(); i++)</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      total_bytes += space_log[i].second;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; space_log.size(); i++){</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;      *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; space_log[i].first &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span>  &lt;&lt; space_log[i].second &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; float(100) * float(space_log[i].second) / float(total_bytes) &lt;&lt; <span class="stringliteral">&quot; % &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; Total number of bytes wrote to the output = &quot;</span> &lt;&lt; total_bytes &lt;&lt; endl;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  }</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a>--;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af446cc5e23c241a92b76642fd5ebc403"><div class="ttname"><a href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">marked_graph_compressed::ver_types</a></div><div class="ttdeci">pair&lt; vector&lt; int &gt;, mpz_class &gt; ver_types</div><div class="ttdoc">the compressed form of vertex types, where the type of a vertex is the index with respect to ver_type...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:33</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7df5779d313486644132bd816937f532"><div class="ttname"><a href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">marked_graph_compressed::star_edges</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, vector&lt; vector&lt; int &gt; &gt; &gt; star_edges</div><div class="ttdoc">for each pair of edge marks x,x&amp;#39;, and integer , star_edges[pair&lt;int,int&gt;(x,x&amp;#39;)][k] is a list of neigh...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:26</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7b3267063fba30b45eb21b3ba4e07536"><div class="ttname"><a href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">marked_graph_compressed::part_bgraph</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, mpz_class &gt; part_bgraph</div><div class="ttdoc">compressed form of partition bipartite graphs corresponding to colors in . For a pair  of half edge t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:35</div></div>
<div class="ttc" id="classlogger_html_a710163deb17bc81f70d53d285b8ac9ac"><div class="ttname"><a href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a></div><div class="ttdeci">static void add_entry(string name, string description)</div><div class="ttdef"><b>Definition:</b> logger.cpp:25</div></div>
<div class="ttc" id="classlogger_html_a9d29b49bd318a719a8e85b59eac54fe0"><div class="ttname"><a href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a></div><div class="ttdeci">static int current_depth</div><div class="ttdef"><b>Definition:</b> logger.h:33</div></div>
<div class="ttc" id="compression__helper_8cpp_html_a9a2fbdf1fe0e38f631e7e242a819883b"><div class="ttname"><a href="compression__helper_8cpp.html#a9a2fbdf1fe0e38f631e7e242a819883b">bit_string_write</a></div><div class="ttdeci">int bit_string_write(FILE *f, const string &amp;s)</div><div class="ttdoc">Write a string containing 0 and 1 to a binary file, treating the string as a bit sequence. Returns the number of bytes written to the output. </div><div class="ttdef"><b>Definition:</b> compression_helper.cpp:350</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7a4ced4586e2e353f9076bd447df5208"><div class="ttname"><a href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">marked_graph_compressed::star_vertices</a></div><div class="ttdeci">pair&lt; vector&lt; int &gt;, mpz_class &gt; star_vertices</div><div class="ttdoc">the compressed form of the star_vertices list </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:25</div></div>
<div class="ttc" id="classlogger_html_a7db37821f875f2ba3540980b355779f5"><div class="ttname"><a href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a></div><div class="ttdeci">static ostream * stat_stream</div><div class="ttdoc">the stream to report the statistics. Default is cout </div><div class="ttdef"><b>Definition:</b> logger.h:31</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a86b00223525703e973415cbc9c94da68"><div class="ttname"><a href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">marked_graph_compressed::type_mark</a></div><div class="ttdeci">vector&lt; int &gt; type_mark</div><div class="ttdoc">for an edge type t, type_mark[t] denotes the mark component of t </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:28</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a8b2aaac68e9332ddc78d88eb60b323a7"><div class="ttname"><a href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">marked_graph_compressed::delta</a></div><div class="ttdeci">int delta</div><div class="ttdoc">the degree threshold used when compression was performed </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:24</div></div>
<div class="ttc" id="classlogger_html_a26812b5ba03f130e8dae3446d5fc032f"><div class="ttname"><a href="classlogger.html#a26812b5ba03f130e8dae3446d5fc032f">logger::stat</a></div><div class="ttdeci">static bool stat</div><div class="ttdoc">if true, statistics will be displayed, e.g. number of star vertices / edges or the number of partitio...</div><div class="ttdef"><b>Definition:</b> logger.h:27</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af6ff623407b673d08d0cab77b39c2193"><div class="ttname"><a href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">marked_graph_compressed::h</a></div><div class="ttdeci">int h</div><div class="ttdoc">the depth up to which the compression was performed </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:23</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a8d841016ddb11cfd33748c8deb6277ba"><div class="ttname"><a href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">marked_graph_compressed::n</a></div><div class="ttdeci">int n</div><div class="ttdoc">the number of vertices </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:22</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_ae179a4737e6eab905c18a94d44ef64b7"><div class="ttname"><a href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">marked_graph_compressed::part_graph</a></div><div class="ttdeci">map&lt; int, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt; part_graph</div><div class="ttdoc">compressed form of partition graphs corresponding to colors in . For a half edge type t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:37</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a13ab09e4b399f179ec91746ae2b8b38c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13ab09e4b399f179ec91746ae2b8b38c">&#9670;&nbsp;</a></span>binary_write() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::binary_write </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>writes the compressed data to a binary file </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>string containing the name of the binary file </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                                  {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  </div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="classobitstream.html">obitstream</a> oup(s);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  vector&lt;pair&lt;string, int&gt; &gt; space_log; <span class="comment">// stores the number of bits used to store each category. The string part is description of the category, and the int part is the number of bits of output used to express that part.</span></div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="comment">//int output_bits; // the number of bits in the output corresponding to the current category under investigation, to be zeroed at each step.</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chunks = 0; <span class="comment">// number of chunks written to the output. Each chunk is sizeof(unsigned int) = 32 bits long</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> chunks_new =0; <span class="comment">// to take the difference in each step</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a>++;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="comment">// ==== write n, h, delta</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">//output_bits = 0;</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">n</a>; <span class="comment">//fwrite(&amp;n, sizeof n, 1, f);</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">//output_bits += sizeof n;</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;h&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">h</a>; <span class="comment">//fwrite(&amp;h, sizeof h, 1, f);</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">//output_bits += sizeof h;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;delta&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">delta</a>; <span class="comment">//fwrite(&amp;delta, sizeof delta, 1, f);</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="comment">//output_bits += sizeof delta;</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  chunks_new = oup.chunks();</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;n, h, delta&quot;</span>, chunks_new - chunks));</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  chunks = chunks_new;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;type_mark&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">//output_bits = 0;</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">int</span> int_out; <span class="comment">// auxiliary variable, an integer value to be written to output</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="comment">// ==== write type_mark</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">// first, the number of types</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  oup &lt;&lt;  <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.size();</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="comment">// then, marks one by one</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.size();i++){</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    oup &lt;&lt;  <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>[i];</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  }</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  chunks_new = oup.chunks();</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  space_log.push_back(pair&lt;string, int&gt;(<span class="stringliteral">&quot;type mark&quot;</span>, chunks_new - chunks));</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  chunks = chunks_new;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;star_vertices&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">//output_bits = 0;</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// ==== write star vertices</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// first, write the frequency, note that star_vertices.first is a vector of size 2 with the first entry being the number of zeros, and the second one the number of ones, so it enough to write only one of them</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[0];</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="comment">// then, we write the integer representation star_vertices.second</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.second;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="comment">//output_bits +=  mpz_out_raw(f, star_vertices.second.get_mpz_t()); // mpz_out_raw returns the number of bytes written to the output</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  chunks_new = oup.chunks();</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;star vertices&quot;</span>, chunks_new - chunks));</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  chunks = oup.chunks();</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;star_edges&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="comment">// ==== write star edges</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">//output_bits = 0;</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="comment">//int log2n = 0; // the ceiling of log (n+1) in base 2 (which is equal to 1 + the floor of log_2 n), which is the number of bits to encode vertices</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="comment">//int n_copy = n;</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <span class="comment">//while(n_copy &gt; 0){</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="comment">//n_copy &gt;&gt;= 1;</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">//log2n ++;</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">//}</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">//cerr &lt;&lt; &quot; log2n &quot; &lt;&lt; log2n &lt;&lt; endl;</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">//bitset&lt;8*sizeof(int)&gt; B; // a bit stream with maximum length of int to store a vertex index</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  map&lt;pair&lt;int, int&gt;, vector&lt;vector&lt;int&gt; &gt; &gt;::iterator it;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordtype">int</span> x, xp;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">//string s; // the bit stream</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// first, write the size of star_edges so that the decoder knows how many blocks are coming</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.size();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">//cerr &lt;&lt; &quot; star edges size &quot; &lt;&lt; star_edges.size() &lt;&lt; endl;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordtype">int</span> nu_star_edges = 0; <span class="comment">// number of star edges</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_bits = <a class="code" href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a>(n); <span class="comment">// the number of bits in n, i.e. \f$1 + \lfloor \log_2 n \rfloor\f$</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff; <span class="comment">// the difference for differential coding</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nu_star_vertices = n - <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[0]; <span class="comment">// number of star vertices</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_nsv = <a class="code" href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a>(nu_star_vertices-1); <span class="comment">// defined to chose compression method, see below </span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_nb_nsv = <a class="code" href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a>(nb_nsv); <span class="comment">// defined to chose compression method, see below </span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> diff_threshold = nb_nsv - nb_nb_nsv;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nb_diff; <span class="comment">// number of bits in diff</span></div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  map&lt;int, int&gt; deg_map;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlogger.html#a26812b5ba03f130e8dae3446d5fc032f">logger::stat</a>){</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; * degree stat: &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; -------------- &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  }</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="keywordflow">for</span> (it = <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.begin(); it!= <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.end(); it++){</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    x = it-&gt;first.first;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    xp = it-&gt;first.second;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">//cerr &lt;&lt; &quot; x &quot; &lt;&lt; x &lt;&lt; &quot; xp &quot; &lt;&lt; xp &lt;&lt; endl;</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">//write x and xp</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    oup &lt;&lt; x;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    oup &lt;&lt; xp;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    deg_map.clear();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;it-&gt;second.size();i++){</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="comment">//cerr &lt;&lt; &quot; star vertex &quot; &lt;&lt; i &lt;&lt; endl;</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="comment">//oup.bin_inter_code(it-&gt;second[i], n_bits);</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      oup &lt;&lt; it-&gt;second[i].size(); <span class="comment">// how many star edges are going next</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      deg_map[it-&gt;second[i].size()] ++;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <span class="comment">//cout &lt;&lt; &quot; i &quot; &lt;&lt; i &lt;&lt; endl;</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;it-&gt;second[i].size();j++){</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        </div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="comment">//cout &lt;&lt; &quot; j &quot; &lt;&lt; j &lt;&lt; &quot; -&gt; &quot; &lt;&lt; it-&gt;second[i][j] &lt;&lt; endl;</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        <span class="keywordflow">if</span> (j==0)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;          diff = it-&gt;second[i][j] - i;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;          diff = it-&gt;second[i][j] - it-&gt;second[i][j-1];</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="comment">//if (it-&gt;second[i].size() &lt; 100)</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="comment">//  cerr &lt;&lt; diff &lt;&lt; &quot; &quot;;</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot; diff &quot; &lt;&lt; diff &lt;&lt; endl;</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="comment">// diff is bounded by the number of star vertices</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="comment">// we can either encode diff by a modification of Elias delta, using the extra assumption that 1 &lt;= diff &lt;= number of star vertices - 1</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">// number of star vertices = n - star_vertices.first[0] lets call it nu_star_vertices defined above before the loop</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">// with this extra assumption in Elias delta, we do not use the unary part of the code and store nu_bits(diff) </span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="comment">// using nu_bits(nu_bits(nu_star_vertices-1))</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="comment">// if we chose this method of compression, we use nu_bits(nu_bits(nu_star_vertices-1)) + nu_bits(diff)</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="comment">// if we only use diff &lt;= nu_star_vertices - 1, we spend nu_bits(nu_star_vertices-1) bits</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="comment">// so we should spend the first method iff we have nu_bits(nu_bits(nu_star_vertices-1)) + nu_bits(diff) &lt; nu_bits(nu_star_vertices-1)</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="comment">// or equivalently if nu_bits(diff) &lt; nu_bits(nu_star_vertices-1) - nu_bits(nu_bits(nu_star_vertices-1))</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="comment">// we define  nu_bits(nu_star_vertices-1) =: nb_nsv and nu_bits(nu_bits(nu_star_vertices-1)) =: nb_nb_nsv this is define above the loop</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">// we also have defined the difference above as diff_threshold to simplify</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        nb_diff = <a class="code" href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a>(diff);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span> (nb_diff &lt; diff_threshold){</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          <span class="comment">//if (it-&gt;second[i].size() &lt; 100)</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <span class="comment">//  cerr &lt;&lt; &quot; f &quot;;</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          <span class="comment">// we choose the first method</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;          <span class="comment">// we write a flag 1 upfront to tell decoder which method we use</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          oup.write_bits(1,1); <span class="comment">// write a single bit with value 1</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          oup.write_bits(nb_diff, nb_nb_nsv); <span class="comment">// write the number of bits in diff </span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          diff -= (1&lt;&lt;(nb_diff-1)); <span class="comment">// remove the leading (MSB) bit from diff</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          <span class="keywordflow">if</span> (nb_diff &gt; 1) <span class="comment">// otherwise, we do not need to write anything (note we remove leading one, so if diff = 1, we should not write anything at this stage)</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            oup.write_bits(diff, nb_diff-1); <span class="comment">// write diff to the output</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <span class="comment">//if (it-&gt;second[i].size() &lt; 100)</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;          <span class="comment">//  cerr &lt;&lt; &quot; s &quot;;</span></div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;          <span class="comment">// we should choose the second method</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;          <span class="comment">// write a flag 0 upfront</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          oup.write_bits(0,1);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;          oup.write_bits(diff, nb_nsv);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="comment">//if (it-&gt;second[i].size() &lt; 100)</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="comment">//  cerr &lt;&lt; endl;</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      nu_star_edges += it-&gt;second[i].size();</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;      </div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    }</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classlogger.html#a26812b5ba03f130e8dae3446d5fc032f">logger::stat</a>){</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot;mark pair: &quot;</span> &lt;&lt;  x &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; xp &lt;&lt; endl;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordflow">for</span> (map&lt;int, int&gt;::iterator deg_it = deg_map.begin(); deg_it != deg_map.end(); deg_it++){</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; d &quot;</span> &lt;&lt; deg_it-&gt;first &lt;&lt; <span class="stringliteral">&quot; # &quot;</span> &lt;&lt; deg_it-&gt;second;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      }</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; endl;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  chunks_new = oup.chunks();</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;star edges&quot;</span>, chunks_new - chunks));</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  chunks = oup.chunks();</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;vertex types&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  <span class="comment">//output_bits = 0;</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <span class="comment">// ==== write vertex types</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="comment">// first, we need vertex types list (ver_type_list)</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">// size of ver_type_list</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a889749dd51bc37917a156e337eac142a">vtype_list_write</a>(oup);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// oup &lt;&lt;  ver_type_list.size();</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="comment">// //fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="comment">// //output_bits += sizeof int_out;</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">// for (int i=0;i&lt;ver_type_list.size();i++){</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="comment">//   oup &lt;&lt; ver_type_list[i].size();</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <span class="comment">//   //fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;  <span class="comment">//   //output_bits += sizeof int_out;</span></div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="comment">//   oup &lt;&lt; ver_type_list[i][0]; // write the vertex mark</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="comment">//   // then, we know that the rest of the list is (t,t&#39;,n_{t,t&#39;)}) chunks, each of course with size 3</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="comment">//   for (int j=0;j&lt;((ver_type_list[i].size()-1)/3); j++){</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">//     // the triple is 3j+1, 3j+2, 3j+3</span></div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">//     if (j==0){</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">//       // the first chunk is written of the form t,t&#39;,n-1. The reason we write n-1 is because we know n &gt; 0, so it is better to save some bits!</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">//       oup &lt;&lt; ver_type_list[i][3*j+1];</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">//       oup &lt;&lt; ver_type_list[i][3*j+2];</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">//       oup &lt;&lt; ver_type_list[i][3*j+3]-1;</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">//     }else{</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">//       // we know that the list is lexicographically ordered, so the t here is not less than the t is the previous chunk, so better to write their difference</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="comment">//       oup &lt;&lt; ver_type_list[i][3*j+1] - ver_type_list[i][3*(j-1)+1];</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;  <span class="comment">//       // if t_here is equal to t_previous, then t&#39;_here &gt;= t&#39;_previous, so better to encode their difference!</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;  <span class="comment">//       if (ver_type_list[i][3*j+1] == ver_type_list[i][3*(j-1)+1]){</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">//         oup &lt;&lt; ver_type_list[i][3*j+2] - ver_type_list[i][3*(j-1)+2];</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <span class="comment">//       }else{</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  <span class="comment">//         // otherwise, just write t&#39;_here</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="comment">//         oup &lt;&lt; ver_type_list[i][3*j+2];</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="comment">//       }</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  <span class="comment">//       oup &lt;&lt; ver_type_list[i][3*j+3]-1;</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="comment">//     }</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">//   }</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="comment">//   /* the old way of writing the list:</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <span class="comment">//   for (int j=0;j&lt;ver_type_list[i].size();j++){</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="comment">//     if (j%3 == 0 and j &gt; 0) // we know that these indices are the count part (list is of the form \theta, t, t&#39;, n_{t,t&#39;}, \dots but the n_{t,t&#39;} \geq 1, so in Elias delta encoding of oup &lt;&lt; we do not need to add one. So it would be more efficient to subtract one here, and add one during decompression)</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="comment">//       oup &lt;&lt; ver_type_list[i][j]-1;</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">//     else</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <span class="comment">//       oup &lt;&lt; ver_type_list[i][j];</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="comment">//     //fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="comment">//     //output_bits += sizeof int_out;</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">//   }</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;  <span class="comment">//   */</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  chunks_new = oup.chunks();</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  space_log.push_back(pair&lt;string, int&gt;(<span class="stringliteral">&quot;vertex type list&quot;</span>, chunks_new - chunks));</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  chunks = chunks_new;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="comment">//output_bits = 0;</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;  <span class="comment">// then, write ver_types</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  <span class="comment">// ver_types.first</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="comment">// ver_types.first.size():</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first.size();</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i =0;i&lt;<a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first.size(); i++){</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    oup &lt;&lt;  <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.first[i];</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="comment">// ver_types.second</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">ver_types</a>.second;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="comment">//output_bits += mpz_out_raw(f, ver_types.second.get_mpz_t());</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  chunks_new = oup.chunks();</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;vertex types&quot;</span>, chunks_new - chunks));</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  chunks = chunks_new;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;partition bipartite graphs&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;  <span class="comment">// ==== part bgraphs</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  <span class="comment">//output_bits = 0;</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// part_bgraphs.size</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.size();</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  map&lt;pair&lt;int, int&gt;, mpz_class&gt;::iterator it2;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlogger.html#a26812b5ba03f130e8dae3446d5fc032f">logger::stat</a>){</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; ==== statistics ==== &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; n:                &quot;</span> &lt;&lt; n &lt;&lt; endl;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; h:                &quot;</span> &lt;&lt; h &lt;&lt; endl;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; delta:            &quot;</span> &lt;&lt; delta &lt;&lt; endl;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. types         &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. * vertices    &quot;</span> &lt;&lt; n - <a class="code" href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">star_vertices</a>.first[0] &lt;&lt; endl;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. * edges       &quot;</span> &lt;&lt; nu_star_edges &lt;&lt; endl;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. part bgraphs  &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; No. part graphs   &quot;</span> &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keywordflow">for</span> (it2 = <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.begin(); it2 != <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.end(); it2++){</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// first, write t, t&#39;</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    oup &lt;&lt; it2-&gt;first.first;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    oup &lt;&lt;  it2-&gt;first.second;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// then, the compressed integer</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    oup &lt;&lt; it2-&gt;second;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="comment">//output_bits += mpz_out_raw(f, it2-&gt;second.get_mpz_t());</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  chunks_new = oup.chunks();</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  space_log.push_back(pair&lt;string, int&gt; (<span class="stringliteral">&quot;partition bipartite graphs&quot;</span>, chunks_new - chunks));</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  chunks = chunks_new;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a>(<span class="stringliteral">&quot;partition graphs&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="comment">//output_bits = 0;</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  <span class="comment">// === part graphs</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="comment">// part_graph.size</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  oup &lt;&lt;  <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.size();</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;  map&lt; int, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt;::iterator it3;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordflow">for</span> (it3 = <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.begin(); it3 != <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.end(); it3++){</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    oup &lt;&lt;  it3-&gt;first; <span class="comment">// the type</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// the mpz part</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    oup &lt;&lt; it3-&gt;second.first;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="comment">//output_bits += mpz_out_raw(f, it3-&gt;second.first.get_mpz_t());</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <span class="comment">// the vector part</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <span class="comment">// first its size</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    oup &lt;&lt;  it3-&gt;second.second.size();</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="comment">// then element by element</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0;j&lt;it3-&gt;second.second.size();j++){</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      oup &lt;&lt;  it3-&gt;second.second[j];</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="comment">//fwrite(&amp;int_out, sizeof int_out, 1, f);</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="comment">//output_bits += sizeof int_out;</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    }</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  chunks_new = oup.chunks();</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  space_log.push_back(pair&lt;string, int&gt;(<span class="stringliteral">&quot;partition graphs&quot;</span>, chunks_new - chunks));</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  chunks = chunks_new;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classlogger.html#a26812b5ba03f130e8dae3446d5fc032f">logger::stat</a>){</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; endl &lt;&lt; endl;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; Number of bytes used for each part &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; ---------------------------------- &quot;</span> &lt;&lt; endl &lt;&lt; endl;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">int</span> total_chunks = 0;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; space_log.size(); i++)</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      total_chunks += space_log[i].second;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; space_log.size(); i++){</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="comment">// each chunks is 4 bytes. </span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; space_log[i].first &lt;&lt; <span class="stringliteral">&quot; -&gt; &quot;</span>  &lt;&lt; 4 * space_log[i].second &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; float(100) * float(space_log[i].second) / float(total_chunks) &lt;&lt; <span class="stringliteral">&quot; % &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    *<a class="code" href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a> &lt;&lt; <span class="stringliteral">&quot; Total number of bytes wrote to the output = &quot;</span> &lt;&lt; 4 * total_chunks &lt;&lt; endl;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  oup.close();</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a>--;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af446cc5e23c241a92b76642fd5ebc403"><div class="ttname"><a href="classmarked__graph__compressed.html#af446cc5e23c241a92b76642fd5ebc403">marked_graph_compressed::ver_types</a></div><div class="ttdeci">pair&lt; vector&lt; int &gt;, mpz_class &gt; ver_types</div><div class="ttdoc">the compressed form of vertex types, where the type of a vertex is the index with respect to ver_type...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:33</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7df5779d313486644132bd816937f532"><div class="ttname"><a href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">marked_graph_compressed::star_edges</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, vector&lt; vector&lt; int &gt; &gt; &gt; star_edges</div><div class="ttdoc">for each pair of edge marks x,x&amp;#39;, and integer , star_edges[pair&lt;int,int&gt;(x,x&amp;#39;)][k] is a list of neigh...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:26</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7b3267063fba30b45eb21b3ba4e07536"><div class="ttname"><a href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">marked_graph_compressed::part_bgraph</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, mpz_class &gt; part_bgraph</div><div class="ttdoc">compressed form of partition bipartite graphs corresponding to colors in . For a pair  of half edge t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:35</div></div>
<div class="ttc" id="classlogger_html_a710163deb17bc81f70d53d285b8ac9ac"><div class="ttname"><a href="classlogger.html#a710163deb17bc81f70d53d285b8ac9ac">logger::add_entry</a></div><div class="ttdeci">static void add_entry(string name, string description)</div><div class="ttdef"><b>Definition:</b> logger.cpp:25</div></div>
<div class="ttc" id="classlogger_html_a9d29b49bd318a719a8e85b59eac54fe0"><div class="ttname"><a href="classlogger.html#a9d29b49bd318a719a8e85b59eac54fe0">logger::current_depth</a></div><div class="ttdeci">static int current_depth</div><div class="ttdef"><b>Definition:</b> logger.h:33</div></div>
<div class="ttc" id="bitstream_8cpp_html_a9dfce6f51e3febb3973aa3b16c2fecb4"><div class="ttname"><a href="bitstream_8cpp.html#a9dfce6f51e3febb3973aa3b16c2fecb4">nu_bits</a></div><div class="ttdeci">unsigned int nu_bits(unsigned int n)</div><div class="ttdoc">returns number of bits in a positive integer n, e.g. 3 has 3 bits, 12 has 4 bits, and 0 has 0 bits...</div><div class="ttdef"><b>Definition:</b> bitstream.cpp:635</div></div>
<div class="ttc" id="classobitstream_html"><div class="ttname"><a href="classobitstream.html">obitstream</a></div><div class="ttdoc">handles writing bitstreams to binary files </div><div class="ttdef"><b>Definition:</b> bitstream.h:80</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7a4ced4586e2e353f9076bd447df5208"><div class="ttname"><a href="classmarked__graph__compressed.html#a7a4ced4586e2e353f9076bd447df5208">marked_graph_compressed::star_vertices</a></div><div class="ttdeci">pair&lt; vector&lt; int &gt;, mpz_class &gt; star_vertices</div><div class="ttdoc">the compressed form of the star_vertices list </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:25</div></div>
<div class="ttc" id="classlogger_html_a7db37821f875f2ba3540980b355779f5"><div class="ttname"><a href="classlogger.html#a7db37821f875f2ba3540980b355779f5">logger::stat_stream</a></div><div class="ttdeci">static ostream * stat_stream</div><div class="ttdoc">the stream to report the statistics. Default is cout </div><div class="ttdef"><b>Definition:</b> logger.h:31</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a86b00223525703e973415cbc9c94da68"><div class="ttname"><a href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">marked_graph_compressed::type_mark</a></div><div class="ttdeci">vector&lt; int &gt; type_mark</div><div class="ttdoc">for an edge type t, type_mark[t] denotes the mark component of t </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:28</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a8b2aaac68e9332ddc78d88eb60b323a7"><div class="ttname"><a href="classmarked__graph__compressed.html#a8b2aaac68e9332ddc78d88eb60b323a7">marked_graph_compressed::delta</a></div><div class="ttdeci">int delta</div><div class="ttdoc">the degree threshold used when compression was performed </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:24</div></div>
<div class="ttc" id="classlogger_html_a26812b5ba03f130e8dae3446d5fc032f"><div class="ttname"><a href="classlogger.html#a26812b5ba03f130e8dae3446d5fc032f">logger::stat</a></div><div class="ttdeci">static bool stat</div><div class="ttdoc">if true, statistics will be displayed, e.g. number of star vertices / edges or the number of partitio...</div><div class="ttdef"><b>Definition:</b> logger.h:27</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af6ff623407b673d08d0cab77b39c2193"><div class="ttname"><a href="classmarked__graph__compressed.html#af6ff623407b673d08d0cab77b39c2193">marked_graph_compressed::h</a></div><div class="ttdeci">int h</div><div class="ttdoc">the depth up to which the compression was performed </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:23</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a8d841016ddb11cfd33748c8deb6277ba"><div class="ttname"><a href="classmarked__graph__compressed.html#a8d841016ddb11cfd33748c8deb6277ba">marked_graph_compressed::n</a></div><div class="ttdeci">int n</div><div class="ttdoc">the number of vertices </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:22</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_ae179a4737e6eab905c18a94d44ef64b7"><div class="ttname"><a href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">marked_graph_compressed::part_graph</a></div><div class="ttdeci">map&lt; int, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt; part_graph</div><div class="ttdoc">compressed form of partition graphs corresponding to colors in . For a half edge type t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:37</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a889749dd51bc37917a156e337eac142a"><div class="ttname"><a href="classmarked__graph__compressed.html#a889749dd51bc37917a156e337eac142a">marked_graph_compressed::vtype_list_write</a></div><div class="ttdeci">void vtype_list_write(obitstream &amp;oup)</div><div class="ttdoc">writes the ver_type_list array to the output using difference coding, assuming that its entries are l...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.cpp:1049</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af58307bfadcaa4c3ca6dd594c2f9b3a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af58307bfadcaa4c3ca6dd594c2f9b3a9">&#9670;&nbsp;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;{</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">star_edges</a>.clear();</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">type_mark</a>.clear();</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.clear();</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">part_bgraph</a>.clear();</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">part_graph</a>.clear();</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_a7df5779d313486644132bd816937f532"><div class="ttname"><a href="classmarked__graph__compressed.html#a7df5779d313486644132bd816937f532">marked_graph_compressed::star_edges</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, vector&lt; vector&lt; int &gt; &gt; &gt; star_edges</div><div class="ttdoc">for each pair of edge marks x,x&amp;#39;, and integer , star_edges[pair&lt;int,int&gt;(x,x&amp;#39;)][k] is a list of neigh...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:26</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a7b3267063fba30b45eb21b3ba4e07536"><div class="ttname"><a href="classmarked__graph__compressed.html#a7b3267063fba30b45eb21b3ba4e07536">marked_graph_compressed::part_bgraph</a></div><div class="ttdeci">map&lt; pair&lt; int, int &gt;, mpz_class &gt; part_bgraph</div><div class="ttdoc">compressed form of partition bipartite graphs corresponding to colors in . For a pair  of half edge t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:35</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a86b00223525703e973415cbc9c94da68"><div class="ttname"><a href="classmarked__graph__compressed.html#a86b00223525703e973415cbc9c94da68">marked_graph_compressed::type_mark</a></div><div class="ttdeci">vector&lt; int &gt; type_mark</div><div class="ttdoc">for an edge type t, type_mark[t] denotes the mark component of t </div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:28</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_ae179a4737e6eab905c18a94d44ef64b7"><div class="ttname"><a href="classmarked__graph__compressed.html#ae179a4737e6eab905c18a94d44ef64b7">marked_graph_compressed::part_graph</a></div><div class="ttdeci">map&lt; int, pair&lt; mpz_class, vector&lt; int &gt; &gt; &gt; part_graph</div><div class="ttdoc">compressed form of partition graphs corresponding to colors in . For a half edge type t...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:37</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4bf8563a2dfd3038dc5833c014320487"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4bf8563a2dfd3038dc5833c014320487">&#9670;&nbsp;</a></span>vtype_block_read() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::vtype_block_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classibitstream.html">ibitstream</a> &amp;&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>reads a (t,t',n) block of a vertex type list element from input. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inp</td><td>the input bitstream used to read the encoded bit sequence </td></tr>
    <tr><td class="paramname">i</td><td>the index of ver_type_list member of this class which is going to be decoded </td></tr>
    <tr><td class="paramname">j</td><td>the index of the t,t',n block of ver_type_list[i] that is going to be decoded. Hence, the block is ver_type_list[i][1+3*j], ver_type_list[i][2+3*j], and ver_type_list[i][3+3*j] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                                                                           {</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> int_in;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][3*j+1] = int_in;</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][3*j+2] = int_in;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][3*j+3] = int_in + 1; <span class="comment">// since we had subtracted one during compression</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a01a434f3313d99b5877eddacb380cf15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01a434f3313d99b5877eddacb380cf15">&#9670;&nbsp;</a></span>vtype_block_read() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::vtype_block_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classibitstream.html">ibitstream</a> &amp;&#160;</td>
          <td class="paramname"><em>inp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>jr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>reads a (t,t',n) block of a vertex type list element with reference to another reference block. We assume that this block is lexicographically greater than the reference block, and this fact was used in the compression to encode the difference. The reference block must be prior to the current block so that it is already decoded and ready to be used as a reference. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inp</td><td>the input bitstream used to read the encoded bit sequence </td></tr>
    <tr><td class="paramname">i</td><td>the index of ver_type_list member of this class which is going to be decoded </td></tr>
    <tr><td class="paramname">j</td><td>the index of the t,t',n block of ver_type_list[i] that is going to be decoded. Hence, the block is ver_type_list[i][1+3*j], ver_type_list[i][2+3*j], and ver_type_list[i][3+3*j] </td></tr>
    <tr><td class="paramname">ir</td><td>the index of the ver_type_list used as the reference </td></tr>
    <tr><td class="paramname">jr</td><td>the index of the block in ver_type_list[ir] used as the reference. Hence, the reference block is ver_type_list[ir][1+3*jr], ver_type_list[ir][2+3*jr], and ver_type_list[ir][3+3*jr] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                                                                                           {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;  <span class="comment">// we use the following terminologies for comments:</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <span class="comment">// t = ver_type_list[i][3*j+1]</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="comment">// t&#39; = ver_type_int[i][3*j+2]</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;  <span class="comment">// n = ver_type_list[i][3*j+3]</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;  <span class="comment">// t_r = ver_type_list[ir][3*jr+1]</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;  <span class="comment">// t&#39;_r = ver_type_list[ir][3*jr+2]</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;  <span class="comment">// n_r = ver_type_list[ir][3*jr+3]</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> int_in;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][3*j+1] = int_in + <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[ir][3*jr+1]; <span class="comment">// since we had encoded the difference during the compression phasen</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;  <span class="comment">// if t = t_r, we have encoded t&#39; - t&#39;_r - 1</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <span class="keywordflow">if</span> (ver_type_list[i][3*j+1] == ver_type_list[ir][3*jr+1]){</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;    inp &gt;&gt; int_in;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    ver_type_list[i][3*j+2] = int_in + ver_type_list[ir][3*jr+2];</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    <span class="keywordflow">if</span> (ver_type_list[i][3*j+2] == ver_type_list[ir][3*jr+2]){</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      inp &gt;&gt; int_in; </div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      ver_type_list[i][3*j+3] = int_in +  ver_type_list[ir][3*jr+3];</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      inp &gt;&gt; int_in; </div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      ver_type_list[i][3*j+3] = int_in +  1;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    }</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;  }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="comment">// otherwise, we have just encoded t&#39;</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    inp &gt;&gt; int_in;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;    ver_type_list[i][3*j+2] = int_in;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;    inp &gt;&gt; int_in;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    ver_type_list[i][3*j+3]= int_in + 1; <span class="comment">// since we had subtracted one during compression</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  }</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a31f9ea72682f9072d0f90faf58a603fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31f9ea72682f9072d0f90faf58a603fe">&#9670;&nbsp;</a></span>vtype_block_write() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::vtype_block_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classobitstream.html">obitstream</a> &amp;&#160;</td>
          <td class="paramname"><em>oup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>writes a (t,t',n) block of a vertex type list element to the output. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">oup</td><td>the output bitstream used to output the encoded bit sequence </td></tr>
    <tr><td class="paramname">i</td><td>the index of ver_type_list member of this class which is going to be encoded </td></tr>
    <tr><td class="paramname">j</td><td>the index of the t,t',n block of ver_type_list[i] that is going to be encoded. Hence, the block is ver_type_list[i][1+3*j], ver_type_list[i][2+3*j], and ver_type_list[i][3+3*j] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;                                                                            {</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][3*j+1];</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  oup &lt;&lt; ver_type_list[i][3*j+2];</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;  oup &lt;&lt; ver_type_list[i][3*j+3]-1;</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad443f83015addcc0f2b0e35351ae9362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad443f83015addcc0f2b0e35351ae9362">&#9670;&nbsp;</a></span>vtype_block_write() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::vtype_block_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classobitstream.html">obitstream</a> &amp;&#160;</td>
          <td class="paramname"><em>oup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>jr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>writes a (t,t',n) block of a vertex type list element with reference to another reference block to the output. We assume that this block is lexicographically greater than the reference block, and use it to encode the difference to save space </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">oup</td><td>the output bitstream used to output the encoded bit sequence </td></tr>
    <tr><td class="paramname">i</td><td>the index of ver_type_list member of this class which is going to be encoded </td></tr>
    <tr><td class="paramname">j</td><td>the index of the t,t',n block of ver_type_list[i] that is going to be encoded. Hence, the block is ver_type_list[i][1+3*j], ver_type_list[i][2+3*j], and ver_type_list[i][3+3*j] </td></tr>
    <tr><td class="paramname">ir</td><td>the index of the ver_type_list used as the reference </td></tr>
    <tr><td class="paramname">jr</td><td>the index of the block in ver_type_list[ir] used as the reference. Hence, the reference block is ver_type_list[ir][1+3*jr], ver_type_list[ir][2+3*jr], and ver_type_list[ir][3+3*jr] </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;                                                                                            {</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;  <span class="comment">// we use the following terminologies for comments:</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">// t = ver_type_list[i][3*j+1]</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  <span class="comment">// t&#39; = ver_type_int[i][3*j+2]</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  <span class="comment">// n = ver_type_list[i][3*j+3]</span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;  <span class="comment">// t_r = ver_type_list[ir][3*jr+1]</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="comment">// t&#39;_r = ver_type_list[ir][3*jr+2]</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;  <span class="comment">// n_r = ver_type_list[ir][3*jr+3]</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="comment">//write the difference between the t parts, i.e. t - t_r</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  oup &lt;&lt; <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][3*j+1] - <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[ir][3*jr+1];</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;  <span class="comment">// check if the t part is the same, i.e. t = t_r</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <span class="keywordflow">if</span> (ver_type_list[i][3*j+1] == ver_type_list[ir][3*jr+1]){</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="comment">// encode the difference of the t&#39; part</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="comment">// but in this case, t&#39; &gt;= t&#39;_r, so write the difference</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    oup &lt;&lt; ver_type_list[i][3*j+2] - ver_type_list[ir][3*jr+2];</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;    <span class="comment">// for sanity check:</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="comment">// TO BE REMOVED LATER</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="comment">//if (ver_type_list[i][3*j+2] == ver_type_list[ir][3*jr+2])</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="comment">//cerr &lt;&lt; &quot; warning marked_graph_compressed::vtype_block_write : (t,t&#39;) = (t_r, t&#39;_r), (i,j) = &quot; &lt;&lt; i &lt;&lt; &quot;, &quot; &lt;&lt; j &lt;&lt; &quot;) and (ir, jr) = (&quot; &lt;&lt; ir &lt;&lt; &quot;, &quot; &lt;&lt; jr &lt;&lt; &quot;)&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    <span class="keywordflow">if</span> (ver_type_list[i][3*j+2] == ver_type_list[ir][3*jr+2]){</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;      oup &lt;&lt; ver_type_list[i][3*j+3] - ver_type_list[ir][3*jr+3];</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;      oup &lt;&lt; ver_type_list[i][3*j+3] - 1;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    }</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;  }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="comment">// just write t&#39;</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    oup &lt;&lt; ver_type_list[i][3*j+2];</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;    <span class="comment">// finally, write n - 1, note that n &gt; 0, so we encode n - 1 to save some space</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    oup &lt;&lt; ver_type_list[i][3*j+3] - 1;</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  }</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  </div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af29f16cbd56583652118eb24a7c233b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af29f16cbd56583652118eb24a7c233b7">&#9670;&nbsp;</a></span>vtype_list_read()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::vtype_list_read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classibitstream.html">ibitstream</a> &amp;&#160;</td>
          <td class="paramname"><em>inp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>reads the ver_type_list array from the input, assuming the bit sequence was generated during compression using vtype_list_write </p>
<div class="fragment"><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                                                            {</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="comment">// read vertex mark block counts</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  vector&lt;pair&lt;int, int&gt; &gt; ver_types_freq; <span class="comment">// each element (m,k) means that the ver mark m appears in k many vertex types</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="comment">//vector&lt;pair&lt;int, int&gt; &gt; ver_types_blocks; // the ith entry is (a,b), where a and b denote the range of indices in ith block. Note that the range is of the form [a,b)</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> int_in;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  inp &gt;&gt; int_in;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  ver_types_freq.resize(int_in);</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="keywordtype">int</span> total_types = 0; <span class="comment">// size of ver_type_int</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keywordtype">int</span> block_start = 0;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;ver_types_freq.size();i++){</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    inp &gt;&gt; int_in;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    ver_types_freq[i].first = int_in;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    inp &gt;&gt; int_in;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    ver_types_freq[i].second  = int_in + 1;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    total_types += ver_types_freq[i].second;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    <span class="comment">//ver_types_blocks.push_back(pair&lt;int,int&gt;(block_start, block_start+ver_types_freq[i].second));</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="comment">//block_start += ver_types_freq[i].second;</span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;  }</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="comment">// create ver_types_blocks</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.resize(total_types);</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <span class="keywordtype">int</span> block = 0; <span class="comment">// the block at which we are in terms of vertex mark</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <span class="keywordtype">int</span> count_in_block = 0; <span class="comment">// the index of me in the current blcok</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <span class="keywordtype">int</span> max_match; <span class="comment">// maximum match with the previous row</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <span class="keywordtype">int</span> total_chunks; </div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.size(); i++){</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordflow">if</span> (count_in_block == ver_types_freq[block].second){</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      block++;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;      count_in_block =0 ;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <span class="keywordflow">if</span> (count_in_block==0){</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      inp &gt;&gt; int_in; <span class="comment">// the number of chunks</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].resize(1+3*int_in);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][0] = ver_types_freq[block].first; <span class="comment">// fix the vertex mark</span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;int_in; j++){ <span class="comment">// read blocks one by one</span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">if</span> (j==0)</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;          <a class="code" href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">vtype_block_read</a>(inp, i, j);</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          <a class="code" href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">vtype_block_read</a>(inp, i, j, i, j-1); <span class="comment">// use the previous block as reference</span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;      }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;      inp &gt;&gt; int_in;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;      max_match = int_in;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      inp &gt;&gt; int_in; <span class="comment">// the remaining chunks</span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      total_chunks = max_match + int_in; </div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].resize(1+3*total_chunks);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;      <span class="comment">// first, fill the matching chunks</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;      <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][0] = ver_types_freq[block].first;</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;max_match;j++){</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][1+3*j] = <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i-1][1+3*j];</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][2+3*j] = <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i-1][2+3*j];</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;        <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][3+3*j] = <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i-1][3+3*j];</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      }</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;      <span class="keywordflow">if</span> (max_match &lt; total_chunks){</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="comment">// there are still some blocks to be decoded</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;        <span class="comment">// first, we need to encode the block max_match itself</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="comment">// if this block exists in row i-1, we use that as a reference,</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        <span class="keywordflow">if</span> (max_match &lt;(<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i-1].size()-1)/3){</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;          <a class="code" href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">vtype_block_read</a>(inp, i, max_match, i-1, max_match);</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;          <span class="comment">// then, write the remaining blocks, if any</span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = max_match+1; j&lt;(<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()-1)/3; j++){</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;            <a class="code" href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">vtype_block_read</a>(inp, i, j, i, j-1);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;          }</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;          <span class="comment">// if block max_match - 1 exists in row i, use it as a reference</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;          <span class="keywordflow">if</span> (max_match &gt; 0){</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = max_match; j&lt;total_chunks; j++){</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;              <a class="code" href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">vtype_block_read</a>(inp, i, j, i, j-1);</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;          }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            <span class="comment">// otherwise, encode the first block standalone, and recursively go forward and use previous block as reference </span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;            <a class="code" href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">vtype_block_read</a>(inp, i, max_match);</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = max_match+1; j&lt;total_chunks; j++){</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;              <a class="code" href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">vtype_block_read</a>(inp, i, j, i, j-1);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;            }</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;          }</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      }</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    }</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    count_in_block++;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  }</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_a4bf8563a2dfd3038dc5833c014320487"><div class="ttname"><a href="classmarked__graph__compressed.html#a4bf8563a2dfd3038dc5833c014320487">marked_graph_compressed::vtype_block_read</a></div><div class="ttdeci">void vtype_block_read(ibitstream &amp;inp, int i, int j)</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.cpp:1280</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a889749dd51bc37917a156e337eac142a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a889749dd51bc37917a156e337eac142a">&#9670;&nbsp;</a></span>vtype_list_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void marked_graph_compressed::vtype_list_write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classobitstream.html">obitstream</a> &amp;&#160;</td>
          <td class="paramname"><em>oup</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>writes the ver_type_list array to the output using difference coding, assuming that its entries are lexicographically sorted (as vectors) </p>
<div class="fragment"><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                                             {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <span class="comment">// first, we should extract information about vertex marks</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  vector&lt;pair&lt;int, int&gt; &gt; ver_types_freq; <span class="comment">// each element (m,k) means that the ver mark m appears in k many vertex types</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;  vector&lt;pair&lt;int, int&gt; &gt; ver_types_blocks; <span class="comment">// the ith entry is (a,b), where a and b denote the range of indices in ith block. Note that the range is of the form [a,b)</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="comment">//int prev_mark = ver_type_list[0][0]-1; // define it this way, so that initially it is different from the first mark</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;  <span class="keywordtype">int</span> current_mark; <span class="comment">// the mark of the current blcok</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keywordtype">int</span> block_start = 0; <span class="comment">// the start index of the current vertex mark block, a block is subsequent entries in ver_type_list with the same vertex marks</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;  <span class="keywordtype">int</span> i = 0;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;  <span class="comment">// cerr &lt;&lt; &quot; ver_type_list.size() &quot; &lt;&lt; ver_type_list.size() &lt;&lt; endl;</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;  <span class="comment">// cerr &lt;&lt; &quot; ver_type_list &quot; &lt;&lt; endl;</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  <span class="comment">// for (int k=0; k&lt;ver_type_list.size(); k++){</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <span class="comment">//   cerr &lt;&lt; &quot;(&quot; &lt;&lt; k &lt;&lt; &quot;) &quot;;</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;  <span class="comment">//   cerr &lt;&lt; ver_type_list[k][0]&lt;&lt; &quot;: &quot;;</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  <span class="comment">//   for (int j=0; j&lt; (ver_type_list[k].size()-1)/3; j++)</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;  <span class="comment">//     cerr &lt;&lt; &quot;| &quot; &lt;&lt; ver_type_list[k][1+3*j] &lt;&lt; &quot; &quot; &lt;&lt; ver_type_list[k][2+3*j] &lt;&lt; &quot; &quot; &lt;&lt; ver_type_list[k][3+3*j] &lt;&lt; &quot; &quot;;</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="comment">//   cerr &lt;&lt; endl;</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keywordflow">while</span>(i&lt;<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.size()){</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    current_mark = <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[block_start][0];</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][0] == current_mark){</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="comment">//cerr &lt;&lt; i &lt;&lt; &quot; &quot;;</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      i++;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;      <span class="keywordflow">if</span> (i &gt;= <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>.size())</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;    ver_types_freq.push_back(pair&lt;int, int&gt;(current_mark, i - block_start));</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    ver_types_blocks.push_back(pair&lt;int, int&gt;(block_start, i));</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    block_start = i;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  }</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="comment">// writing ver_type_freq to the output</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  oup &lt;&lt; ver_types_freq.size();</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;  <span class="keywordflow">for</span> (i=0;i&lt;ver_types_freq.size();i++){</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="comment">//cerr &lt;&lt; &quot; mark &quot; &lt;&lt; ver_types_freq[i].first &lt;&lt; &quot; count &quot; &lt;&lt; ver_types_freq[i].second &lt;&lt; endl;</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    oup &lt;&lt; ver_types_freq[i].first;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    oup &lt;&lt; ver_types_freq[i].second - 1;<span class="comment">// since it is at least one</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;  }</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  <span class="comment">// now, we go over each block</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;  <span class="comment">// let b denote the block index</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="keywordtype">int</span> max_match;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordtype">bool</span> cond_1 = <span class="keyword">false</span>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;  <span class="keywordtype">bool</span> cond_2 = <span class="keyword">false</span>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <span class="keywordtype">bool</span> cond_3 = <span class="keyword">false</span>;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> b=0; b&lt;ver_types_freq.size();b++){</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">for</span> (i=ver_types_blocks[b].first; i&lt;ver_types_blocks[b].second; i++){</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      <span class="comment">//for (i =0; i&lt;ver_type_list.size();i++){</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="keywordflow">if</span> (i==ver_types_blocks[b].first){</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        <span class="comment">// this is the first row in that block, so its compression is different</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        oup &lt;&lt; (<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()-1)/3; <span class="comment">// number of blocks</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0;j&lt;(<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()-1)/3; j++){</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          <span class="keywordflow">if</span> (j==0)</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;            <a class="code" href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">vtype_block_write</a>(oup, i, j);</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <a class="code" href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">vtype_block_write</a>(oup, i, j, i, j-1); <span class="comment">// use the previous block as reference</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        }</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        max_match = <a class="code" href="classmarked__graph__compressed.html#a5ce51414e335d817f4be781fdcfbe9b1">vtype_max_match</a>(i, i-1); <span class="comment">// compare with the previous one</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        oup &lt;&lt; max_match;</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        oup &lt;&lt; (<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()-1)/3 - max_match; <span class="comment">// number of remaining blocks</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="comment">//cerr &lt;&lt; &quot; i &quot; &lt;&lt; i &lt;&lt; &quot; max_match &quot; &lt;&lt; max_match;</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordflow">if</span> (max_match &lt; (<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()-1)/3){</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          <span class="comment">// there are still some blocks to be encoded</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;          <span class="comment">// first, we need to encode the block max_match itself</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          <span class="comment">// if this block exists in row i-1, we use that as a reference,</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          <span class="keywordflow">if</span> (max_match &lt;(<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i-1].size()-1)/3){</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <span class="comment">//cerr &lt;&lt; &quot; 1&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;            cond_1 = <span class="keyword">true</span>;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;            <a class="code" href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">vtype_block_write</a>(oup, i, max_match, i-1, max_match);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;            <span class="comment">// then, write the remaining blocks, if any</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = max_match+1; j&lt;(<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()-1)/3; j++){</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;              <a class="code" href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">vtype_block_write</a>(oup, i, j, i, j-1);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;            }</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;          }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="comment">// if block max_match - 1 exists in row i, use it as a reference</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            <span class="keywordflow">if</span> (max_match &gt; 0){</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;              <span class="comment">//cerr &lt;&lt; &quot; 2&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;              cond_2 = <span class="keyword">true</span>;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = max_match; j&lt;(<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()-1)/3; j++){</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                <a class="code" href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">vtype_block_write</a>(oup, i, j, i, j-1);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;              }</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            }<span class="keywordflow">else</span>{</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;              <span class="comment">//cerr &lt;&lt; &quot; 3&quot; &lt;&lt; endl;</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;              <span class="comment">// otherwise, encode the first block standalone, and recursively go forward and use previous block as reference</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;              cond_3 = <span class="keyword">true</span>;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;              <a class="code" href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">vtype_block_write</a>(oup, i, max_match);</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = max_match+1; j&lt;(<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()-1)/3; j++){</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;                <a class="code" href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">vtype_block_write</a>(oup, i, j, i, j-1);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;              }</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;            }</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;          }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        }</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      }</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    }</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  }</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  <span class="comment">//cerr &lt;&lt; &quot; cond_1 &quot; &lt;&lt; cond_1 &lt;&lt; &quot; cond_2 &quot; &lt;&lt; cond_2 &lt;&lt; &quot; cond_3 &quot; &lt;&lt; cond_3 &lt;&lt; endl;</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_a31f9ea72682f9072d0f90faf58a603fe"><div class="ttname"><a href="classmarked__graph__compressed.html#a31f9ea72682f9072d0f90faf58a603fe">marked_graph_compressed::vtype_block_write</a></div><div class="ttdeci">void vtype_block_write(obitstream &amp;oup, int i, int j)</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.cpp:1238</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_a5ce51414e335d817f4be781fdcfbe9b1"><div class="ttname"><a href="classmarked__graph__compressed.html#a5ce51414e335d817f4be781fdcfbe9b1">marked_graph_compressed::vtype_max_match</a></div><div class="ttdeci">int vtype_max_match(int i, int j)</div><div class="ttdoc">finds the maximum number of (t,t&amp;#39;,n) blocks that match between two entries of ver_type_list ...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.cpp:1031</div></div>
<div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ce51414e335d817f4be781fdcfbe9b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ce51414e335d817f4be781fdcfbe9b1">&#9670;&nbsp;</a></span>vtype_max_match()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int marked_graph_compressed::vtype_max_match </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>finds the maximum number of (t,t',n) blocks that match between two entries of ver_type_list </p>
<div class="fragment"><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                                                        {</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="keywordtype">int</span> max_match = 0;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;  <span class="keywordtype">int</span> k;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keywordtype">bool</span> flag;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;  <span class="keywordflow">while</span>(<span class="keyword">true</span>){</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">if</span> (((3*max_match + 3) &gt;= <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i].size()) or ((3*max_match+3) &gt;= <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[j].size())) <span class="comment">// one of the lists is reached an end</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    flag = <span class="keyword">true</span>;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">for</span> (k=1;k&lt;=3;k++)</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[i][3*max_match+k] != <a class="code" href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">ver_type_list</a>[j][3*max_match+k])</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        flag = <span class="keyword">false</span>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">if</span> (flag == <span class="keyword">false</span>)</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    max_match++;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  }</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  <span class="keywordflow">return</span> max_match;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;}</div><div class="ttc" id="classmarked__graph__compressed_html_af2e3e55223d436628a02758dfae88493"><div class="ttname"><a href="classmarked__graph__compressed.html#af2e3e55223d436628a02758dfae88493">marked_graph_compressed::ver_type_list</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; ver_type_list</div><div class="ttdoc">the list of all vertex types that appear in the graph, where the type of a vertex is a vector of inte...</div><div class="ttdef"><b>Definition:</b> marked_graph_compression.h:30</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a8b2aaac68e9332ddc78d88eb60b323a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b2aaac68e9332ddc78d88eb60b323a7">&#9670;&nbsp;</a></span>delta</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int marked_graph_compressed::delta</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the degree threshold used when compression was performed </p>

</div>
</div>
<a id="af6ff623407b673d08d0cab77b39c2193"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6ff623407b673d08d0cab77b39c2193">&#9670;&nbsp;</a></span>h</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int marked_graph_compressed::h</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the depth up to which the compression was performed </p>

</div>
</div>
<a id="a8d841016ddb11cfd33748c8deb6277ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d841016ddb11cfd33748c8deb6277ba">&#9670;&nbsp;</a></span>n</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int marked_graph_compressed::n</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the number of vertices </p>

</div>
</div>
<a id="a7b3267063fba30b45eb21b3ba4e07536"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b3267063fba30b45eb21b3ba4e07536">&#9670;&nbsp;</a></span>part_bgraph</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">map&lt;pair&lt;int, int&gt;, mpz_class&gt; marked_graph_compressed::part_bgraph</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compressed form of partition bipartite graphs corresponding to colors in \(C_&lt;\). For a pair \(0 \leq t &lt; t&#39; &lt; L\) of half edge types, part_bgraph[pair&lt;int, int&gt;(t,t')] is the compressed form of the bipartite graph with n left and right nodes, where a left node i is connected to a right node j if there is an edge connecting i to j with type t towards i and type t' towards j </p>

</div>
</div>
<a id="ae179a4737e6eab905c18a94d44ef64b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae179a4737e6eab905c18a94d44ef64b7">&#9670;&nbsp;</a></span>part_graph</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">map&lt;int, pair&lt;mpz_class, vector&lt;int&gt; &gt; &gt; marked_graph_compressed::part_graph</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>compressed form of partition graphs corresponding to colors in \(C_=\). For a half edge type t, part_graph[t] is the compressed form of the simple unmarked graph with n vertices, where a node i is connected to a node j where there is an edge between i and j in the original graph with color (t,t) </p>

</div>
</div>
<a id="a7df5779d313486644132bd816937f532"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7df5779d313486644132bd816937f532">&#9670;&nbsp;</a></span>star_edges</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">map&lt;pair&lt;int, int&gt; , vector&lt;vector&lt;int&gt; &gt; &gt; marked_graph_compressed::star_edges</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>for each pair of edge marks x,x', and integer \(k\), star_edges[pair&lt;int,int&gt;(x,x')][k] is a list of neighbors \(w\) of the \(k\)th star vertex (say \(v\)) so that \(v\) shares a star edge with \(w\) so that the mark towards \(v\) is x and the mark towards \(w\) is xp. </p>

</div>
</div>
<a id="a7a4ced4586e2e353f9076bd447df5208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a4ced4586e2e353f9076bd447df5208">&#9670;&nbsp;</a></span>star_vertices</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pair&lt;vector&lt;int&gt;, mpz_class&gt; marked_graph_compressed::star_vertices</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the compressed form of the star_vertices list </p>

</div>
</div>
<a id="a86b00223525703e973415cbc9c94da68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86b00223525703e973415cbc9c94da68">&#9670;&nbsp;</a></span>type_mark</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;int&gt; marked_graph_compressed::type_mark</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>for an edge type t, type_mark[t] denotes the mark component of t </p>

</div>
</div>
<a id="af2e3e55223d436628a02758dfae88493"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2e3e55223d436628a02758dfae88493">&#9670;&nbsp;</a></span>ver_type_list</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;vector&lt;int&gt; &gt; marked_graph_compressed::ver_type_list</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the list of all vertex types that appear in the graph, where the type of a vertex is a vector of integers, where its index 0 is the mark of the vertex, and indices \(3k+1\), \(3k+2\), \(3k+3\) are \(m\), \(m&#39;\) and \(n_{m,m&#39;}\), where \((m,m&#39;)\) is a type pair, and \(n_{m,m&#39;}\) is the number of edges connected to the vertex with that type. The list is sorted lexicographically to ensure unique representation. </p>

</div>
</div>
<a id="af446cc5e23c241a92b76642fd5ebc403"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af446cc5e23c241a92b76642fd5ebc403">&#9670;&nbsp;</a></span>ver_types</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pair&lt;vector&lt;int&gt;, mpz_class&gt; marked_graph_compressed::ver_types</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>the compressed form of vertex types, where the type of a vertex is the index with respect to ver_type_list of the list of integers specifying the type of the vertex (mark of the vertex followed by the number of edges of each type connected to that vertex) </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="marked__graph__compression_8h_source.html">marked_graph_compression.h</a></li>
<li><a class="el" href="marked__graph__compression_8cpp.html">marked_graph_compression.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
